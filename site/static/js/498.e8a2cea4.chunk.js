"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[498],{498:function(t,e,n){n.r(e),n.d(e,{List:function(){return x}});var i=n(942),r=n(413),s=n(671),o=n(144),a=n(340),u=n(882),c=n(791),d=n(252),l=n(885),p=n(355),h=n(698),v=n(682),f=n(184),x=function(t){(0,a.Z)(n,t);var e=(0,u.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,t)).listItem=function(t){return[t.node,t.service,t.type,(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(v.InfoButton,{onClick:function(){return i.changeContent((0,f.jsx)(C,{id:t.id},"server_info"))},title:"Service information"},"info"),(0,f.jsx)(v.DeleteButton,{onClick:function(){return i.deleteList(t.id)},title:"Delete service"},"del"),t.hasOwnProperty("ui")&&t.ui.length>0&&(0,f.jsx)(v.UiButton,{onClick:function(){return window.open(t.ui,"_blank")},title:"Server UI"},"ui")]})]},i.deleteList=function(t){return window.confirm("Really delete service?")&&(0,d.Fh)("api/master/server_delete",{id:t}).then((function(e){e.deleted&&(i.setState({data:i.state.data.filter((function(e){return e.id!==t}))}),i.changeContent(null))}))},i.state={},i}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,d.Fh)("api/master/server_list",{type:this.props.type}).then((function(e){return t.setState(e)}))}},{key:"componentDidUpdate",value:function(t){var e=this;t!==this.props&&(0,d.Fh)("api/master/server_list",{type:this.props.type}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var t=this;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.ContentList,{header:"Servers",thead:["Node","Service","Type",""],trows:this.state.data,listItem:this.listItem,children:[(0,f.jsx)(v.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),(0,f.jsx)(v.AddButton,{onClick:function(){return t.changeContent((0,f.jsx)(C,{id:"new",type:t.props.type},"server_info"))},title:"Add service"},"add")]},"cl"),(0,f.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(c.Component),C=function(t){(0,a.Z)(n,t);var e=(0,u.Z)(n);function n(t){var o;return(0,s.Z)(this,n),(o=e.call(this,t)).changeContent=function(t){return o.setState({content:t})},o.onChange=function(t){return o.setState({data:(0,r.Z)((0,r.Z)({},o.state.data),{},(0,i.Z)({},t.target.name,t.target.value))})},o.updateInfo=function(){return(0,d.Fh)("api/master/server_info",(0,r.Z)({op:"update"},o.state.data)).then((function(t){return o.setState(t)}))},o.state={data:null,found:!0},o}return(0,o.Z)(n,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;(0,d.Fh)("api/master/server_info",{id:this.props.id}).then((function(e){e.data.node||(e.data.node=e.nodes[0]),e.data.type_id||(e.data.type_id=e.services[0].id),t.setState((0,r.Z)((0,r.Z)({},e),{},{content:null}))}))}},{key:"render",value:function(){var t=this;if(this.state.found){if(this.state.data){var e=this.state.data.id,n="new"!==e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.InfoArticle,{header:"Server",children:[(0,f.jsxs)(l.InfoColumns,{children:[(0,f.jsx)(h.TextLine,{id:"server",label:"ID",text:e},"server"),(0,f.jsx)(h.SelectInput,{id:"node",value:this.state.data.node,onChange:this.onChange,children:this.state.nodes.map((function(t){return(0,f.jsx)("option",{value:t,children:t},t)}))},"node"),(0,f.jsx)(h.SelectInput,{id:"type_id",label:"Service",value:this.state.data.type_id,onChange:this.onChange,children:this.state.services.map((function(t){return(0,f.jsx)("option",{value:t.id,children:"".concat(t.service," (").concat(t.type,")")},t.id)}))},"type_id"),(0,f.jsx)(h.UrlInput,{id:"ui",label:"UI",value:this.state.data.ui,onChange:this.onChange},"ui")]},"ic"),(0,f.jsx)(v.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"save"),n&&(0,f.jsx)(v.SyncButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"sync"},"srv_op_sync"))},title:"Sync service"},"sync"),n&&(0,f.jsx)(v.ReloadButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"restart"},"srv_op_rst"))},title:"Restart service"},"restart"),n&&(0,f.jsx)(v.CheckButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"parameters"},"srv_op_params"))},title:"Service parameters"},"params"),n&&(0,f.jsx)(v.SearchButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"status"},"srv_op_stat"))},title:"Service status"},"status"),n&&(0,f.jsx)(v.StartButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"start"},"srv_op_start"))},title:"Start service"},"start"),n&&(0,f.jsx)(v.StopButton,{onClick:function(){return t.changeContent((0,f.jsx)(j,{id:e,operation:"stop"},"srv_op_stop"))},title:"Stop service"},"stop")]},"ia"),(0,f.jsx)(p.NavBar,{id:"server_navigation"},"server_navigation"),this.state.content]})}return(0,f.jsx)(l.Spinner,{})}return(0,f.jsxs)(l.InfoArticle,{children:["Server with id: ",this.props.id," removed"]},"si_art_nf")}}]),n}(c.Component),j=function(t){(0,a.Z)(n,t);var e=(0,u.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,t)).state={wait:!0},i}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,d.Fh)("api/master/server_operation",{op:this.props.operation,id:this.props.id}).then((function(e){return t.setState({result:e,wait:!1})}))}},{key:"componentDidUpdate",value:function(t){t!==this.props&&(this.setState({wait:!0}),this.componentDidMount())}},{key:"render",value:function(){return this.state.wait?(0,f.jsx)(l.Spinner,{}):(0,f.jsx)(l.CodeArticle,{children:JSON.stringify(this.state.result,null,2)},"srv_operation")}}]),n}(c.Component)}}]);
//# sourceMappingURL=498.e8a2cea4.chunk.js.map