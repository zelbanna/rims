(this.webpackJsonprims=this.webpackJsonprims||[]).push([[17],{47:function(t,e,i){"use strict";i.r(e),i.d(e,"Main",(function(){return j}));var n=i(19),a=i(10),s=i(5),r=i(6),o=i(8),c=i(7),u=i(3),l=i(14),d=i(15),p=i(16),m=i(21),h=i(0),j=function(t){Object(o.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).reloadList=function(){return Object(l.d)("api/multimedia/list",{},{"X-Route":n.node}).then((function(t){return n.setState(t)}))},n.deleteList=function(t){return window.confirm("Delete file "+t.file+"?")&&Object(l.d)("api/multimedia/delete",t,{"X-Route":n.node}).then((function(e){e.deleted&&(n.setState({data:n.state.data.filter((function(e){return!(e.path===t.path&&e.file===t.file)}))}),n.changeContent(null))}))},n.listItem=function(t,e){return[t.file,Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(m.InfoButton,{onClick:function(){return n.changeContent(Object(h.jsx)(f,{path:t.path,file:t.file,node:n.node},"multimedia_title_"+e))},title:"Title info"},"info"),Object(h.jsx)(m.SearchButton,{onClick:function(){return n.changeContent(Object(h.jsx)(b,{path:t.path,file:t.file,node:n.node},"multimedia_lookup_"+e))},title:"Lookup info"},"lookup"),Object(h.jsx)(m.DocButton,{onClick:function(){return n.changeContent(Object(h.jsx)(x,{path:t.path,file:t.file,node:n.node},"multimedia_subs_"+e))},title:"Subtitles"},"subs"),Object(h.jsx)(m.DeleteButton,{onClick:function(){return n.deleteList(t)},title:"Delete file"},"del")]})]},n.state={},n.node=n.props.node?n.props.node:n.context.settings.node,n}return Object(r.a)(i,[{key:"componentDidMount",value:function(){this.reloadList()}},{key:"componentDidUpdate",value:function(t){t!==this.props&&(this.node=this.props.node?this.props.node:this.context.settings.node)}},{key:"render",value:function(){var t=this;return this.state.data?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(d.ContentList,{header:"Media files",thead:["File",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[Object(h.jsx)(m.ReloadButton,{onClick:function(){return t.reloadList()}},"reload"),Object(h.jsx)(m.DeleteButton,{onClick:function(){return window.confirm("Really clean up files?")&&t.changeContent(Object(h.jsx)(_,{node:t.node},"multimedia_cleanup"))},title:"Cleanup multimedia directory"},"cleanup")]},"cl"),Object(h.jsx)(d.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]}):Object(h.jsx)(d.Spinner,{})}}]),i}(u.Component);j.contextType=d.RimsContext;var f=function(t){Object(o.a)(i,t);var e=Object(c.a)(i);function i(t){var r;return Object(s.a)(this,i),(r=e.call(this,t)).onChange=function(t){return r.setState({data:Object(a.a)(Object(a.a)({},r.state.data),{},Object(n.a)({},t.target.name,t.target.value))})},r.threadChange=function(t){return r.setState(Object(n.a)({},t.target.name,t.target.checked))},r.updateInfo=function(){return Object(l.d)("api/multimedia/check_title",Object(a.a)({op:"update"},r.state.data),{"X-Route":r.props.node}).then((function(t){return r.setState(t)}))},r.transferFile=function(){window.confirm("Transfer file to repository?")&&(r.state.thread?Object(l.d)("api/system/worker",{module:"multimedia",function:"transfer",output:!0,args:{path:r.props.path,file:r.props.file}},{"X-Route":r.props.node}).then((function(t){return r.setState({op:"transfer",result:t})})):(r.setState({wait:Object(h.jsx)(d.Spinner,{})}),Object(l.d)("api/multimedia/transfer",{path:r.props.path,file:r.props.file},{"X-Route":r.props.node}).then((function(t){return r.setState({op:"transfer",result:t,wait:null})}))))},r.processFile=function(){window.confirm("Process file?")&&(r.state.thread?Object(l.d)("api/system/worker",{module:"multimedia",function:"process",output:!0,args:Object(a.a)({path:r.props.path,file:r.props.file},r.state.data)},{"X-Route":r.props.node}).then((function(t){return r.setState({op:"process",result:t})})):(r.setState({wait:Object(h.jsx)(d.Spinner,{})}),Object(l.d)("api/multimedia/process",Object(a.a)({path:r.props.path,file:r.props.file},r.state.data),{"X-Route":r.props.node}).then((function(t){return r.setState({op:"process",result:t,wait:null})}))))},r.state={thread:!0,wait:null},r}return Object(r.a)(i,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/multimedia/check_title",{path:this.props.path,file:this.props.file},{"X-Route":this.props.node}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;if(this.state.op){if(this.state.thread||"transfer"===this.state.op)return Object(h.jsx)(d.InfoArticle,{header:this.state.thread?"Task activation":"Transfer",children:Object(h.jsx)(p.TextLine,{id:"result",text:JSON.stringify(this.state.result)},"mm_trans_res")},"mm_trans_article");if("NOT_OK"===this.state.result.status)return Object(h.jsx)(d.CodeArticle,{header:"Process Error",children:JSON.stringify(this.state.result.info,null,2)},"mm_error_code");var e=this.state.result.data;return Object(h.jsxs)(d.InfoArticle,{header:"Process success",children:["Elapsed time for processing file: ",this.state.result.seconds," seconds",Object(h.jsxs)(d.InfoColumns,{children:[Object(h.jsx)(p.TextLine,{id:"prefix",text:e.prefix},"mm_proc_prefix"),Object(h.jsx)(p.TextLine,{id:"suffix",text:e.suffix},"mm_proc_suffix"),Object(h.jsx)(p.TextLine,{id:"dest",label:"Destination",text:JSON.stringify(e.dest)},"mm_proc_dest"),Object(h.jsx)(p.TextLine,{id:"rename",text:JSON.stringify(e.rename)},"mm_proc_rename"),Object(h.jsx)(p.TextLine,{id:"aac",label:"Add AAC",text:JSON.stringify(e.aac_probe)},"mm_proc_aac"),Object(h.jsx)(p.TextLine,{id:"chg_aac",label:"Param AAC",text:e.changes.aac},"mm_proc_chg_aac"),Object(h.jsx)(p.TextLine,{id:"chg_aud",label:"Param Audio",text:e.changes.audio},"mm_proc_chg_aud"),Object(h.jsx)(p.TextLine,{id:"chg_sub",label:"Param Subtitles",text:e.changes.subtitle},"mm_proc_chg_sub"),Object(h.jsx)(p.TextLine,{id:"chg_srt",label:"Param SRT files",text:e.changes.srt},"mm_proc_chg_srt")]},"mm_proc_ic")]},"mm_proc_article")}if(this.state.data){var i=this.state.data;return Object(h.jsxs)(d.InfoArticle,{header:"Title",children:[Object(h.jsxs)(d.InfoColumns,{children:[Object(h.jsx)(p.TextLine,{id:"type",text:i.type},"mm_tit_type"),Object(h.jsx)(p.TextLine,{id:"title",text:i.title},"mm_tit_title"),Object(h.jsx)(p.TextLine,{id:"path",text:i.path},"mm_tit_path"),Object(h.jsx)(p.TextInput,{id:"name",value:i.name,onChange:this.onChange},"mm_tit_name"),i.epside&&Object(h.jsx)(p.TextInput,{id:"episode",value:i.episode,onChange:this.onChange},"mm_tit_eposide"),Object(h.jsx)(p.TextInput,{id:"info",value:i.info,onChange:this.onChange},"mm_tit_info"),Object(h.jsx)(p.CheckboxInput,{id:"thread",label:"Thread",value:this.state.thread,onChange:this.threadChange,title:"Thread or direct execution"},"mm_tit_thread")]},"mm_tit_ic"),Object(h.jsx)(m.StartButton,{onClick:function(){return t.processFile()},title:"Process file"},"mm_tit_btn_proc"),Object(h.jsx)(m.SyncButton,{onClick:function(){return t.transferFile()},title:"Transfer file"},"mm_tit_btn_trans"),this.state.wait]},"mm_tit_article")}return Object(h.jsx)(d.Spinner,{})}}]),i}(u.Component),b=function(t){Object(o.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).state={},n}return Object(r.a)(i,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/multimedia/check_content",{path:this.props.path,file:this.props.file},{"X-Route":this.props.node}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){if(this.state.data){var t=this.state.data;return Object(h.jsx)(d.InfoArticle,{header:"Lookup",children:Object(h.jsxs)(d.InfoColumns,{children:[Object(h.jsx)(p.TextLine,{id:"file",label:"File",text:this.props.file},"mm_lu_file"),Object(h.jsx)(p.TextLine,{id:"status",label:"Result",text:this.state.status},"mm_lu_status"),Object(h.jsx)(p.TextLine,{id:"error",label:"Error",text:this.state.info},"mm_lu_error"),Object(h.jsx)(p.TextLine,{id:"video_default",label:"Video default",text:JSON.stringify(!t.video.set_default),title:"Video stream has default language"},"mm_lu_v_def"),Object(h.jsx)(p.TextLine,{id:"video_lang",label:"Video language",text:t.video.language,title:"Language set in video stream information"},"mm_lu_v_lang"),Object(h.jsx)(p.TextLine,{id:"audio_add",label:"Audio keep",text:t.audio.add.join()},"mm_lu_a_add"),Object(h.jsx)(p.TextLine,{id:"audio_rem",label:"Audio remove",text:t.audio.remove.join()},"mm_lu_a_rem"),Object(h.jsx)(p.TextLine,{id:"audio_aac",label:"Add AAC",text:JSON.stringify(t.audio.add_aac)},"mm_lu_a_aac"),Object(h.jsx)(p.TextLine,{id:"sub_add",label:"Subtitle keep",text:t.subtitle.add.join()},"mm_lu_s_add"),Object(h.jsx)(p.TextLine,{id:"sub_rem",label:"Subtitle remove",text:t.subtitle.remove.join()},"mm_lu_s_rem"),Object(h.jsx)(p.TextLine,{id:"sub_lang",label:"Subtitle languages",text:t.subtitle.languages.join()},"mm_lu_a_lang")]},"mm_lu_ic")},"mm_lu_article")}return Object(h.jsx)(d.Spinner,{})}}]),i}(u.Component),x=function(t){Object(o.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).state={},n}return Object(r.a)(i,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/multimedia/check_srt",{path:this.props.path,file:this.props.file},{"X-Route":this.props.node}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return this.state.data?Object(h.jsx)(d.InfoArticle,{header:"Extra subtitles",children:Object(h.jsxs)(d.InfoColumns,{children:[Object(h.jsx)(p.TextLine,{id:"path",text:this.props.path},"mm_sub_path"),Object(h.jsx)(p.TextLine,{id:"item",text:this.props.file},"mm_sub_item"),Object(h.jsx)(p.TextLine,{id:"name",text:this.state.data.name},"mm_sub_name"),Object(h.jsx)(p.TextLine,{id:"code",text:this.state.data.code},"mm_sub_code"),Object(h.jsx)(p.TextLine,{id:"file",text:this.state.data.file},"mm_sub_file")]},"mm_sub_ic")},"mm_sub_art"):Object(h.jsx)(d.Spinner,{})}}]),i}(u.Component),_=function(t){Object(o.a)(i,t);var e=Object(c.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).state={},n}return Object(r.a)(i,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/multimedia/cleanup",{},{"X-Route":this.props.node}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return this.state.data?Object(h.jsx)(d.ContentReport,{header:"delete",thead:["Type","Path","Item","Status","Info"],trows:this.state.data,listItem:function(t){return[t.type,t.path,t.item,t.status,t.info]}},"mm_clean_cr"):Object(h.jsx)(d.Spinner,{})}}]),i}(u.Component)}}]);
//# sourceMappingURL=17.b036de3b.chunk.js.map