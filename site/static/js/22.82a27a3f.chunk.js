(this.webpackJsonprims=this.webpackJsonprims||[]).push([[22],{52:function(t,e,n){"use strict";n.r(e),n.d(e,"List",(function(){return b}));var i=n(19),r=n(10),a=n(5),s=n(6),o=n(8),c=n(7),u=n(3),d=n(14),l=n(15),p=n(17),j=n(16),h=n(21),v=n(0),b=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).listItem=function(t){return[t.node,t.service,t.type,Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(h.InfoButton,{onClick:function(){return i.changeContent(Object(v.jsx)(f,{id:t.id},"server_info"))},title:"Service information"},"info"),Object(v.jsx)(h.DeleteButton,{onClick:function(){return i.deleteList(t.id)},title:"Delete service"},"del"),t.hasOwnProperty("ui")&&t.ui.length>0&&Object(v.jsx)(h.UiButton,{onClick:function(){return window.open(t.ui,"_blank")},title:"Server UI"},"ui")]})]},i.deleteList=function(t){return window.confirm("Really delete service?")&&Object(d.d)("api/master/server_delete",{id:t}).then((function(e){e.deleted&&(i.setState({data:i.state.data.filter((function(e){return e.id!==t}))}),i.changeContent(null))}))},i.state={},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/server_list",{type:this.props.type}).then((function(e){return t.setState(e)}))}},{key:"componentDidUpdate",value:function(t){var e=this;t!==this.props&&Object(d.d)("api/master/server_list",{type:this.props.type}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var t=this;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.ContentList,{header:"Servers",thead:["Node","Service","Type",""],trows:this.state.data,listItem:this.listItem,children:[Object(v.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(v.jsx)(h.AddButton,{onClick:function(){return t.changeContent(Object(v.jsx)(f,{id:"new",type:t.props.type},"server_info"))},title:"Add service"},"add")]},"cl"),Object(v.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(u.Component),f=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).changeContent=function(t){return s.setState({content:t})},s.onChange=function(t){return s.setState({data:Object(r.a)(Object(r.a)({},s.state.data),{},Object(i.a)({},t.target.name,t.target.value))})},s.updateInfo=function(){return Object(d.d)("api/master/server_info",Object(r.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null,found:!0},s}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/server_info",{id:this.props.id}).then((function(e){e.data.node||(e.data.node=e.nodes[0]),e.data.type_id||(e.data.type_id=e.services[0].id),t.setState(Object(r.a)(Object(r.a)({},e),{},{content:null}))}))}},{key:"render",value:function(){var t=this;if(this.state.found){if(this.state.data){var e=this.state.data.id,n="new"!==e;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.InfoArticle,{header:"Server",children:[Object(v.jsxs)(l.InfoColumns,{children:[Object(v.jsx)(j.TextLine,{id:"server",label:"ID",text:e},"server"),Object(v.jsx)(j.SelectInput,{id:"node",value:this.state.data.node,onChange:this.onChange,children:this.state.nodes.map((function(t){return Object(v.jsx)("option",{value:t,children:t},t)}))},"node"),Object(v.jsx)(j.SelectInput,{id:"type_id",label:"Service",value:this.state.data.type_id,onChange:this.onChange,children:this.state.services.map((function(t){return Object(v.jsx)("option",{value:t.id,children:"".concat(t.service," (").concat(t.type,")")},t.id)}))},"type_id"),Object(v.jsx)(j.UrlInput,{id:"ui",label:"UI",value:this.state.data.ui,onChange:this.onChange},"ui")]},"ic"),Object(v.jsx)(h.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"save"),n&&Object(v.jsx)(h.SyncButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"sync"},"srv_op_sync"))},title:"Sync service"},"sync"),n&&Object(v.jsx)(h.ReloadButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"restart"},"srv_op_rst"))},title:"Restart service"},"restart"),n&&Object(v.jsx)(h.CheckButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"parameters"},"srv_op_params"))},title:"Service parameters"},"params"),n&&Object(v.jsx)(h.SearchButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"status"},"srv_op_stat"))},title:"Service status"},"status"),n&&Object(v.jsx)(h.StartButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"start"},"srv_op_start"))},title:"Start service"},"start"),n&&Object(v.jsx)(h.StopButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:e,operation:"stop"},"srv_op_stop"))},title:"Stop service"},"stop")]},"ia"),Object(v.jsx)(p.NavBar,{id:"server_navigation"},"server_navigation"),this.state.content]})}return Object(v.jsx)(l.Spinner,{})}return Object(v.jsxs)(l.InfoArticle,{children:["Server with id: ",this.props.id," removed"]},"si_art_nf")}}]),n}(u.Component),O=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).state={wait:!0},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/server_operation",{op:this.props.operation,id:this.props.id}).then((function(e){return t.setState({result:e,wait:!1})}))}},{key:"componentDidUpdate",value:function(t){t!==this.props&&(this.setState({wait:!0}),this.componentDidMount())}},{key:"render",value:function(){return this.state.wait?Object(v.jsx)(l.Spinner,{}):Object(v.jsx)(l.CodeArticle,{children:JSON.stringify(this.state.result,null,2)},"srv_operation")}}]),n}(u.Component)}}]);
//# sourceMappingURL=22.82a27a3f.chunk.js.map