"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[682],{224:(e,t,s)=>{s.r(t),s.d(t,{Device:()=>d,List:()=>l,Search:()=>o});var i=s(791),n=s(587),a=s(885),h=s(698),r=s(682),c=s(184);class o extends i.Component{constructor(e){super(e),this.changeContent=e=>this.props.changeSelf(e),this.onChange=e=>this.setState({[e.target.name]:e.target.value}),this.state={field:"mac",search:""}}render(){return(0,c.jsxs)(a.LineArticle,{header:"FDB Search",children:[(0,c.jsxs)(h.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,c.jsx)("option",{value:"mac",children:"MAC"}),(0,c.jsx)("option",{value:"device_id",children:"Device ID"})]},"field"),(0,c.jsx)(h.TextInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,c.jsx)(r.SearchButton,{onClick:()=>this.changeContent((0,c.jsx)(l,{...this.state,changeSelf:this.props.changeSelf},"fdb_list")),title:"Search FDB"},"fs_btn_search")]},"fs_art")}}class d extends i.Component{constructor(e){super(e),this.changeContent=e=>this.props.changeSelf(e),this.changeInterface=e=>s.e(884).then(s.bind(s,884)).then((t=>this.changeContent((0,c.jsx)(t.Info,{device_id:this.props.id,interface_id:e,changeSelf:this.changeContent},"interface_info")))),this.listItem=(e,t)=>[e.vlan,e.snmp_index,(0,c.jsx)(r.HrefButton,{text:e.name,onClick:()=>this.changeInterface(e.interface_id)},"fd_intf_"+e.interface_id),e.mac,e.oui],this.state={wait:null,searchfield:""}}componentDidMount(){(0,n.Fh)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((e=>this.setState(e)))}syncFDB(){this.setState({wait:(0,c.jsx)(a.Spinner,{})}),(0,n.Fh)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then((e=>"OK"===e.status&&(0,n.Fh)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((e=>this.setState({...e,wait:null})))))}render(){if(this.state.data){const e=this.state.searchfield.toUpperCase(),t=0===e.length?this.state.data:this.state.data.filter((t=>t.mac.includes(e)));return(0,c.jsxs)(a.ContentReport,{header:"FDB",thead:["VLAN","SNMP","Interface","MAC","OUI"],trows:t,listItem:this.listItem,children:[(0,c.jsx)(r.ReloadButton,{onClick:()=>this.componentDidMount()},"fd_btn_reload"),(0,c.jsx)(r.SyncButton,{onClick:()=>this.syncFDB(),title:"Resync FDB"},"fd_btn_sync"),(0,c.jsx)(h.SearchField,{searchFire:e=>this.setState({searchfield:e}),placeholder:"Search MAC"},"fd_search"),this.state.wait]},"fd_cr")}return(0,c.jsx)(a.Spinner,{})}}class l extends i.Component{constructor(e){super(e),this.changeSearch=(e,t)=>this.changeContent((0,c.jsx)(p,{mac:e},"fdb_info")),this.changeVisualize=e=>"changeSelf"in this.props&&s.e(559).then(s.bind(s,559)).then((t=>this.changeContent((0,c.jsx)(t.Edit,{type:"device",id:e},"viz_id_"+e)))),this.listItem=(e,t)=>[e.device_id,e.hostname,e.vlan,e.snmp_index,e.name,(0,c.jsx)(r.HrefButton,{text:e.mac,onClick:()=>this.setState({searchfield:e.mac})},"intf_"+t),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.InfoButton,{onClick:()=>this.changeSearch(e.mac,t),title:"Find interface(s)"},"info"),(0,c.jsx)(r.NetworkButton,{onClick:()=>this.changeVisualize(e.device_id)},"map")]})],this.state={searchfield:""}}componentDidUpdate(e){e!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Fh)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then((e=>this.setState(e)))}render(){if(this.state.data){const e=this.state.searchfield.toUpperCase(),t=0===e.length?this.state.data:this.state.data.filter((t=>t.mac.includes(e)));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.ContentList,{header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:t,listItem:this.listItem,children:[(0,c.jsx)(r.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,c.jsx)(h.SearchField,{searchFire:e=>this.setState({searchfield:e}),placeholder:"Search MAC",text:this.state.searchfield},"search")]},"cl"),(0,c.jsx)(a.ContentData,{mountUpdate:e=>this.changeContent=e},"cda")]})}return(0,c.jsx)(a.Spinner,{})}}class p extends i.Component{constructor(e){super(e),this.state={}}componentDidUpdate(e){e!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Fh)("api/fdb/search",{mac:this.props.mac}).then((e=>this.setState(e)))}render(){return this.state.device?(0,c.jsx)(a.ContentReport,{header:`${this.state.device.hostname} (${this.state.device.id})`,thead:["ID","Interface","Description","OUI"],trows:this.state.interfaces,listItem:e=>[e.interface_id,e.name,e.description,e.oui]},"fd_cr"):this.state.oui?(0,c.jsxs)(a.LineArticle,{header:"Search result",children:["OUI: ",this.state.oui]},"fd_oui_la"):this.state.status?(0,c.jsxs)(a.LineArticle,{header:"Search result",children:["Search result: ",this.state.info]},"fd_oui_la"):(0,c.jsx)(a.Spinner,{})}}}}]);
//# sourceMappingURL=682.5fc1023b.chunk.js.map