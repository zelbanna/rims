(this.webpackJsonprims=this.webpackJsonprims||[]).push([[3],{39:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return g})),n.d(e,"List",(function(){return O})),n.d(e,"Edit",(function(){return k}));var i=n(19),o=n(10),s=n(5),a=n(6),c=n(8),r=n(7),d=n(3),u=n.n(d),l=n(14),h=n(15),j=n(21),p=n(16),v=n(1),b=n.n(v),f=n(0),g=function(t){Object(c.a)(n,t);var e=Object(r.a)(n);function n(t){var i;return Object(s.a)(this,n),(i=e.call(this,t)).changeContent=function(t){return i.setState(t)},i.state=Object(f.jsx)(O,{},"viz_list"),i}return Object(a.a)(n,[{key:"render",value:function(){return Object(f.jsx)(f.Fragment,{children:this.state})}}]),n}(d.Component),O=function(t){Object(c.a)(n,t);var e=Object(r.a)(n);function n(t){var i;return Object(s.a)(this,n),(i=e.call(this,t)).listItem=function(t){return[t.id,t.name,Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(j.EditButton,{onClick:function(){return i.changeContent(Object(f.jsx)(k,{id:t.id,changeSelf:i.changeContent,type:"map"},"viz_edit_"+t.id))},title:"Show and edit map"},"edit"),Object(f.jsx)(j.NetworkButton,{onClick:function(){return window.open("viz.html?id=".concat(t.id),"_blank")},title:"Show resulting map"},"net"),Object(f.jsx)(j.DeleteButton,{onClick:function(){return i.deleteList(t.id)}},"del")]})]},i.deleteList=function(t){return window.confirm("Delete map?")&&Object(l.d)("api/visualize/delete",{id:t}).then((function(e){e.deleted&&(i.setState({data:i.state.data.filter((function(e){return e.id!==t}))}),i.changeContent(null))}))},i.state={},i}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/visualize/list").then((function(e){t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h.ContentList,{header:"Maps",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem,children:Object(f.jsx)(j.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload")},"cl"),Object(f.jsx)(h.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(d.Component),k=function(t){Object(c.a)(d,t);var e=Object(r.a)(d);function d(t){var a;return Object(s.a)(this,d),(a=e.call(this,t)).changeContent=function(t){return a.setState({content:t})},a.changeImport=function(t){return n.e(0).then(n.bind(null,36)).then((function(e){return a.props.changeSelf(Object(f.jsx)(e.Info,{id:t},"di_"+t))}))},a.onChange=function(t){return a.setState({data:Object(o.a)(Object(o.a)({},a.state.data),{},Object(i.a)({},t.target.name,t.target.value))})},a.jsonHandler=function(t){var e=Object(o.a)({},a.state.data);try{e[t.target.name]=JSON.parse(t.target.value),a.setState({data:e})}catch(n){console.log("Error converting string to JSON")}},a.updateInfo=function(){return Object(l.d)("api/visualize/network",Object(o.a)({op:"update"},a.state.data)).then((function(t){return a.setState(t)}))},a.doubleClick=function(t){console.log("DoubleClick",t.nodes[0]),a.props.changeSelf&&a.changeImport(t.nodes[0])},a.toggleEdit=function(){a.edit=!a.edit,a.viz.network.setOptions({manipulation:{enabled:a.edit}}),a.setState({result:"Edit:"+a.edit})},a.toggleFix=function(){a.viz.nodes.forEach((function(t,e){return a.viz.nodes.update({id:e,fixed:!t.fixed})})),a.setState({data:Object(o.a)(Object(o.a)({},a.state.data),{},{nodes:a.viz.nodes.get()}),result:"Fix/Unfix positions"})},a.togglePhysics=function(){var t=a.state.data;t.options.physics.enabled=!t.options.physics.enabled,a.viz.network.setOptions({physics:t.options.physics.enabled}),a.setState({data:t,physics_button:t.options.physics.enabled?j.StopButton:j.StartButton,result:"Physics:"+t.options.physics.enabled})},a.networkSync=function(t){a.viz.network.storePositions(),a.setState({data:Object(o.a)(Object(o.a)({},a.state.data),{},{nodes:a.viz.nodes.get(),edges:a.viz.edges.get()}),result:"Moved "+a.viz.nodes.get(t.nodes[0]).label})},a.showDiv=function(t){return t===a.state.content?{display:"block"}:{display:"none"}},a.state={content:"network",physics_button:j.StartButton,found:!0,data:{name:"N/A"},result:""},a.viz={network:null,nodes:null,edges:null},a.canvas=u.a.createRef(),a.edit=!1,a}return Object(a.a)(d,[{key:"componentDidMount",value:function(){var t=this;n.e(10).then(n.bind(null,59)).then((function(e){Object(l.d)("api/visualize/network",{id:t.props.id,type:t.props.type}).then((function(n){t.viz.nodes=new e.DataSet(n.data.nodes),t.viz.edges=new e.DataSet(n.data.edges),n.data.options.physics.enabled=!0,n.data.options.clickToUse=!0,t.viz.network=new e.Network(t.canvas.current,{nodes:t.viz.nodes,edges:t.viz.edges},n.data.options),t.viz.network.on("stabilizationIterationsDone",(function(){return t.viz.network.setOptions({physics:!1})})),t.viz.network.on("doubleClick",(function(e){return t.doubleClick(e)})),t.viz.network.on("dragEnd",(function(e){return t.networkSync(e)})),n.data.options.physics.enabled=!1,t.setState(n)}))}))}},{key:"render",value:function(){var t=this,e=this.state.physics_button;return Object(f.jsxs)(h.Article,{header:"Network Map",children:["device"===this.props.type&&this.props.changeSelf&&Object(f.jsx)(j.BackButton,{onClick:function(){return t.changeImport(t.props.id)}},"viz_back"),Object(f.jsx)(j.ReloadButton,{onClick:function(){return t.componentDidMount()}},"viz_reload"),Object(f.jsx)(j.EditButton,{onClick:function(){return t.toggleEdit()}},"viz_edit"),Object(f.jsx)(e,{onClick:function(){return t.togglePhysics()}},"viz_physics"),Object(f.jsx)(j.FixButton,{onClick:function(){return t.toggleFix()}},"viz_fix"),Object(f.jsx)(j.SaveButton,{onClick:function(){return t.updateInfo()}},"viz_save"),Object(f.jsx)(j.NetworkButton,{onClick:function(){return t.changeContent("network")}},"viz_net"),Object(f.jsx)(j.TextButton,{text:"Options",onClick:function(){return t.changeContent("options")}},"viz_opt"),Object(f.jsx)(j.TextButton,{text:"Nodes",onClick:function(){return t.changeContent("nodes")}},"viz_nodes"),Object(f.jsx)(j.TextButton,{text:"Edges",onClick:function(){return t.changeContent("edges")}},"viz_edges"),Object(f.jsx)(p.TextInput,{id:"name",value:this.state.data.name,onChange:this.onChange},"viz_name"),Object(f.jsx)(h.Result,{result:this.state.result},"viz_result"),Object(f.jsx)("div",{className:b.a.network,style:this.showDiv("network"),ref:this.canvas}),Object(f.jsx)("div",{className:b.a.network,style:this.showDiv("options"),children:Object(f.jsx)("textarea",{id:"options",name:"options",value:JSON.stringify(this.state.data.options,void 0,2),onChange:this.jsonHandler})}),Object(f.jsx)("div",{className:b.a.network,style:this.showDiv("nodes"),children:Object(f.jsx)("textarea",{id:"nodes",name:"nodes",value:JSON.stringify(this.state.data.nodes,void 0,2),onChange:this.jsonHandler})}),Object(f.jsx)("div",{className:b.a.network,style:this.showDiv("edges"),children:Object(f.jsx)("textarea",{id:"edges",name:"edges",value:JSON.stringify(this.state.data.edges,void 0,2),onChange:this.jsonHandler})})]},"viz_art")}}]),d}(d.Component)}}]);
//# sourceMappingURL=3.b95607b0.chunk.js.map