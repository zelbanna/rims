(this.webpackJsonprims=this.webpackJsonprims||[]).push([[10],{46:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return f})),n.d(e,"Report",(function(){return _}));var a=n(18),i=n(14),r=n(4),c=n(5),o=n(6),u=n(7),s=n(0),l=n.n(s),d=n(12),p=n(13),y=n(15),m=n(20),h=n(16),f=function(t){Object(u.a)(Main,t);var e=Object(o.a)(Main);function Main(t){var n;return Object(r.a)(this,Main),(n=e.call(this,t)).compileNavItems=function(){return n.context.loadNavigation(l.a.createElement(h.NavBar,{key:"activity_navbar"},l.a.createElement(h.NavDropDown,{key:"act_nav",title:"Activities"},l.a.createElement(h.NavDropButton,{key:"act_nav_new",title:"New",onClick:function onClick(){return n.changeContent(l.a.createElement(k,{key:"activity_info",id:"new"}))}}),l.a.createElement(h.NavDropButton,{key:"act_nav_day",title:"Daily",onClick:function onClick(){return n.changeContent(l.a.createElement(C,{key:"activity_daily",changeSelf:n.changeContent}))}}),l.a.createElement(h.NavDropButton,{key:"act_nav_list",title:"List",onClick:function onClick(){return n.changeContent(l.a.createElement(v,{key:"activity_list"}))}})),l.a.createElement(h.NavButton,{key:"act_nav_types",title:"Types",onClick:function onClick(){return n.changeContent(l.a.createElement(E,{key:"activity_type_list"}))}}),l.a.createElement(h.NavButton,{key:"act_nav_report",title:"Report",onClick:function onClick(){return n.changeContent(l.a.createElement(_,{key:"activity_report"}))}})))},n.changeContent=function(t){return n.setState(t)},n.state=l.a.createElement(C,{key:"activity_daily",changeSelf:n.changeContent}),n}return Object(c.a)(Main,[{key:"componentDidMount",value:function componentDidMount(){this.compileNavItems()}},{key:"componentDidUpdate",value:function componentDidUpdate(t){t!==this.props&&this.compileNavItems()}},{key:"render",value:function render(){return l.a.createElement(l.a.Fragment,null,this.state)}}]),Main}(s.Component);f.contextType=p.RimsContext;var v=function(t){Object(u.a)(List,t);var e=Object(o.a)(List);function List(t){var n;return Object(r.a)(this,List),(n=e.call(this,t)).listItem=function(t){return[t.date+" - "+t.time,l.a.createElement(m.HrefButton,{key:"info_"+t.id,onClick:function onClick(){return n.changeContent(l.a.createElement(k,{key:"activity",id:t.id}))},text:t.type}),l.a.createElement(l.a.Fragment,null,l.a.createElement(m.InfoButton,{key:"info",onClick:function onClick(){return n.changeContent(l.a.createElement(k,{key:"activity_info",id:t.id}))},title:"Activity information"}),l.a.createElement(m.DeleteButton,{key:"del",onClick:function onClick(){return n.deleteList(t.id)},title:"Delete activity"}))]},n.deleteList=function(t){return window.confirm("Delete activity")&&Object(d.d)("api/master/activity_delete",{id:t}).then((function(e){e.deleted&&(n.setState({data:n.state.data.filter((function(e){return e.id!==t}))}),n.changeContent(null))}))},n.state={searchfield:""},n}return Object(c.a)(List,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;if(this.state.data){var e=0===this.state.searchfield.length?this.state.data:this.state.data.filter((function(e){return e.type.includes(t.state.searchfield)}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.ContentList,{key:"cl",header:"Activities",thead:["Date","Type",""],trows:e,listItem:this.listItem},l.a.createElement(m.ReloadButton,{key:"reload",onClick:function onClick(){return t.componentDidMount()}}),l.a.createElement(m.AddButton,{key:"add",onClick:function onClick(){return t.changeContent(l.a.createElement(k,{key:"activity_info",id:"new"}))},title:"Add activity"}),l.a.createElement(y.SearchInput,{key:"search",searchFire:function searchFire(e){return t.setState({searchfield:e})},placeholder:"Search activities"})),l.a.createElement(p.ContentData,{key:"cda",mountUpdate:function mountUpdate(e){return t.changeContent=e}}))}return l.a.createElement(p.Spinner,null)}}]),List}(s.Component),k=function(t){Object(u.a)(Info,t);var e=Object(o.a)(Info);function Info(t){var n;return Object(r.a)(this,Info),(n=e.call(this,t)).onChange=function(t){return n.setState({data:Object(i.a)({},n.state.data,Object(a.a)({},t.target.name,t.target.value))})},n.updateInfo=function(){Object(d.d)("api/master/activity_info",Object(i.a)({op:"update"},n.state.data)).then((function(t){return n.setState(t)}))},n.state={data:null},n}return Object(c.a)(Info,[{key:"componentDidUpdate",value:function componentDidUpdate(t){var e=this;t!==this.props&&Object(d.d)("api/master/activity_info",{id:this.props.id}).then((function(t){null===t.data.user_id&&(t.data.user_id=e.context.settings.id),e.setState(t)}))}},{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_info",{id:this.props.id,extras:["types","users"]}).then((function(e){null===e.data.user_id&&(e.data.user_id=t.context.settings.id),t.setState(e)}))}},{key:"render",value:function render(){var t=this;return this.state.data?l.a.createElement(p.InfoArticle,{key:"ai_art",header:"Activity"},l.a.createElement(p.InfoColumns,{key:"ai_content"},l.a.createElement(y.TextLine,{key:"ai_id",id:"id",label:"ID",text:this.state.data.id}),l.a.createElement(y.SelectInput,{key:"ai_user_id",id:"user_id",label:"User",value:this.state.data.user_id,onChange:this.onChange},this.state.users.map((function(t,e){return l.a.createElement("option",{key:e,value:t.id},t.alias)}))),l.a.createElement(y.SelectInput,{key:"ai_type_id",id:"type_id",label:"Type",value:this.state.data.type_id,onChange:this.onChange},this.state.types.map((function(t,e){return l.a.createElement("option",{key:e,value:t.id},t.type)}))),l.a.createElement(y.DateInput,{key:"ai_date",id:"date",value:this.state.data.date,onChange:this.onChange}),l.a.createElement(y.TimeInput,{key:"ai_time",id:"time",value:this.state.data.time,onChange:this.onChange})),l.a.createElement(y.TextAreaInput,{key:"ai_event",id:"event",value:this.state.data.event,onChange:this.onChange}),l.a.createElement(m.SaveButton,{key:"ai_btn_save",onClick:function onClick(){return t.updateInfo()},title:"Save"}),l.a.createElement(p.Result,{key:"ai_result",result:JSON.stringify(this.state.update)})):l.a.createElement(p.Spinner,null)}}]),Info}(s.Component);k.contextType=p.RimsContext;var C=function(t){Object(u.a)(Daily,t);var e=Object(o.a)(Daily);function Daily(t){var n;Object(r.a)(this,Daily),(n=e.call(this,t)).changeContent=function(t){return n.props.changeSelf(t)},n.deleteList=function(t){return window.confirm("Delete activity")&&Object(d.d)("api/master/activity_delete",{id:t}).then((function(e){if(e.deleted){var a=n.state.data.findIndex((function(e){return e.act_id===t})),i=n.state.data[a];Object.assign(i,{user_id:null,event:null,act_id:null}),n.setState({data:n.state.data})}}))},n.onChange=function(t){var e=t.target.name,r=t.target.value,c={date:"date"===e?r:n.state.date};Object(d.d)("api/master/activity_daily",c).then((function(t){return n.setState(Object(i.a)({},t,Object(a.a)({},e,r)))}))},n.syncEvent=function(t,e){return Object(d.d)("api/master/activity_info",{op:"update",id:e||"new",user_id:n.state.user_id,type_id:t,event:"auto",date:n.state.date}).then((function(e){if(e.update){var a=n.state.data.findIndex((function(e){return e.id===t})),i=n.state.data[a];Object.assign(i,{user_id:n.state.user_id,event:"auto",act_id:e.data.id}),n.setState({data:n.state.data})}}))},n.listItem=function(t){return[t.type,t.user_id?n.state.users[t.user_id].alias:"-",t.event?t.event:"-",l.a.createElement(l.a.Fragment,null,!t.user_id&&l.a.createElement(m.AddButton,{key:"add",onClick:function onClick(){return n.syncEvent(t.id,t.act_id)}}),t.user_id&&t.user_id!==parseInt(n.state.user_id)&&l.a.createElement(m.SyncButton,{key:"sync",onClick:function onClick(){return n.syncEvent(t.id,t.act_id)}}),t.act_id&&l.a.createElement(m.InfoButton,{key:"info",onClick:function onClick(){return n.changeContent(l.a.createElement(k,{key:"activity_"+t.act_id,id:t.act_id}))}}),t.act_id&&l.a.createElement(m.DeleteButton,{key:"del",onClick:function onClick(){return n.deleteList(t.act_id)}}))]};var c=new Date(Date.now());return n.state={data:[],date:c.toISOString().substring(0,10),user_id:void 0,users:{}},n}return Object(c.a)(Daily,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_daily",{extras:["users"]}).then((function(e){return t.setState(Object(i.a)({},e,{user_id:t.context.settings.id}))}))}},{key:"render",value:function render(){var t=this;return this.state.data?l.a.createElement(p.ContentReport,{key:"cr",header:"Activities",thead:["Type","User","Event",""],trows:this.state.data,listItem:this.listItem},l.a.createElement(m.ReloadButton,{key:"reload",onClick:function onClick(){return t.componentDidMount()}}),l.a.createElement(y.SelectInput,{key:"user_id",id:"user_id",label:"User",value:this.state.user_id,onChange:this.onChange},Object.values(this.state.users).map((function(t,e){return l.a.createElement("option",{key:e,value:t.id},t.alias)}))),l.a.createElement(y.DateInput,{key:"date",id:"date",value:this.state.date,onChange:this.onChange})):l.a.createElement(p.Spinner,null)}}]),Daily}(s.Component);C.contextType=p.RimsContext;var _=function(t){Object(u.a)(Report,t);var e=Object(o.a)(Report);function Report(t){var n;return Object(r.a)(this,Report),(n=e.call(this,t)).listItem=function(t){return[t.date+" - "+t.time,t.user,t.type,t.class,t.event]},n.state={},n}return Object(c.a)(Report,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_list",{group:"month",mode:"full"}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){return l.a.createElement(p.ContentReport,{key:"act_cr",header:"Activities",thead:["Time","User","Type","Class","Event"],trows:this.state.data,listItem:this.listItem})}}]),Report}(s.Component),E=function(t){Object(u.a)(TypeList,t);var e=Object(o.a)(TypeList);function TypeList(t){var n;return Object(r.a)(this,TypeList),(n=e.call(this,t)).listItem=function(t){return[t.id,t.type,t.class,l.a.createElement(l.a.Fragment,null,l.a.createElement(m.ConfigureButton,{key:"info",onClick:function onClick(){return n.changeContent(l.a.createElement(g,{key:"act_tp",id:t.id}))},title:"Edit type information"}),l.a.createElement(m.DeleteButton,{key:"delete",onClick:function onClick(){return n.deleteList(t.id)},title:"Delete type"}))]},n.deleteList=function(t){return window.confirm("Really delete type?")&&Object(d.d)("api/master/activity_type_delete",{id:t}).then((function(e){e.deleted&&(n.setState({data:n.state.data.filter((function(e){return e.id!==t}))}),n.changeContent(null))}))},n.state={},n}return Object(c.a)(TypeList,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_type_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.ContentList,{key:"cl",header:"Activity Types",thead:["ID","Type","Class",""],trows:this.state.data,listItem:this.listItem},l.a.createElement(m.ReloadButton,{key:"reload",onClick:function onClick(){return t.componentDidMount()}}),l.a.createElement(m.AddButton,{key:"add",onClick:function onClick(){return t.changeContent(l.a.createElement(g,{key:"act_tp",id:"new"}))},title:"Add activity type"})),l.a.createElement(p.ContentData,{key:"cda",mountUpdate:function mountUpdate(e){return t.changeContent=e}}))}}]),TypeList}(s.Component),g=function(t){Object(u.a)(TypeInfo,t);var e=Object(o.a)(TypeInfo);function TypeInfo(t){var n;return Object(r.a)(this,TypeInfo),(n=e.call(this,t)).onChange=function(t){return n.setState({data:Object(i.a)({},n.state.data,Object(a.a)({},t.target.name,t.target.value))})},n.changeContent=function(t){return n.setState({content:t})},n.updateInfo=function(){return Object(d.d)("api/master/activity_type_info",Object(i.a)({op:"update"},n.state.data)).then((function(t){return n.setState(t)}))},n.state={data:null,content:null},n}return Object(c.a)(TypeInfo,[{key:"componentDidUpdate",value:function componentDidUpdate(t){var e=this;t!==this.props&&Object(d.d)("api/master/activity_type_info",{id:this.props.id}).then((function(t){return e.setState(t)}))}},{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/master/activity_type_info",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return this.state.data?l.a.createElement(p.InfoArticle,{key:"ia_at",header:"Activity Type"},l.a.createElement(p.InfoColumns,{key:"ic"},l.a.createElement(y.TextLine,{key:"id",id:"id",text:this.state.data.id}),l.a.createElement(y.TextInput,{key:"type",id:"type",value:this.state.data.type,onChange:this.onChange,placeholder:"name"}),l.a.createElement(y.SelectInput,{key:"class",id:"class",value:this.state.data.class,onChange:this.onChange},this.state.classes.map((function(t){return l.a.createElement("option",{key:t,value:t},t)})))),l.a.createElement(m.SaveButton,{key:"save",onClick:function onClick(){return t.updateInfo()},title:"Save"})):l.a.createElement(p.Spinner,null)}}]),TypeInfo}(s.Component)}}]);
//# sourceMappingURL=10.1cf27b95.chunk.js.map