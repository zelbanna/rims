"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[297],{297:(t,e,s)=>{s.r(e),s.d(e,{Inventory:()=>c,Manage:()=>d});var i=s(791),n=s(587),o=s(885),a=s(698),p=s(682),h=s(355),r=s(184);class d extends i.Component{constructor(){super(...arguments),this.changeContent=t=>this.setState(t)}componentDidMount(){(0,n.Fh)("api/device/hostname",{id:this.props.device_id}).then((t=>{this.context.loadNavigation((0,r.jsxs)(h.NavBar,{children:[(0,r.jsx)(h.NavInfo,{title:t.data},"pdu_nav_name"),(0,r.jsx)(h.NavButton,{title:"Inventory",onClick:()=>this.changeContent((0,r.jsx)(c,{device_id:this.props.device_id,type:this.props.type},"pdu_inventory"))},"pdu_nav_inv"),(0,r.jsx)(h.NavButton,{title:"Info",onClick:()=>this.changeContent((0,r.jsx)(l,{device_id:this.props.device_id,type:this.props.type},"pdu_info"))},"pdu_nav_info")]},"pdu_navbar"))})),this.setState((0,r.jsx)(c,{device_id:this.props.device_id,type:this.props.type},"pdu_inventory"))}render(){return(0,r.jsx)(r.Fragment,{children:this.state})}}d.contextType=o.RimsContext;class l extends i.Component{constructor(t){super(t),this.lookupSlots=()=>(0,n.Fh)("api/devices/"+this.props.type+"/info",{device_id:this.props.device_id,op:"lookup"}).then((t=>this.setState(t))),this.state={}}componentDidMount(){(0,n.Fh)("api/devices/"+this.props.type+"/info",{device_id:this.props.device_id}).then((t=>this.setState(t)))}render(){if(this.state.data){let t=[];for(let e=0;e<this.state.data.slots;e++)t.push((0,r.jsx)(a.TextLine,{id:"pi_slot_name_"+e,label:"Slot "+e+" Name",text:this.state.data[e+"_slot_name"]},"pi_sn_"+e)),t.push((0,r.jsx)(a.TextLine,{id:"pi_slot_id_"+e,label:"Slot "+e+" ID",text:this.state.data[e+"_slot_id"]},"pi_si_"+e));return(0,r.jsx)(o.Flex,{style:{justifyContent:"space-evenly"},children:(0,r.jsxs)(o.InfoArticle,{header:"PDU Device Info - "+this.props.type,children:[(0,r.jsxs)(o.InfoColumns,{children:[(0,r.jsx)(a.TextLine,{id:"slots",label:"Right/Left slots",text:JSON.stringify(2===this.state.data.slots)},"pi_slots"),t]},"pi_info"),(0,r.jsx)(p.ReloadButton,{onClick:()=>this.componentDidMount()},"pi_btn_reload"),(0,r.jsx)(p.SearchButton,{onClick:()=>this.lookupSlots()},"pi_btn_search")]},"pi_article")},"pi_flex")}return(0,r.jsx)(o.Spinner,{})}}class c extends i.Component{constructor(t){super(t),this.listItem=(t,e)=>[`${t.slotname}.${t.unit}`,(0,r.jsx)(p.HrefButton,{onClick:()=>this.changeContent((0,r.jsx)(_,{device_id:this.props.device_id,type:this.props.type,...t},"pdu_unit_"+e)),text:t.name,title:"Edit port info"},"inv_"+e),(0,r.jsx)(u,{idx:e,device_id:this.props.device_id,type:this.props.type,...t},"state_"+e)],this.state={}}componentDidMount(){(0,n.Fh)("api/devices/"+this.props.type+"/inventory",{device_id:this.props.device_id}).then((t=>this.setState(t)))}render(){return this.state.data?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.ContentList,{header:"Inventory",thead:["Position","Device","State"],trows:this.state.data,listItem:this.listItem,children:(0,r.jsx)(p.ReloadButton,{onClick:()=>{this.setState({data:void 0}),this.componentDidMount()}},"reload")},"cl"),(0,r.jsx)(o.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]}):(0,r.jsx)(o.Spinner,{})}}class u extends i.Component{constructor(t){super(t),this.operation=t=>{this.setState({wait:(0,r.jsx)(o.Spinner,{})}),(0,n.Fh)("api/devices/"+this.props.type+"/op",{device_id:this.props.device_id,slot:this.props.slot,unit:this.props.unit,state:t}).then((t=>this.setState({...t,wait:null})))},this.state={state:this.props.state,status:"",wait:null}}render(){const t="off"===this.state.state;return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(p.StartButton,{onClick:()=>this.operation("on"),title:this.state.status},"start"),!t&&(0,r.jsx)(p.StopButton,{onClick:()=>this.operation("off"),title:this.state.status},"stop"),!t&&(0,r.jsx)(p.ReloadButton,{onClick:()=>this.operation("reboot"),title:this.state.status},"reload"),this.state.wait]})}}class _ extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({[t.target.name]:t.target.value}),this.updatePDU=()=>{this.setState({wait:(0,r.jsx)(o.Spinner,{}),info:void 0}),(0,n.Fh)("api/devices/"+this.props.type+"/update",{op:"update",device_id:this.props.device_id,slot:this.props.slot,unit:this.props.unit,text:this.state.text}).then((t=>this.setState({...t,wait:null})))},this.state={text:this.props.name,wait:null}}render(){let t="";return this.state.status&&(t="OK"===this.state.status?"OK":this.state.info),(0,r.jsxs)(o.InfoArticle,{children:[(0,r.jsxs)(o.InfoColumns,{children:[(0,r.jsx)(a.TextLine,{id:"su",label:"Slot.Unit",text:`${this.props.slotname}.${this.props.unit}`},"pu_slot_unit"),(0,r.jsx)(a.TextInput,{id:"text",value:this.state.text,onChange:this.onChange},"pu_slot_text")]},"pu_info"),(0,r.jsx)(o.Result,{result:t},"pu_result"),(0,r.jsx)(p.SaveButton,{onClick:()=>this.updatePDU(),title:"Update pdu"},"pu_btn_save"),this.state.wait]},"pu_article")}}}}]);
//# sourceMappingURL=297.6a8c70e0.chunk.js.map