(this.webpackJsonprims=this.webpackJsonprims||[]).push([[11],{41:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return f})),n.d(e,"Report",(function(){return _}));var a=n(19),i=n(10),c=n(5),s=n(6),r=n(8),o=n(7),u=n(3),d=n(14),l=n(15),j=n(16),h=n(21),p=n(17),v=n(0),f=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).compileNavItems=function(){return a.context.loadNavigation(Object(v.jsxs)(p.NavBar,{children:[Object(v.jsxs)(p.NavDropDown,{title:"Activities",children:[Object(v.jsx)(p.NavDropButton,{title:"New",onClick:function(){return a.changeContent(Object(v.jsx)(O,{id:"new"},"activity_info"))}},"act_nav_new"),Object(v.jsx)(p.NavDropButton,{title:"Daily",onClick:function(){return a.changeContent(Object(v.jsx)(y,{changeSelf:a.changeContent},"activity_daily"))}},"act_nav_day"),Object(v.jsx)(p.NavDropButton,{title:"List",onClick:function(){return a.changeContent(Object(v.jsx)(b,{},"activity_list"))}},"act_nav_list")]},"act_nav"),Object(v.jsx)(p.NavButton,{title:"Types",onClick:function(){return a.changeContent(Object(v.jsx)(x,{},"activity_type_list"))}},"act_nav_types"),Object(v.jsx)(p.NavButton,{title:"Report",onClick:function(){return a.changeContent(Object(v.jsx)(_,{},"activity_report"))}},"act_nav_report")]},"activity_navbar"))},a.changeContent=function(t){return a.setState(t)},a.state=Object(v.jsx)(y,{changeSelf:a.changeContent},"activity_daily"),a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.compileNavItems()}},{key:"componentDidUpdate",value:function(t){t!==this.props&&this.compileNavItems()}},{key:"render",value:function(){return Object(v.jsx)(v.Fragment,{children:this.state})}}]),n}(u.Component);f.contextType=l.RimsContext;var b=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.date+" - "+t.time,Object(v.jsx)(h.HrefButton,{onClick:function(){return a.changeContent(Object(v.jsx)(O,{id:t.id},"activity"))},text:t.type},"info_"+t.id),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(h.InfoButton,{onClick:function(){return a.changeContent(Object(v.jsx)(O,{id:t.id},"activity_info"))},title:"Activity information"},"info"),Object(v.jsx)(h.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete activity"},"del")]})]},a.deleteList=function(t){return window.confirm("Delete activity")&&Object(d.d)("api/master/activity_delete",{id:t}).then((function(e){e.deleted&&(a.setState({data:a.state.data.filter((function(e){return e.id!==t}))}),a.changeContent(null))}))},a.state={searchfield:""},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;if(this.state.data){var e=0===this.state.searchfield.length?this.state.data:this.state.data.filter((function(e){return e.type.includes(t.state.searchfield)}));return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.ContentList,{header:"Activities",thead:["Date","Type",""],trows:e,listItem:this.listItem,children:[Object(v.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(v.jsx)(h.AddButton,{onClick:function(){return t.changeContent(Object(v.jsx)(O,{id:"new"},"activity_info"))},title:"Add activity"},"add"),Object(v.jsx)(j.SearchField,{searchFire:function(e){return t.setState({searchfield:e})},placeholder:"Search activities"},"search")]},"cl"),Object(v.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}return Object(v.jsx)(l.Spinner,{})}}]),n}(u.Component),O=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.updateInfo=function(){Object(d.d)("api/master/activity_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null},s}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(t){var e=this;t!==this.props&&Object(d.d)("api/master/activity_info",{id:this.props.id}).then((function(t){null===t.data.user_id&&(t.data.user_id=e.context.settings.id),e.setState(t)}))}},{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_info",{id:this.props.id,extras:["types","users"]}).then((function(e){null===e.data.user_id&&(e.data.user_id=t.context.settings.id),t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(v.jsxs)(l.InfoArticle,{header:"Activity",children:[Object(v.jsxs)(l.InfoColumns,{children:[Object(v.jsx)(j.TextLine,{id:"id",label:"ID",text:this.state.data.id},"ai_id"),Object(v.jsx)(j.SelectInput,{id:"user_id",label:"User",value:this.state.data.user_id,onChange:this.onChange,children:this.state.users.map((function(t,e){return Object(v.jsx)("option",{value:t.id,children:t.alias},e)}))},"ai_user_id"),Object(v.jsx)(j.SelectInput,{id:"type_id",label:"Type",value:this.state.data.type_id,onChange:this.onChange,children:this.state.types.map((function(t,e){return Object(v.jsx)("option",{value:t.id,children:t.type},e)}))},"ai_type_id"),Object(v.jsx)(j.DateInput,{id:"date",value:this.state.data.date,onChange:this.onChange},"ai_date"),Object(v.jsx)(j.TimeInput,{id:"time",value:this.state.data.time,onChange:this.onChange},"ai_time")]},"ai_content"),Object(v.jsx)(j.TextAreaInput,{id:"event",value:this.state.data.event,onChange:this.onChange},"ai_event"),Object(v.jsx)(h.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"ai_btn_save"),Object(v.jsx)(l.Result,{result:JSON.stringify(this.state.update)},"ai_result")]},"ai_art"):Object(v.jsx)(l.Spinner,{})}}]),n}(u.Component);O.contextType=l.RimsContext;var y=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;Object(c.a)(this,n),(s=e.call(this,t)).changeContent=function(t){return s.props.changeSelf(t)},s.deleteList=function(t){return window.confirm("Delete activity")&&Object(d.d)("api/master/activity_delete",{id:t}).then((function(e){if(e.deleted){var n=s.state.data.findIndex((function(e){return e.act_id===t})),a=s.state.data[n];Object.assign(a,{user_id:null,event:null,act_id:null}),s.setState({data:s.state.data})}}))},s.onChange=function(t){var e=t.target.name,n=t.target.value,c={date:"date"===e?n:s.state.date};Object(d.d)("api/master/activity_daily",c).then((function(t){return s.setState(Object(i.a)(Object(i.a)({},t),{},Object(a.a)({},e,n)))}))},s.syncEvent=function(t,e){return Object(d.d)("api/master/activity_info",{op:"update",id:e||"new",user_id:s.state.user_id,type_id:t,event:"auto",date:s.state.date}).then((function(e){if(e.update){var n=s.state.data.findIndex((function(e){return e.id===t})),a=s.state.data[n];Object.assign(a,{user_id:s.state.user_id,event:"auto",act_id:e.data.id}),s.setState({data:s.state.data})}}))},s.listItem=function(t){return[t.type,t.user_id?s.state.users[t.user_id].alias:"-",t.event?t.event:"-",Object(v.jsxs)(v.Fragment,{children:[!t.user_id&&Object(v.jsx)(h.AddButton,{onClick:function(){return s.syncEvent(t.id,t.act_id)}},"add"),t.user_id&&t.user_id!==parseInt(s.state.user_id)&&Object(v.jsx)(h.SyncButton,{onClick:function(){return s.syncEvent(t.id,t.act_id)}},"sync"),t.act_id&&Object(v.jsx)(h.InfoButton,{onClick:function(){return s.changeContent(Object(v.jsx)(O,{id:t.act_id},"activity_"+t.act_id))}},"info"),t.act_id&&Object(v.jsx)(h.DeleteButton,{onClick:function(){return s.deleteList(t.act_id)}},"del")]})]};var r=new Date(Date.now());return s.state={data:[],date:r.toISOString().substring(0,10),user_id:void 0,users:{}},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_daily",{extras:["users"]}).then((function(e){return t.setState(Object(i.a)(Object(i.a)({},e),{},{user_id:t.context.settings.id}))}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(v.jsxs)(l.ContentReport,{header:"Activities",thead:["Type","User","Event",""],trows:this.state.data,listItem:this.listItem,children:[Object(v.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(v.jsx)(j.SelectInput,{id:"user_id",label:"User",value:this.state.user_id,onChange:this.onChange,children:Object.values(this.state.users).map((function(t,e){return Object(v.jsx)("option",{value:t.id,children:t.alias},e)}))},"user_id"),Object(v.jsx)(j.DateInput,{id:"date",value:this.state.date,onChange:this.onChange},"date")]},"cr"):Object(v.jsx)(l.Spinner,{})}}]),n}(u.Component);y.contextType=l.RimsContext;var _=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.date+" - "+t.time,t.user,t.type,t.class,t.event]},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_list",{group:"month",mode:"full"}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return Object(v.jsx)(l.ContentReport,{header:"Activities",thead:["Time","User","Type","Class","Event"],trows:this.state.data,listItem:this.listItem},"act_cr")}}]),n}(u.Component),x=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.id,t.type,t.class,Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(h.ConfigureButton,{onClick:function(){return a.changeContent(Object(v.jsx)(m,{id:t.id},"act_tp"))},title:"Edit type information"},"info"),Object(v.jsx)(h.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete type"},"delete")]})]},a.deleteList=function(t){return window.confirm("Really delete type?")&&Object(d.d)("api/master/activity_type_delete",{id:t}).then((function(e){e.deleted&&(a.setState({data:a.state.data.filter((function(e){return e.id!==t}))}),a.changeContent(null))}))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_type_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.ContentList,{header:"Activity Types",thead:["ID","Type","Class",""],trows:this.state.data,listItem:this.listItem,children:[Object(v.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(v.jsx)(h.AddButton,{onClick:function(){return t.changeContent(Object(v.jsx)(m,{id:"new"},"act_tp"))},title:"Add activity type"},"add")]},"cl"),Object(v.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(u.Component),m=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.changeContent=function(t){return s.setState({content:t})},s.updateInfo=function(){return Object(d.d)("api/master/activity_type_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null,content:null},s}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(t){var e=this;t!==this.props&&Object(d.d)("api/master/activity_type_info",{id:this.props.id}).then((function(t){return e.setState(t)}))}},{key:"componentDidMount",value:function(){var t=this;Object(d.d)("api/master/activity_type_info",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(v.jsxs)(l.InfoArticle,{header:"Activity Type",children:[Object(v.jsxs)(l.InfoColumns,{children:[Object(v.jsx)(j.TextLine,{id:"id",text:this.state.data.id},"id"),Object(v.jsx)(j.TextInput,{id:"type",value:this.state.data.type,onChange:this.onChange,placeholder:"name"},"type"),Object(v.jsx)(j.SelectInput,{id:"class",value:this.state.data.class,onChange:this.onChange,children:this.state.classes.map((function(t){return Object(v.jsx)("option",{value:t,children:t},t)}))},"class")]},"ic"),Object(v.jsx)(h.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"save")]},"ia_at"):Object(v.jsx)(l.Spinner,{})}}]),n}(u.Component)}}]);
//# sourceMappingURL=11.ea935569.chunk.js.map