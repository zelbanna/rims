"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[682],{224:function(t,e,n){n.r(e),n.d(e,{Device:function(){return m},List:function(){return x},Search:function(){return v}});var i=n(413),r=n(942),a=n(671),s=n(144),c=n(340),o=n(882),h=n(791),u=n(252),d=n(885),f=n(698),l=n(682),p=n(184),v=function(t){(0,c.Z)(n,t);var e=(0,o.Z)(n);function n(t){var i;return(0,a.Z)(this,n),(i=e.call(this,t)).changeContent=function(t){return i.props.changeSelf(t)},i.onChange=function(t){return i.setState((0,r.Z)({},t.target.name,t.target.value))},i.state={field:"mac",search:""},i}return(0,s.Z)(n,[{key:"render",value:function(){var t=this;return(0,p.jsxs)(d.LineArticle,{header:"FDB Search",children:[(0,p.jsxs)(f.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,p.jsx)("option",{value:"mac",children:"MAC"}),(0,p.jsx)("option",{value:"device_id",children:"Device ID"})]},"field"),(0,p.jsx)(f.TextInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,p.jsx)(l.SearchButton,{onClick:function(){return t.changeContent((0,p.jsx)(x,(0,i.Z)((0,i.Z)({},t.state),{},{changeSelf:t.props.changeSelf}),"fdb_list"))},title:"Search FDB"},"fs_btn_search")]},"fs_art")}}]),n}(h.Component),m=function(t){(0,c.Z)(r,t);var e=(0,o.Z)(r);function r(t){var i;return(0,a.Z)(this,r),(i=e.call(this,t)).changeContent=function(t){return i.props.changeSelf(t)},i.changeInterface=function(t){return n.e(167).then(n.bind(n,167)).then((function(e){return i.changeContent((0,p.jsx)(e.Info,{device_id:i.props.id,interface_id:t,changeSelf:i.changeContent},"interface_info"))}))},i.listItem=function(t,e){return[t.vlan,t.snmp_index,(0,p.jsx)(l.HrefButton,{text:t.name,onClick:function(){return i.changeInterface(t.interface_id)}},"fd_intf_"+t.interface_id),t.mac,t.oui]},i.state={wait:null,searchfield:""},i}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){var t=this;(0,u.Fh)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((function(e){return t.setState(e)}))}},{key:"syncFDB",value:function(){var t=this;this.setState({wait:(0,p.jsx)(d.Spinner,{})}),(0,u.Fh)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then((function(e){return"OK"===e.status&&(0,u.Fh)("api/fdb/list",{field:"device_id",search:t.props.id,extra:["oui"]}).then((function(e){return t.setState((0,i.Z)((0,i.Z)({},e),{},{wait:null}))}))}))}},{key:"render",value:function(){var t=this;if(this.state.data){var e=this.state.searchfield.toUpperCase(),n=0===e.length?this.state.data:this.state.data.filter((function(t){return t.mac.includes(e)}));return(0,p.jsxs)(d.ContentReport,{header:"FDB",thead:["VLAN","SNMP","Interface","MAC","OUI"],trows:n,listItem:this.listItem,children:[(0,p.jsx)(l.ReloadButton,{onClick:function(){return t.componentDidMount()}},"fd_btn_reload"),(0,p.jsx)(l.SyncButton,{onClick:function(){return t.syncFDB()},title:"Resync FDB"},"fd_btn_sync"),(0,p.jsx)(f.SearchField,{searchFire:function(e){return t.setState({searchfield:e})},placeholder:"Search MAC"},"fd_search"),this.state.wait]},"fd_cr")}return(0,p.jsx)(d.Spinner,{})}}]),r}(h.Component),x=function(t){(0,c.Z)(i,t);var e=(0,o.Z)(i);function i(t){var r;return(0,a.Z)(this,i),(r=e.call(this,t)).changeSearch=function(t,e){return r.changeContent((0,p.jsx)(C,{mac:t},"fdb_info"))},r.changeVisualize=function(t){return"changeSelf"in r.props&&n.e(559).then(n.bind(n,559)).then((function(e){return r.changeContent((0,p.jsx)(e.Edit,{type:"device",id:t},"viz_id_"+t))}))},r.listItem=function(t,e){return[t.device_id,t.hostname,t.vlan,t.snmp_index,t.name,(0,p.jsx)(l.HrefButton,{text:t.mac,onClick:function(){return r.setState({searchfield:t.mac})}},"intf_"+e),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.InfoButton,{onClick:function(){return r.changeSearch(t.mac,e)},title:"Find interface(s)"},"info"),(0,p.jsx)(l.NetworkButton,{onClick:function(){return r.changeVisualize(t.device_id)}},"map")]})]},r.state={searchfield:""},r}return(0,s.Z)(i,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;(0,u.Fh)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;if(this.state.data){var e=this.state.searchfield.toUpperCase(),n=0===e.length?this.state.data:this.state.data.filter((function(t){return t.mac.includes(e)}));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(d.ContentList,{header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:n,listItem:this.listItem,children:[(0,p.jsx)(l.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),(0,p.jsx)(f.SearchField,{searchFire:function(e){return t.setState({searchfield:e})},placeholder:"Search MAC",text:this.state.searchfield},"search")]},"cl"),(0,p.jsx)(d.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}return(0,p.jsx)(d.Spinner,{})}}]),i}(h.Component),C=function(t){(0,c.Z)(n,t);var e=(0,o.Z)(n);function n(t){var i;return(0,a.Z)(this,n),(i=e.call(this,t)).state={},i}return(0,s.Z)(n,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;(0,u.Fh)("api/fdb/search",{mac:this.props.mac}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return this.state.device?(0,p.jsx)(d.ContentReport,{header:"".concat(this.state.device.hostname," (").concat(this.state.device.id,")"),thead:["ID","Interface","Description","OUI"],trows:this.state.interfaces,listItem:function(t){return[t.interface_id,t.name,t.description,t.oui]}},"fd_cr"):this.state.oui?(0,p.jsxs)(d.LineArticle,{header:"Search result",children:["OUI: ",this.state.oui]},"fd_oui_la"):this.state.status?(0,p.jsxs)(d.LineArticle,{header:"Search result",children:["Search result: ",this.state.info]},"fd_oui_la"):(0,p.jsx)(d.Spinner,{})}}]),n}(h.Component)}}]);
//# sourceMappingURL=682.fa6caf08.chunk.js.map