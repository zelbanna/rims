(this.webpackJsonprims=this.webpackJsonprims||[]).push([[18],{46:function(e,t,n){"use strict";n.r(t),n.d(t,"List",(function(){return p})),n.d(t,"LogShow",(function(){return j})),n.d(t,"TaskShow",(function(){return C}));var a=n(18),o=n(14),r=n(4),i=n(5),c=n(6),s=n(7),u=n(0),l=n.n(u),d=n(12),h=n(13),m=n(16),f=n(15),k=n(20),p=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).listItem=function(e){return[e.node,e.url,l.a.createElement(l.a.Fragment,null,l.a.createElement(k.InfoButton,{key:"info",onClick:function(){return a.changeContent(l.a.createElement(y,{key:"node_info",id:e.id}))},title:"Node information"}),l.a.createElement(k.DeleteButton,{key:"del",onClick:function(){return a.deleteList(e.id)},title:"Delete node"}))]},a.deleteList=function(e){return window.confirm("Really delete node?")&&Object(d.d)("api/master/node_delete",{id:e}).then((function(t){t.deleted&&(a.setState({data:a.state.data.filter((function(t){return t.id!==e}))}),a.changeContent(null))}))},a.state={},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/master/node_list").then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.ContentList,{key:"cl",header:"Nodes",thead:["Node","URL",""],trows:this.state.data,listItem:this.listItem},l.a.createElement(k.ReloadButton,{key:"reload",onClick:function(){return e.componentDidMount()}}),l.a.createElement(k.AddButton,{key:"add",onClick:function(){return e.changeContent(l.a.createElement(y,{key:"node_info",id:"new"}))},title:"Add node"})),l.a.createElement(h.ContentData,{key:"cda",mountUpdate:function(t){return e.changeContent=t}}))}}]),n}(u.Component),y=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e)).searchInfo=function(){return Object(d.d)("api/device/search",{node:i.state.data.node}).then((function(e){return e.found&&i.setState({data:Object(o.a)({},i.state.data,{hostname:e.data.hostname,device_id:e.data.id})})}))},i.onChange=function(e){return i.setState({data:Object(o.a)({},i.state.data,Object(a.a)({},e.target.name,e.target.value))})},i.changeContent=function(e){return i.setState({content:e})},i.updateInfo=function(){return Object(d.d)("api/master/node_info",Object(o.a)({op:"update"},i.state.data)).then((function(e){return i.setState(e)}))},i.state={data:null,found:!0},i}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e){e!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/master/node_info",{id:this.props.id}).then((function(t){return e.setState(Object(o.a)({},t,{content:null}))}))}},{key:"render",value:function(){var e=this;if(this.state.found){if(this.state.data){var t=this.state.data.id,n="new"!==t;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.InfoArticle,{key:"ia_node",header:"Node"},l.a.createElement(h.InfoColumns,{key:"ic"},l.a.createElement(f.TextInput,{key:"node",id:"node",value:this.state.data.node,onChange:this.onChange}),l.a.createElement(f.UrlInput,{key:"url",id:"url",value:this.state.data.url,onChange:this.onChange}),l.a.createElement(f.TextInput,{key:"hostname",id:"hostname",value:this.state.data.hostname,onChange:this.onChange})),l.a.createElement(k.SaveButton,{key:"save",onClick:function(){return e.updateInfo()},title:"Save information"}),n&&!this.state.data.hostname&&l.a.createElement(k.SearchButton,{key:"search",onClick:this.searchInfo,title:"Try to map node to device"}),n&&l.a.createElement(k.ReloadButton,{key:"reload",onClick:function(){return e.changeContent(l.a.createElement(v,{key:"node_reload_"+t,node:e.state.data.node}))}}),n&&l.a.createElement(k.LogButton,{key:"logs",onClick:function(){return e.changeContent(l.a.createElement(j,{key:"node_logs_"+t,node:e.state.data.node}))},title:"View node logs"}),n&&l.a.createElement(k.TimeButton,{key:"tasks",onClick:function(){return e.changeContent(l.a.createElement(C,{key:"node_tasks_"+t,node:e.state.data.node}))},title:"View node tasks"}),n&&l.a.createElement(k.DeleteButton,{key:"logc",onClick:function(){return e.changeContent(l.a.createElement(g,{key:"node_logc_"+t,node:e.state.data.node}))},title:"Clear logs"})),l.a.createElement(m.NavBar,{key:"node_navigation",id:"node_navigation"}),this.state.content)}return l.a.createElement(h.Spinner,null)}return l.a.createElement(h.InfoArticle,{key:"ia_node"},"Node with id: ",this.props.id," removed")}}]),n}(u.Component),v=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/system/reload",{},{"X-Route":this.props.node}).then((function(t){t?e.setState(t):e.setState({modules:["error reloading modules (check REST call)"]})}))}},{key:"render",value:function(){return this.state?l.a.createElement(h.CodeArticle,{key:"nr_code",header:"Module"},this.state.modules.join("\n")):l.a.createElement(h.Spinner,null)}}]),n}(u.Component),g=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/system/logs_clear",{},{"X-Route":this.props.node}).then((function(t){return e.setState({logs:t.file})}))}},{key:"render",value:function(){return this.state?l.a.createElement(h.CodeArticle,{key:"nc_code",header:"Cleared"},Object.entries(this.state.logs).map((function(e){return"".concat(e[0],": ").concat(e[1])})).join("\n")):l.a.createElement(h.Spinner,null)}}]),n}(u.Component),j=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/system/logs_get",{},{"X-Route":this.props.node}).then((function(t){var n=t?{logs:t}:{error:!0};e.setState(n)}))}},{key:"render",value:function(){return this.state.logs?l.a.createElement("div",null,Object.entries(this.state.logs).map((function(e,t){return l.a.createElement(h.CodeArticle,{key:t,header:e[0]},e[1].join("\n"))}))):this.state.error?l.a.createElement(h.CodeArticle,null,"error retrieving logs (check REST call)"):l.a.createElement(h.Spinner,null)}}]),n}(u.Component),C=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).listItem=function(e){return[e.module,e.function,e.frequency,JSON.stringify(e.output),JSON.stringify(e.args)]},a.state={},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/system/task_list",{},{"X-Route":this.props.node}).then((function(t){var n=t?{tasks:t}:{error:!0};e.setState(n)}))}},{key:"render",value:function(){return this.state.tasks?l.a.createElement(h.ContentReport,{key:"cr_task_show",header:"Tasks",thead:["Module","Function","Frequency","Output","Arguments"],trows:this.state.tasks.data,listItem:this.listItem}):this.state.error?l.a.createElement(h.CodeArticle,null,"error retrieving tasks (check REST call)"):l.a.createElement(h.Spinner,null)}}]),n}(u.Component)}}]);
//# sourceMappingURL=18.c7613cf8.chunk.js.map