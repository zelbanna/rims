{"version":3,"sources":["inventory.jsx"],"names":["Main","compileNavItems","context","loadNavigation","title","onClick","changeContent","Search","changeSelf","Vendor","List","changeLocation","then","lib","setState","elem","this","prevProps","props","state","Component","contextType","RimsContext","listItem","row","id","serial","model","Info","deleteList","window","confirm","post_call","result","deleted","data","filter","searchfield","args","inv_list","length","includes","header","thead","trows","componentDidMount","rnd","searchFire","s","placeholder","mountUpdate","fun","onChange","e","target","name","type","field","search","value","content","updateInfo","op","found","vendor","label","product","description","location_id","locations","map","idx","receive_date","purchase_order","license","license_key","support_contract","support_end_date","comments","text","count","Report","extra","sort"],"mappings":"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","file":"static/js/16.b61e8537.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport { post_call, rnd } from './infra/Functions.js';\nimport { RimsContext, Spinner, LineArticle, InfoArticle, InfoColumns, ContentList, ContentData, ContentReport } from './infra/UI.jsx';\nimport { TextInput, SearchField, SelectInput, DateInput, CheckboxInput } from './infra/Inputs.jsx';\nimport { AddButton, DeleteButton, InfoButton, ReloadButton, SaveButton, SearchButton, HrefButton } from './infra/Buttons.jsx';\nimport { NavBar, NavButton, NavDropDown, NavDropButton } from './infra/Navigation.jsx';\n\n// ************** Main **************\n//\nexport class Main extends Component {\n\n componentDidMount(){\n  this.compileNavItems()\n }\n\n componentDidUpdate(prevProps){\n  if(prevProps !== this.props)\n   this.compileNavItems()\n }\n\n compileNavItems = () => this.context.loadNavigation(<NavBar key='inventory_navbar'>\n   <NavDropDown key='inv_nav_inv' title='Inventory'>\n    <NavDropButton key='inv_nav_srch' title='Search' onClick={() => this.changeContent(<Search key='search_list' changeSelf={this.changeContent} />)} />\n    <NavDropButton key='inv_nav_vend' title='Vendor' onClick={() => this.changeContent(<Vendor key='vendor_list' changeSelf={this.changeContent} />)} />\n    <NavDropButton key='inv_nav_list' title='List'   onClick={() => this.changeContent(<List key='list' changeSelf={this.changeContent} />)} />\n   </NavDropDown>\n   <NavButton key='inv_nav_loc' title='Locations' onClick={() => this.changeLocation()} />\n  </NavBar>)\n\n changeLocation = () => import('./location.jsx').then(lib => this.setState(<lib.List key='location_list' />));\n\n changeContent = (elem) => this.setState(elem)\n\n render(){\n  return <>{this.state}</>\n }\n}\nMain.contextType = RimsContext;\n\n// ************** List **************\n//\nclass List extends Component {\n constructor(props){\n  super(props)\n  this.state = {searchfield:''}\n }\n\n componentDidMount(){\n  post_call('api/inventory/list',this.props.args).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.id,row.serial,row.model,<>\n   <InfoButton key='info' onClick={() => this.changeContent(<Info key={'inventory_'+row.id} id={row.id} />) } title='View inventory item' />\n   <DeleteButton key='del' onClick={() => this.deleteList(row.id)} title='Delete inventory item' />\n  </>]\n\n deleteList = (id) => (window.confirm('Really delete item') && post_call('api/inventory/delete', {id:id}).then(result => {\n  if (result.deleted){\n   this.setState({data:this.state.data.filter(row => (row.id !== id))});\n   this.changeContent(null);\n  }}))\n\n render(){\n  if (!this.state.data)\n   return <Spinner />\n  else {\n   const inv_list = (this.state.searchfield.length === 0) ? this.state.data : this.state.data.filter(row => (row.model.includes(this.state.searchfield) || row.serial.includes(this.state.searchfield)));\n   return <>\n    <ContentList key='cl' header='Inventory' thead={['ID','Serial','Model','']} trows={inv_list} listItem={this.listItem} result={this.state.result}>\n     <ReloadButton key='reload' onClick={() => this.componentDidMount() } />\n     <AddButton key='add' onClick={() => this.changeContent(<Info key={'inventory_new_' + rnd()} id='new' />) } title='Add inventory item' />\n     <SearchField key='search' searchFire={(s) => this.setState({searchfield:s})} placeholder='Search inventory (case sensitive)' />\n    </ContentList>\n    <ContentData key='cda' mountUpdate={(fun) => this.changeContent = fun} />\n   </>\n  }\n }\n}\n\n// ************** Search **************\n//\nclass Search extends Component {\n constructor(props){\n  super(props)\n  this.state = {data:{field:'serial',search:''}}\n }\n\n changeContent = (elem) => this.props.changeSelf(elem);\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target[(e.target.type !== 'checkbox') ? 'value' : 'checked']}})\n\n render() {\n  return <LineArticle key='inv_srch_art' header='Inventory search'>\n   <SelectInput key='field' id='field' value={this.state.data.field} onChange={this.onChange}><option value='serial'>Serial</option><option value='vendor'>Vendor</option></SelectInput>\n   <TextInput key='search' id='search' value={this.state.data.search} placeholder='search' onChange={this.onChange} />\n   <SearchButton key='inv_btn_search' onClick={() => this.changeContent(<List key='inventory_list' args={this.state.data} />)} title='Search inventory' />\n  </LineArticle>\n }\n}\n\n// ************** Info **************\n//\nexport class Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {data:null, found:true};\n }\n\n componentDidMount(){\n  post_call('api/inventory/info',{id:this.props.id}).then(result => this.setState(result))\n }\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target[(e.target.type !== 'checkbox') ? 'value' : 'checked']}})\n\n changeContent = (elem) => this.setState({content:elem})\n\n updateInfo = () => post_call('api/inventory/info',{op:'update', ...this.state.data}).then(result => this.setState(result))\n\n render() {\n  if (this.state.data){\n   const data = this.state.data;\n   return <InfoArticle key='inv_article' header='Inventory Item'>\n     <InfoColumns key='inv_content'>\n      <TextInput key='vendor' id='vendor' value={data.vendor} onChange={this.onChange} />\n      <TextInput key='serial' id='serial' label='S/N' value={data.serial} onChange={this.onChange} />\n      <TextInput key='product' id='product' value={data.product} onChange={this.onChange} />\n      <TextInput key='model' id='model' value={data.model} onChange={this.onChange} />\n      <TextInput key='description' id='description' value={data.description} onChange={this.onChange} />\n      <SelectInput key='location_id' id='location_id' label='Location' value={data.location_id} onChange={this.onChange}>{this.state.locations.map((row,idx) => <option key={'ii_'+idx} value={row.id}>{row.name}</option>)}</SelectInput>\n      <DateInput key='receive_date' id='receive_date' label='Received' value={data.receive_date} onChange={this.onChange} />\n      <TextInput key='purchase_order' id='purchase_order' label='Purchase Order' value={data.purchase_order} onChange={this.onChange} />\n      <CheckboxInput key='license' id='license' value={data.license} onChange={this.onChange} />\n      {(data.license && <TextInput key='license_key' id='license_key' label='Key' value={data.license_key} onChange={this.onChange} />)}\n      <CheckboxInput key='support_contract' id='support_contract' value={data.support_contract} onChange={this.onChange} />\n      {(data.support_contract && <DateInput key='support_end_date' id='support_end_date' label='Contract End' value={data.support_end_date} onChange={this.onChange} />)}\n      <TextInput key='comments' id='comments' value={data.comments} onChange={this.onChange} />\n     </InfoColumns>\n     <ReloadButton key='inv_btn_reload' onClick={() => this.componentDidMount() } />\n     {data.serial && <SaveButton key='inv_btn_save' onClick={() => this.updateInfo()} title='Save' />}\n    </InfoArticle>\n  } else\n   return <Spinner />\n }\n}\n\n// ************** Vendor **************\n//\nclass Vendor extends Component {\n constructor(props){\n  super(props)\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/inventory/vendor_list').then(result => this.setState(result))\n }\n\n listItem = (row) => [<HrefButton key={'search_' +row.vendor} text={row.vendor} onClick={() => this.changeContent(<List key='inventory_list' args={{field:'vendor', search:row.vendor}} />)} />,row.count]\n\n render(){\n  return <>\n   <ContentList key='cl' header='Vendors' thead={['Name','Count']} trows={this.state.data} listItem={this.listItem} />\n   <ContentData key='cda' mountUpdate={(fun) => this.changeContent = fun} />\n  </>\n }\n}\n\n// ************** Report **************\n//\nexport class Report extends Component {\n constructor(props){\n  super(props)\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/inventory/list', { extra:['vendor','product','description'], sort:'vendor'}).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.id,row.serial,row.vendor,row.model,row.product,row.description]\n\n render(){\n  return <ContentReport key='inv_cr' header='Inventory' thead={['ID','Serial','Vendor','Model','Product','Description']} trows={this.state.data} listItem={this.listItem} />\n }\n}\n"],"sourceRoot":""}