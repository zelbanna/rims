"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[559],{559:function(t,n,e){e.r(n),e.d(n,{Edit:function(){return x},List:function(){return k},Main:function(){return g}});var i=e(942),o=e(413),s=e(671),a=e(144),r=e(340),d=e(882),u=e(791),c=e(252),l=e(885),h=e(682),p=e(698),v=e(582),f=e(184),g=function(t){(0,r.Z)(e,t);var n=(0,d.Z)(e);function e(t){var i;return(0,s.Z)(this,e),(i=n.call(this,t)).changeContent=function(t){return i.setState(t)},i.state=(0,f.jsx)(k,{},"viz_list"),i}return(0,a.Z)(e,[{key:"render",value:function(){return(0,f.jsx)(f.Fragment,{children:this.state})}}]),e}(u.Component),k=function(t){(0,r.Z)(e,t);var n=(0,d.Z)(e);function e(t){var i;return(0,s.Z)(this,e),(i=n.call(this,t)).listItem=function(t){return[t.id,t.name,(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.EditButton,{onClick:function(){return i.changeContent((0,f.jsx)(x,{id:t.id,changeSelf:i.changeContent,type:"map"},"viz_edit_"+t.id))},title:"Show and edit map"},"edit"),(0,f.jsx)(h.NetworkButton,{onClick:function(){return window.open("viz.html?id=".concat(t.id),"_blank")},title:"Show resulting map"},"net"),(0,f.jsx)(h.DeleteButton,{onClick:function(){return i.deleteList(t.id)}},"del")]})]},i.deleteList=function(t){return window.confirm("Delete map?")&&(0,c.Fh)("api/visualize/delete",{id:t}).then((function(n){n.deleted&&(i.setState({data:i.state.data.filter((function(n){return n.id!==t}))}),i.changeContent(null))}))},i.state={},i}return(0,a.Z)(e,[{key:"componentDidMount",value:function(){var t=this;(0,c.Fh)("api/visualize/list").then((function(n){t.setState(n)}))}},{key:"render",value:function(){var t=this;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(l.ContentList,{header:"Maps",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem,children:(0,f.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload")},"cl"),(0,f.jsx)(l.ContentData,{mountUpdate:function(n){return t.changeContent=n}},"cda")]})}}]),e}(u.Component),x=function(t){(0,r.Z)(g,t);var n=(0,d.Z)(g);function g(t){var a;return(0,s.Z)(this,g),(a=n.call(this,t)).changeContent=function(t){return a.setState({content:t})},a.changeImport=function(t){return e.e(531).then(e.bind(e,531)).then((function(n){return a.props.changeSelf((0,f.jsx)(n.Info,{id:t},"di_"+t))}))},a.onChange=function(t){return a.setState({data:(0,o.Z)((0,o.Z)({},a.state.data),{},(0,i.Z)({},t.target.name,t.target.value))})},a.jsonHandler=function(t){var n=(0,o.Z)({},a.state.data);try{n[t.target.name]=JSON.parse(t.target.value),a.setState({data:n})}catch(e){console.log("Error converting string to JSON")}},a.updateInfo=function(){return(0,c.Fh)("api/visualize/network",(0,o.Z)({op:"update"},a.state.data)).then((function(t){return a.setState(t)}))},a.doubleClick=function(t){console.log("DoubleClick",t.nodes[0]),a.props.changeSelf&&a.changeImport(t.nodes[0])},a.toggleEdit=function(){a.edit=!a.edit,a.viz.network.setOptions({manipulation:{enabled:a.edit}}),a.setState({result:"Edit:"+a.edit})},a.toggleFix=function(){a.viz.nodes.forEach((function(t,n){return a.viz.nodes.update({id:n,fixed:!t.fixed})})),a.setState({data:(0,o.Z)((0,o.Z)({},a.state.data),{},{nodes:a.viz.nodes.get()}),result:"Fix/Unfix positions"})},a.togglePhysics=function(){var t=a.state.data;t.options.physics.enabled=!t.options.physics.enabled,a.viz.network.setOptions({physics:t.options.physics.enabled}),a.setState({data:t,physics_button:t.options.physics.enabled?h.StopButton:h.StartButton,result:"Physics:"+t.options.physics.enabled})},a.networkSync=function(t){a.viz.network.storePositions(),a.setState({data:(0,o.Z)((0,o.Z)({},a.state.data),{},{nodes:a.viz.nodes.get(),edges:a.viz.edges.get()}),result:"Moved "+a.viz.nodes.get(t.nodes[0]).label})},a.showDiv=function(t){return t===a.state.content?{display:"block"}:{display:"none"}},a.state={content:"network",physics_button:h.StartButton,found:!0,data:{name:"N/A"},result:""},a.viz={network:null,nodes:null,edges:null},a.canvas=u.createRef(),a.edit=!1,a}return(0,a.Z)(g,[{key:"componentDidMount",value:function(){var t=this;e.e(778).then(e.bind(e,778)).then((function(n){(0,c.Fh)("api/visualize/network",{id:t.props.id,type:t.props.type}).then((function(e){t.viz.nodes=new n.DataSet(e.data.nodes),t.viz.edges=new n.DataSet(e.data.edges),e.data.options.physics.enabled=!0,e.data.options.clickToUse=!0,t.viz.network=new n.Network(t.canvas.current,{nodes:t.viz.nodes,edges:t.viz.edges},e.data.options),t.viz.network.on("stabilizationIterationsDone",(function(){return t.viz.network.setOptions({physics:!1})})),t.viz.network.on("doubleClick",(function(n){return t.doubleClick(n)})),t.viz.network.on("dragEnd",(function(n){return t.networkSync(n)})),e.data.options.physics.enabled=!1,t.setState(e)}))}))}},{key:"render",value:function(){var t=this,n=this.state.physics_button;return(0,f.jsxs)(l.Article,{header:"Network Map",children:["device"===this.props.type&&this.props.changeSelf&&(0,f.jsx)(h.BackButton,{onClick:function(){return t.changeImport(t.props.id)}},"viz_back"),(0,f.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"viz_reload"),(0,f.jsx)(h.EditButton,{onClick:function(){return t.toggleEdit()}},"viz_edit"),(0,f.jsx)(n,{onClick:function(){return t.togglePhysics()}},"viz_physics"),(0,f.jsx)(h.FixButton,{onClick:function(){return t.toggleFix()}},"viz_fix"),(0,f.jsx)(h.SaveButton,{onClick:function(){return t.updateInfo()}},"viz_save"),(0,f.jsx)(h.NetworkButton,{onClick:function(){return t.changeContent("network")}},"viz_net"),(0,f.jsx)(h.TextButton,{text:"Options",onClick:function(){return t.changeContent("options")}},"viz_opt"),(0,f.jsx)(h.TextButton,{text:"Nodes",onClick:function(){return t.changeContent("nodes")}},"viz_nodes"),(0,f.jsx)(h.TextButton,{text:"Edges",onClick:function(){return t.changeContent("edges")}},"viz_edges"),(0,f.jsx)(p.TextInput,{id:"name",value:this.state.data.name,onChange:this.onChange},"viz_name"),(0,f.jsx)(l.Result,{result:this.state.result},"viz_result"),(0,f.jsx)("div",{className:v.Z.network,style:this.showDiv("network"),ref:this.canvas}),(0,f.jsx)("div",{className:v.Z.network,style:this.showDiv("options"),children:(0,f.jsx)("textarea",{id:"options",name:"options",value:JSON.stringify(this.state.data.options,void 0,2),onChange:this.jsonHandler})}),(0,f.jsx)("div",{className:v.Z.network,style:this.showDiv("nodes"),children:(0,f.jsx)("textarea",{id:"nodes",name:"nodes",value:JSON.stringify(this.state.data.nodes,void 0,2),onChange:this.jsonHandler})}),(0,f.jsx)("div",{className:v.Z.network,style:this.showDiv("edges"),children:(0,f.jsx)("textarea",{id:"edges",name:"edges",value:JSON.stringify(this.state.data.edges,void 0,2),onChange:this.jsonHandler})})]},"viz_art")}}]),g}(u.Component)}}]);
//# sourceMappingURL=559.d4b9869e.chunk.js.map