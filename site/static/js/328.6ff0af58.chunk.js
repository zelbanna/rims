"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[328],{328:(e,t,s)=>{s.r(t),s.d(t,{Device:()=>d,List:()=>l,Search:()=>o});var i=s(43),n=s(524),a=s(662),h=s(97),c=s(728),r=s(579);class o extends i.Component{constructor(e){super(e),this.changeContent=e=>this.props.changeSelf(e),this.onChange=e=>this.setState({[e.target.name]:e.target.value}),this.state={field:"mac",search:""}}render(){return(0,r.jsxs)(a.LineArticle,{header:"FDB Search",children:[(0,r.jsxs)(h.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,r.jsx)("option",{value:"mac",children:"MAC"}),(0,r.jsx)("option",{value:"device_id",children:"Device ID"})]},"field"),(0,r.jsx)(h.TextInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,r.jsx)(c.SearchButton,{onClick:()=>this.changeContent((0,r.jsx)(l,{...this.state,changeSelf:this.props.changeSelf},"fdb_list")),title:"Search FDB"},"fs_btn_search")]},"fs_art")}}class d extends i.Component{constructor(e){super(e),this.changeContent=e=>this.props.changeSelf(e),this.changeInterface=e=>s.e(617).then(s.bind(s,617)).then(t=>this.changeContent((0,r.jsx)(t.Info,{device_id:this.props.id,interface_id:e,changeSelf:this.changeContent},"interface_info"))),this.listItem=(e,t)=>[e.vlan,e.snmp_index,(0,r.jsx)(c.HrefButton,{text:e.name,onClick:()=>this.changeInterface(e.interface_id)},"fd_intf_"+e.interface_id),e.mac,e.oui],this.state={wait:null,searchfield:""}}componentDidMount(){(0,n.Cc)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then(e=>this.setState(e))}syncFDB(){this.setState({wait:(0,r.jsx)(a.Spinner,{})}),(0,n.Cc)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then(e=>"OK"===e.status&&(0,n.Cc)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then(e=>this.setState({...e,wait:null})))}render(){if(this.state.data){const e=this.state.searchfield.toUpperCase(),t=0===e.length?this.state.data:this.state.data.filter(t=>t.mac.includes(e));return(0,r.jsxs)(a.ContentReport,{header:"FDB",thead:["VLAN","SNMP","Interface","MAC","OUI"],trows:t,listItem:this.listItem,children:[(0,r.jsx)(c.ReloadButton,{onClick:()=>this.componentDidMount()},"fd_btn_reload"),(0,r.jsx)(c.SyncButton,{onClick:()=>this.syncFDB(),title:"Resync FDB"},"fd_btn_sync"),(0,r.jsx)(h.SearchField,{searchFire:e=>this.setState({searchfield:e}),placeholder:"Search MAC"},"fd_search"),this.state.wait]},"fd_cr")}return(0,r.jsx)(a.Spinner,{})}}class l extends i.Component{constructor(e){super(e),this.changeSearch=(e,t)=>this.changeContent((0,r.jsx)(p,{mac:e},"fdb_info")),this.changeVisualize=e=>"changeSelf"in this.props&&s.e(362).then(s.bind(s,362)).then(t=>this.changeContent((0,r.jsx)(t.Edit,{type:"device",id:e},"viz_id_"+e))),this.listItem=(e,t)=>[e.device_id,e.hostname,e.vlan,e.snmp_index,e.name,(0,r.jsx)(c.HrefButton,{text:e.mac,onClick:()=>this.setState({searchfield:e.mac})},"intf_"+t),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.InfoButton,{onClick:()=>this.changeSearch(e.mac,t),title:"Find interface(s)"},"info"),(0,r.jsx)(c.NetworkButton,{onClick:()=>this.changeVisualize(e.device_id)},"map")]})],this.state={searchfield:""}}componentDidUpdate(e){e!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Cc)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then(e=>this.setState(e))}render(){if(this.state.data){const e=this.state.searchfield.toUpperCase(),t=0===e.length?this.state.data:this.state.data.filter(t=>t.mac.includes(e));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.ContentList,{header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:t,listItem:this.listItem,children:[(0,r.jsx)(c.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,r.jsx)(h.SearchField,{searchFire:e=>this.setState({searchfield:e}),placeholder:"Search MAC",text:this.state.searchfield},"search")]},"cl"),(0,r.jsx)(a.ContentData,{mountUpdate:e=>this.changeContent=e},"cda")]})}return(0,r.jsx)(a.Spinner,{})}}class p extends i.Component{constructor(e){super(e),this.state={}}componentDidUpdate(e){e!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Cc)("api/fdb/search",{mac:this.props.mac}).then(e=>this.setState(e))}render(){return this.state.device?(0,r.jsx)(a.ContentReport,{header:`${this.state.device.hostname} (${this.state.device.id})`,thead:["ID","Interface","Description","OUI"],trows:this.state.interfaces,listItem:e=>[e.interface_id,e.name,e.description,e.oui]},"fd_cr"):this.state.oui?(0,r.jsxs)(a.LineArticle,{header:"Search result",children:["OUI: ",this.state.oui]},"fd_oui_la"):this.state.status?(0,r.jsxs)(a.LineArticle,{header:"Search result",children:["Search result: ",this.state.info]},"fd_oui_la"):(0,r.jsx)(a.Spinner,{})}}}}]);
//# sourceMappingURL=328.6ff0af58.chunk.js.map