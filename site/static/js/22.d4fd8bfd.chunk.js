(this.webpackJsonprims=this.webpackJsonprims||[]).push([[22],{51:function(e,t,n){"use strict";n.r(t),n.d(t,"List",(function(){return f}));var a=n(18),r=n(14),i=n(4),o=n(5),c=n(6),s=n(7),u=n(0),l=n.n(u),d=n(12),p=n(13),m=n(16),h=n(15),v=n(20),f=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).listItem=function(e){return[e.node,e.service,e.type,l.a.createElement(l.a.Fragment,null,l.a.createElement(v.InfoButton,{key:"info",onClick:function(){return a.changeContent(l.a.createElement(y,{key:"server_info",id:e.id}))},title:"Service information"}),l.a.createElement(v.DeleteButton,{key:"del",onClick:function(){return a.deleteList(e.id)},title:"Delete service"}),e.hasOwnProperty("ui")&&e.ui.length>0&&l.a.createElement(v.UiButton,{key:"ui",onClick:function(){return window.open(e.ui,"_blank")},title:"Server UI"}))]},a.deleteList=function(e){return window.confirm("Really delete service?")&&Object(d.d)("api/master/server_delete",{id:e}).then((function(t){t.deleted&&(a.setState({data:a.state.data.filter((function(t){return t.id!==e}))}),a.changeContent(null))}))},a.state={},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/master/server_list",{type:this.props.type}).then((function(t){return e.setState(t)}))}},{key:"componentDidUpdate",value:function(e){var t=this;e!==this.props&&Object(d.d)("api/master/server_list",{type:this.props.type}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.ContentList,{key:"cl",header:"Servers",thead:["Node","Service","Type",""],trows:this.state.data,listItem:this.listItem},l.a.createElement(v.ReloadButton,{key:"reload",onClick:function(){return e.componentDidMount()}}),l.a.createElement(v.AddButton,{key:"add",onClick:function(){return e.changeContent(l.a.createElement(y,{key:"server_info",id:"new",type:e.props.type}))},title:"Add service"})),l.a.createElement(p.ContentData,{key:"cda",mountUpdate:function(t){return e.changeContent=t}}))}}]),n}(u.Component),y=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).changeContent=function(e){return o.setState({content:e})},o.onChange=function(e){return o.setState({data:Object(r.a)({},o.state.data,Object(a.a)({},e.target.name,e.target.value))})},o.updateInfo=function(){return Object(d.d)("api/master/server_info",Object(r.a)({op:"update"},o.state.data)).then((function(e){return o.setState(e)}))},o.state={data:null,found:!0},o}return Object(o.a)(n,[{key:"componentDidUpdate",value:function(e){e!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/master/server_info",{id:this.props.id}).then((function(t){t.data.node||(t.data.node=t.nodes[0]),t.data.type_id||(t.data.type_id=t.services[0].id),e.setState(Object(r.a)({},t,{content:null}))}))}},{key:"render",value:function(){var e=this;if(this.state.found){if(this.state.data){var t=this.state.data.id,n="new"!==t;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.InfoArticle,{key:"ia",header:"Server"},l.a.createElement(p.InfoColumns,{key:"ic"},l.a.createElement(h.TextLine,{key:"server",id:"server",label:"ID",text:t}),l.a.createElement(h.SelectInput,{key:"node",id:"node",value:this.state.data.node,onChange:this.onChange},this.state.nodes.map((function(e){return l.a.createElement("option",{key:e,value:e},e)}))),l.a.createElement(h.SelectInput,{key:"type_id",id:"type_id",label:"Service",value:this.state.data.type_id,onChange:this.onChange},this.state.services.map((function(e){return l.a.createElement("option",{key:e.id,value:e.id},"".concat(e.service," (").concat(e.type,")"))}))),l.a.createElement(h.UrlInput,{key:"ui",id:"ui",label:"UI",value:this.state.data.ui,onChange:this.onChange})),l.a.createElement(v.SaveButton,{key:"save",onClick:function(){return e.updateInfo()},title:"Save"}),n&&l.a.createElement(v.SyncButton,{key:"sync",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_sync",id:t,operation:"sync"}))},title:"Sync service"}),n&&l.a.createElement(v.ReloadButton,{key:"restart",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_rst",id:t,operation:"restart"}))},title:"Restart service"}),n&&l.a.createElement(v.CheckButton,{key:"params",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_params",id:t,operation:"parameters"}))},title:"Service parameters"}),n&&l.a.createElement(v.SearchButton,{key:"status",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_stat",id:t,operation:"status"}))},title:"Service status"}),n&&l.a.createElement(v.StartButton,{key:"start",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_start",id:t,operation:"start"}))},title:"Start service"}),n&&l.a.createElement(v.StopButton,{key:"stop",onClick:function(){return e.changeContent(l.a.createElement(k,{key:"srv_op_stop",id:t,operation:"stop"}))},title:"Stop service"})),l.a.createElement(m.NavBar,{key:"server_navigation",id:"server_navigation"}),this.state.content)}return l.a.createElement(p.Spinner,null)}return l.a.createElement(p.InfoArticle,{key:"si_art_nf"},"Server with id: ",this.props.id," removed")}}]),n}(u.Component),k=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={wait:!0},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.d)("api/master/server_operation",{op:this.props.operation,id:this.props.id}).then((function(t){return e.setState({result:t,wait:!1})}))}},{key:"componentDidUpdate",value:function(e){e!==this.props&&(this.setState({wait:!0}),this.componentDidMount())}},{key:"render",value:function(){return this.state.wait?l.a.createElement(p.Spinner,null):l.a.createElement(p.CodeArticle,{key:"srv_operation"},JSON.stringify(this.state.result,null,2))}}]),n}(u.Component)}}]);
//# sourceMappingURL=22.d4fd8bfd.chunk.js.map