"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[128],{128:(t,e,n)=>{n.r(e),n.d(e,{Info:()=>p,Main:()=>d,Report:()=>C});var s=n(43),i=n(524),a=n(662),o=n(97),r=n(728),h=n(307),c=n(579);class d extends s.Component{constructor(){super(...arguments),this.compileNavItems=()=>this.context.loadNavigation((0,c.jsxs)(h.NavBar,{children:[(0,c.jsxs)(h.NavDropDown,{title:"Inventory",children:[(0,c.jsx)(h.NavDropButton,{title:"Search",onClick:()=>this.changeContent((0,c.jsx)(u,{changeSelf:this.changeContent},"search_list"))},"inv_nav_srch"),(0,c.jsx)(h.NavDropButton,{title:"Vendor",onClick:()=>this.changeContent((0,c.jsx)(v,{changeSelf:this.changeContent},"vendor_list"))},"inv_nav_vend"),(0,c.jsx)(h.NavDropButton,{title:"List",onClick:()=>this.changeContent((0,c.jsx)(l,{changeSelf:this.changeContent},"list"))},"inv_nav_list")]},"inv_nav_inv"),(0,c.jsx)(h.NavButton,{title:"Locations",onClick:()=>this.changeLocation()},"inv_nav_loc")]},"inventory_navbar")),this.changeLocation=()=>n.e(823).then(n.bind(n,823)).then((t=>this.setState((0,c.jsx)(t.List,{},"location_list")))),this.changeContent=t=>this.setState(t)}componentDidMount(){this.compileNavItems()}componentDidUpdate(t){t!==this.props&&this.compileNavItems()}render(){return(0,c.jsx)(c.Fragment,{children:this.state})}}d.contextType=a.RimsContext;class l extends s.Component{constructor(t){super(t),this.listItem=t=>[t.id,t.serial,t.model,(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.InfoButton,{onClick:()=>this.changeContent((0,c.jsx)(p,{id:t.id},"inventory_"+t.id)),title:"View inventory item"},"info"),(0,c.jsx)(r.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete inventory item"},"del")]})],this.deleteList=t=>window.confirm("Really delete item")&&(0,i.Cc)("api/inventory/delete",{id:t}).then((e=>{e.deleted&&(this.setState({data:this.state.data.filter((e=>e.id!==t))}),this.changeContent(null))})),this.state={searchfield:""}}componentDidMount(){(0,i.Cc)("api/inventory/list",this.props.args).then((t=>this.setState(t)))}render(){if(this.state.data){const t=0===this.state.searchfield.length?this.state.data:this.state.data.filter((t=>t.model.includes(this.state.searchfield)||t.serial.includes(this.state.searchfield)));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.ContentList,{header:"Inventory",thead:["ID","Serial","Model",""],trows:t,listItem:this.listItem,result:this.state.result,children:[(0,c.jsx)(r.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,c.jsx)(r.AddButton,{onClick:()=>this.changeContent((0,c.jsx)(p,{id:"new"},"inventory_new_"+(0,i.Le)())),title:"Add inventory item"},"add"),(0,c.jsx)(o.SearchField,{searchFire:t=>this.setState({searchfield:t}),placeholder:"Search inventory (case sensitive)"},"search")]},"cl"),(0,c.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]})}return(0,c.jsx)(a.Spinner,{})}}class u extends s.Component{constructor(t){super(t),this.changeContent=t=>this.props.changeSelf(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target["checkbox"!==t.target.type?"value":"checked"]}}),this.state={data:{field:"serial",search:""}}}render(){return(0,c.jsxs)(a.LineArticle,{header:"Inventory search",children:[(0,c.jsxs)(o.SelectInput,{id:"field",value:this.state.data.field,onChange:this.onChange,children:[(0,c.jsx)("option",{value:"serial",children:"Serial"}),(0,c.jsx)("option",{value:"vendor",children:"Vendor"})]},"field"),(0,c.jsx)(o.TextInput,{id:"search",value:this.state.data.search,placeholder:"search",onChange:this.onChange},"search"),(0,c.jsx)(r.SearchButton,{onClick:()=>this.changeContent((0,c.jsx)(l,{args:this.state.data},"inventory_list")),title:"Search inventory"},"inv_btn_search")]},"inv_srch_art")}}class p extends s.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target["checkbox"!==t.target.type?"value":"checked"]}}),this.changeContent=t=>this.setState({content:t}),this.updateInfo=()=>(0,i.Cc)("api/inventory/info",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={data:null,found:!0}}componentDidMount(){(0,i.Cc)("api/inventory/info",{id:this.props.id}).then((t=>this.setState(t)))}render(){if(this.state.data){const t=this.state.data;return(0,c.jsxs)(a.InfoArticle,{header:"Inventory Item",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(o.TextInput,{id:"vendor",value:t.vendor,onChange:this.onChange},"vendor"),(0,c.jsx)(o.TextInput,{id:"serial",label:"S/N",value:t.serial,onChange:this.onChange},"serial"),(0,c.jsx)(o.TextInput,{id:"product",value:t.product,onChange:this.onChange},"product"),(0,c.jsx)(o.TextInput,{id:"model",value:t.model,onChange:this.onChange},"model"),(0,c.jsx)(o.TextInput,{id:"description",value:t.description,onChange:this.onChange},"description"),(0,c.jsx)(o.SelectInput,{id:"location_id",label:"Location",value:t.location_id,onChange:this.onChange,children:this.state.locations.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},"ii_"+e)))},"location_id"),(0,c.jsx)(o.DateInput,{id:"receive_date",label:"Received",value:t.receive_date,onChange:this.onChange},"receive_date"),(0,c.jsx)(o.TextInput,{id:"purchase_order",label:"Purchase Order",value:t.purchase_order,onChange:this.onChange},"purchase_order"),(0,c.jsx)(o.CheckboxInput,{id:"license",value:t.license,onChange:this.onChange},"license"),t.license&&(0,c.jsx)(o.TextInput,{id:"license_key",label:"Key",value:t.license_key,onChange:this.onChange},"license_key"),(0,c.jsx)(o.CheckboxInput,{id:"support_contract",value:t.support_contract,onChange:this.onChange},"support_contract"),t.support_contract&&(0,c.jsx)(o.DateInput,{id:"support_end_date",label:"Contract End",value:t.support_end_date,onChange:this.onChange},"support_end_date"),(0,c.jsx)(o.TextInput,{id:"comments",value:t.comments,onChange:this.onChange},"comments")]},"inv_content"),(0,c.jsx)(r.ReloadButton,{onClick:()=>this.componentDidMount()},"inv_btn_reload"),t.serial&&(0,c.jsx)(r.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"inv_btn_save")]},"inv_article")}return(0,c.jsx)(a.Spinner,{})}}class v extends s.Component{constructor(t){super(t),this.listItem=t=>[(0,c.jsx)(r.HrefButton,{text:t.vendor,onClick:()=>this.changeContent((0,c.jsx)(l,{args:{field:"vendor",search:t.vendor}},"inventory_list"))},"search_"+t.vendor),t.count],this.state={}}componentDidMount(){(0,i.Cc)("api/inventory/vendor_list").then((t=>this.setState(t)))}render(){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.ContentList,{header:"Vendors",thead:["Name","Count"],trows:this.state.data,listItem:this.listItem},"cl"),(0,c.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]})}}class C extends s.Component{constructor(t){super(t),this.listItem=t=>[t.id,t.serial,t.vendor,t.model,t.product,t.description],this.state={}}componentDidMount(){(0,i.Cc)("api/inventory/list",{extra:["vendor","product","description"],sort:"vendor"}).then((t=>this.setState(t)))}render(){return(0,c.jsx)(a.ContentReport,{header:"Inventory",thead:["ID","Serial","Vendor","Model","Product","Description"],trows:this.state.data,listItem:this.listItem},"inv_cr")}}}}]);
//# sourceMappingURL=128.4fd6a065.chunk.js.map