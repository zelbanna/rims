"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[723],{723:(t,e,s)=>{s.r(e),s.d(e,{Info:()=>r,List:()=>l,User:()=>u});var a=s(43),i=s(524),n=s(662),h=s(728),d=s(97),o=s(579);class l extends a.Component{constructor(t){super(t),this.listItem=t=>[t.id,t.alias,t.name,(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h.ConfigureButton,{onClick:()=>this.changeContent((0,o.jsx)(r,{id:t.id},"user_info")),title:"Edit user"},"config"),(0,o.jsx)(h.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete user"},"del")]})],this.deleteList=t=>window.confirm("Really delete user?")&&(0,i.Cc)("api/master/user_delete",{id:t}).then(e=>{e.deleted&&(this.setState({data:this.state.data.filter(e=>e.id!==t)}),this.changeContent(null))}),this.state={}}componentDidMount(){(0,i.Cc)("api/master/user_list").then(t=>this.setState(t))}render(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.ContentList,{header:"Users",thead:["ID","Alias","Name",""],trows:this.state.data,listItem:this.listItem,children:[(0,o.jsx)(h.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,o.jsx)(h.AddButton,{onClick:()=>this.changeContent((0,o.jsx)(r,{id:"new"},"user_info")),title:"Add user"},"add")]},"cl"),(0,o.jsx)(n.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]})}}class r extends a.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.updateInfo=()=>{this.setState({update:!1,password_check:""}),this.context.settings.id===this.state.data.id&&this.context.changeTheme(this.state.data.theme),(0,i.Cc)("api/master/user_info",{op:"update",...this.state.data},{"X-Log":"false"}).then(t=>this.setState(t))},this.state={data:null,found:!0}}componentDidUpdate(t){t!==this.props&&(0,i.Cc)("api/master/user_info",{id:this.props.id}).then(t=>this.setState(t))}componentDidMount(){(0,i.Cc)("api/portal/theme_list").then(t=>this.setState({themes:t.data})),(0,i.Cc)("api/master/user_info",{id:this.props.id}).then(t=>this.setState(t))}render(){if(this.state.found){if(this.state.data&&this.state.themes){let t=this.state.update?"OK - updated":"";return(0,o.jsxs)(n.InfoArticle,{header:"User",children:[(0,o.jsxs)(n.InfoColumns,{children:[this.context.settings.id===this.props.id?(0,o.jsx)(d.TextLine,{id:"alias",text:this.state.data.alias},"alias"):(0,o.jsx)(d.TextInput,{id:"alias",value:this.state.data.alias,onChange:this.onChange},"alias"),(0,o.jsx)(d.PasswordInput,{id:"password",placeholder:"******",onChange:this.onChange},"password"),"admin"===this.context.settings.class&&(0,o.jsx)(d.SelectInput,{id:"class",value:this.state.data.class,onChange:this.onChange,children:this.state.classes.map(t=>(0,o.jsx)("option",{value:t,children:t},t))},"class"),(0,o.jsx)(d.TextInput,{id:"email",label:"E-Mail",value:this.state.data.email,onChange:this.onChange},"email"),(0,o.jsx)(d.TextInput,{id:"name",label:"Full name",value:this.state.data.name,onChange:this.onChange},"name"),(0,o.jsx)(d.SelectInput,{id:"theme",value:this.state.data.theme,onChange:this.onChange,children:this.state.themes.map(t=>(0,o.jsx)("option",{value:t,children:t},t))},"theme")]},"ui_content"),(0,o.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"ui_btn_save"),(0,o.jsx)(n.Result,{result:t},"ui_operation")]},"ui_art")}return(0,o.jsx)(n.Spinner,{})}return(0,o.jsxs)(n.InfoArticle,{children:["User with id: ",this.props.id," removed"]},"ui_art")}}r.contextType=n.RimsContext;class u extends a.Component{render(){return(0,o.jsx)(n.Flex,{style:{justifyContent:"space-evenly"},children:(0,o.jsx)(r,{id:this.props.id},"user_info")},"flex")}}}}]);
//# sourceMappingURL=723.58f9b59b.chunk.js.map