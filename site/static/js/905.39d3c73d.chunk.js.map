{"version":3,"file":"static/js/905.39d3c73d.chunk.js","mappings":"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","sources":["reservation.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { post_call } from './infra/Functions.js';\nimport { RimsContext, Spinner, InfoArticle, InfoColumns, LineArticle, ContentList, ContentData, ContentReport } from './infra/UI.jsx';\nimport { AddButton, DeleteButton, InfoButton, ReloadButton, SaveButton, SearchButton } from './infra/Buttons.jsx';\nimport { RadioInput, TextInput, TextLine }  from './infra/Inputs.jsx';\n\n// ************** List **************\n//\nexport class List extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/reservation/list').then(result => this.setState(result))\n }\n\n extendItem = (device_id,user_id,days) => {\n  post_call('api/reservation/extend',{device_id:device_id, user_id:user_id, days:days}).then(result => this.componentDidMount())\n }\n\n deleteItem = (dev,user) => (window.confirm('Remove reservation?') && post_call('api/reservation/delete',{device_id:dev, user_id:user}).then(result => {\n  if (result.deleted){\n   this.setState({data:this.state.data.filter(row => (row.device_id !== dev))});\n   this.changeContent(null);\n  }}))\n\n listItem = (row) => {\n  const buttons = (this.context.settings.id === row.user_id || !row.valid);\n  return [row.alias,row.hostname,row.end,<>\n   {buttons && <InfoButton key='info' onClick={() => { this.changeContent(<Info key={'rsv_device_'+row.device_id} device_id={row.device_id} user_id={row.user_id} />) }} title='Info'/>}\n   {buttons && <AddButton  key='ext' onClick={() => { this.extendItem(row.device_id,row.user_id,14) }} title='Extend reservation' />}\n   {buttons && <DeleteButton key='del' onClick={() => { this.deleteItem(row.device_id,row.user_id) }} title='Remove reservation' />}\n  </>]\n }\n\n render(){\n  return <>\n   <ContentList key='cl' header='Reservations' thead={['User','Device','Until','']} trows={this.state.data} listItem={this.listItem}>\n    <ReloadButton key='reload' onClick={() => this.componentDidMount() } />\n    <AddButton key='add' onClick={() => this.changeContent(<New key='rsv_new' />)} />\n   </ContentList>\n   <ContentData key='cda' mountUpdate={(fun) => this.changeContent = fun} />\n  </>\n }\n}\nList.contextType = RimsContext;\n\n// ************** Info **************\n//\nclass Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {data:null, found:true};\n }\n\n componentDidMount(){\n  post_call('api/reservation/info',{device_id:this.props.device_id}).then(result => this.setState(result))\n }\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target.value}});\n\n updateInfo = () =>  post_call('api/reservation/info',{op:'update', ...this.state.data}).then(result => this.setState(result))\n\n extendItem = (days) => {\n  post_call('api/reservation/extend',{device_id:this.state.data.device_id, user_id:this.state.data.user_id, days:days}).then(result => result.status === 'OK' && this.componentDidMount())\n }\n\n render() {\n  if (this.state.data){\n   return <InfoArticle key='rsv_article' header='Reservation'>\n     <InfoColumns key='reservation_content'>\n      <TextLine key='alias' id='alias' text={this.state.data.alias} />\n      <TextLine key='time_start' id='Start' text={this.state.data.time_start} />\n      <TextLine key='time_end' id='End' text={this.state.data.time_end} />\n      <RadioInput key='shutdown' id='shutdown' value={this.state.data.shutdown} options={[{text:'no',value:'no'},{text:'yes',value:'yes'},{text:'reset',value:'reset'}]} onChange={this.onChange} />\n      <TextInput key='info' id='info' value={this.state.data.info} onChange={this.onChange} />\n     </InfoColumns>\n     {this.state.data.user_id === this.context.settings.id && <SaveButton key='rsv_btn_save' onClick={() => this.updateInfo()} title='Save' />}\n     {this.state.data.user_id === this.context.settings.id && <AddButton key='rsv_btn_extend' onClick={() => this.extendItem(14)} title='Extend' />}\n    </InfoArticle>\n  } else\n   return <Spinner />\n }\n}\nInfo.contextType = RimsContext;\n\n// ************** Report **************\n//\nclass New extends Component {\n constructor(props){\n  super(props)\n  this.state = {device:'',device_id:undefined,matching:''}\n }\n\n onChange = (e) => {\n  this.setState({device:e.target.value});\n }\n\n findDevice = () => post_call('api/device/search',{hostname:this.state.device}).then(result => result.found && this.setState({device_id:result.data.id,matching:result.data.hostname}));\n\n reserveDevice = () => post_call('api/reservation/new',{device_id:this.state.device_id,user_id:this.context.settings.id}).then(result => result.status === 'OK' && this.setState({device:'',device_id:undefined,matching:''}));\n\n render(){\n  return <LineArticle key='rsv_art' header='New reservation'>\n   <TextInput key='device' id='device' label='Search device' onChange={this.onChange} value={this.state.device} placeholder='search' /> found <TextLine key='matching' id='matching device' text={this.state.matching} />\n   {this.state.device && <SearchButton key='rsv_btn_search' onClick={() => this.findDevice()} title='Find device' />}\n   {this.state.device_id && <AddButton key='rsv_btn_new' onClick={() => this.reserveDevice()} title='Reserve device' />}\n   </LineArticle>\n }\n}\nNew.contextType = RimsContext;\n\n// ************** Report **************\n//\nexport class Report extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/reservation/list',{extended:true}).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.alias,row.hostname,row.start,row.end,row.info]\n\n render(){\n  return <ContentReport key='rsv_cr' header='Reservations' thead={['User','Device','Start','End','Info']} trows={this.state.data} listItem={this.listItem} />\n }\n}\n"],"names":["List","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","extendItem","device_id","user_id","days","post_call","then","result","componentDidMount","deleteItem","dev","user","window","confirm","deleted","setState","data","state","filter","row","changeContent","listItem","buttons","context","settings","id","valid","alias","hostname","end","_jsxs","_Fragment","children","_jsx","InfoButton","onClick","Info","title","AddButton","DeleteButton","_createClass","key","value","_this2","_this3","ContentList","header","thead","trows","this","ReloadButton","New","ContentData","mountUpdate","fun","Component","contextType","RimsContext","_Component2","_super2","_this4","onChange","e","_objectSpread","_defineProperty","target","name","updateInfo","op","status","found","_this5","_this6","InfoArticle","InfoColumns","TextLine","text","time_start","time_end","RadioInput","shutdown","options","TextInput","info","SaveButton","Spinner","_Component3","_super3","_this7","device","findDevice","matching","reserveDevice","undefined","_this8","LineArticle","label","placeholder","SearchButton","Report","_Component4","_super4","_this9","start","_this10","extended","ContentReport"],"sourceRoot":""}