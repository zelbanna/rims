(this.webpackJsonprims=this.webpackJsonprims||[]).push([[10,2,24],{39:function(e,t,n){"use strict";n.r(t),n.d(t,"Main",(function(){return k})),n.d(t,"List",(function(){return y})),n.d(t,"Show",(function(){return g})),n.d(t,"Edit",(function(){return b}));var a=n(18),i=n(14),r=n(4),o=n(5),c=n(6),s=n(7),l=n(0),u=n.n(l),d=n(12),h=n(13),f=n(19),p=n(15),v=n(1),m=n.n(v),k=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).changeContent=function(e){return a.setState(e)},a.state=u.a.createElement(y,{key:"viz_list"}),a}return Object(o.a)(n,[{key:"render",value:function(){return u.a.createElement(l.Fragment,{key:"main_base"},this.state)}}]),n}(l.Component),y=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).listItem=function(e){return[e.id,e.name,u.a.createElement(l.Fragment,{key:"vl_buttons"},u.a.createElement(f.EditButton,{key:"vl_btn_edt_"+e.id,onClick:function(){return a.changeContent(u.a.createElement(b,{key:"viz_edit_"+e.id,id:e.id,changeSelf:a.changeContent,type:"map"}))},title:"Show and edit map"}),u.a.createElement(f.NetworkButton,{key:"vl_btn_net_"+e.id,onClick:function(){return window.open("viz.html?id=".concat(e.id),"_blank")},title:"Show resulting map"}),u.a.createElement(f.DeleteButton,{key:"vl_btn_del_"+e.id,onClick:function(){return a.deleteList(e.id)}}))]},a.changeContent=function(e){return a.setState({content:e})},a.deleteList=function(e){return window.confirm("Delete map?")&&Object(d.c)("api/visualize/delete",{id:e}).then((function(t){return t.deleted&&a.setState({data:a.state.data.filter((function(t){return t.id!==e})),content:null})}))},a.state={},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(d.c)("api/visualize/list").then((function(t){e.setState(t)}))}},{key:"render",value:function(){var e=this;return u.a.createElement(l.Fragment,{key:"vl_fragment"},u.a.createElement(h.ContentList,{key:"vl_cl",header:"Maps",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(f.ReloadButton,{key:"vl_btn_reload",onClick:function(){return e.componentDidMount()}})),u.a.createElement(h.ContentData,{key:"vl_cd"},this.state.content))}}]),n}(l.Component),g=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).doubleClick=function(e){console.log("DoubleClick",e.nodes),e.nodes[0]&&Object(d.c)("api/device/management",{id:e.nodes[0]}).then((function(e){e&&"OK"===e.status?e.data.url&&e.data.url.length>0?window.open(e.data.url):window.open("ssh://"+e.data.username+"@"+e.data.ip,"_self"):console.log("Data not ok:"+e)}))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.hasOwnProperty("id")?{id:this.props.id}:{name:this.props.name};n.e(5).then(n.bind(null,58)).then((function(n){Object(d.c)("api/visualize/show",t).then((function(t){var a=new n.DataSet(t.data.nodes),i=new n.DataSet(t.data.edges),r=new n.Network(e.refs.show_canvas,{nodes:a,edges:i},t.data.options);r.on("stabilizationIterationsDone",(function(){return r.setOptions({physics:!1})})),r.on("doubleClick",(function(t){return e.doubleClick(t)}))}))}))}},{key:"render",value:function(){return u.a.createElement(h.Article,{key:"viz_show"},u.a.createElement("div",{className:m.a.network,id:"div_network",ref:"show_canvas"}))}}]),a}(l.Component),b=function(e){Object(s.a)(l,e);var t=Object(c.a)(l);function l(e){var o;return Object(r.a)(this,l),(o=t.call(this,e)).changeImport=function(e){return n.e(0).then(n.bind(null,38)).then((function(t){return o.props.changeSelf(u.a.createElement(t.Info,{key:"di_"+e,id:e}))}))},o.onChange=function(e){return o.setState({data:Object(i.a)({},o.state.data,Object(a.a)({},e.target.name,e.target.value))})},o.jsonHandler=function(e){var t=Object(i.a)({},o.state.data);try{t[e.target.name]=JSON.parse(e.target.value),o.setState({data:t})}catch(n){console.log("Error converting string to JSON")}},o.updateInfo=function(){return Object(d.c)("api/visualize/network",Object(i.a)({op:"update"},o.state.data)).then((function(e){return o.setState(e)}))},o.doubleClick=function(e){console.log("DoubleClick",e.nodes[0]),o.props.changeSelf&&o.changeImport(e.nodes[0])},o.toggleEdit=function(){o.edit=!o.edit,o.viz.network.setOptions({manipulation:{enabled:o.edit}}),o.setState({result:"Edit:"+o.edit})},o.toggleFix=function(){o.viz.nodes.forEach((function(e,t){return o.viz.nodes.update({id:t,fixed:!e.fixed})})),o.setState({data:Object(i.a)({},o.state.data,{nodes:o.viz.nodes.get()}),result:"Fix/Unfix positions"})},o.togglePhysics=function(){var e=o.state.data;e.options.physics.enabled=!e.options.physics.enabled,o.viz.network.setOptions({physics:e.options.physics.enabled}),o.setState({data:e,physics_button:e.options.physics.enabled?f.StopButton:f.StartButton,result:"Physics:"+e.options.physics.enabled})},o.networkSync=function(e){o.viz.network.storePositions(),o.setState({data:Object(i.a)({},o.state.data,{nodes:o.viz.nodes.get(),edges:o.viz.edges.get()}),result:"Moved "+o.viz.nodes.get(e.nodes[0]).label})},o.showDiv=function(e){return e===o.state.content?{display:"block"}:{display:"none"}},o.state={content:"network",physics_button:f.StartButton,found:!0,data:{name:"N/A"},result:""},o.viz={network:null,nodes:null,edges:null},o.results=u.a.createRef(),o.edit=!1,o}return Object(o.a)(l,[{key:"componentDidMount",value:function(){var e=this;n.e(5).then(n.bind(null,58)).then((function(t){Object(d.c)("api/visualize/network",{id:e.props.id,type:e.props.type}).then((function(n){e.viz.nodes=new t.DataSet(n.data.nodes),e.viz.edges=new t.DataSet(n.data.edges),n.data.options.physics.enabled=!0,e.viz.network=new t.Network(e.refs.edit_canvas,{nodes:e.viz.nodes,edges:e.viz.edges},n.data.options),e.viz.network.on("stabilizationIterationsDone",(function(){return e.viz.network.setOptions({physics:!1})})),e.viz.network.on("doubleClick",(function(t){return e.doubleClick(t)})),e.viz.network.on("dragEnd",(function(t){return e.networkSync(t)})),n.data.options.physics.enabled=!1,e.setState(n)}))}))}},{key:"render",value:function(){var e=this,t=this.state.physics_button;return u.a.createElement(h.Article,{key:"viz_art",header:"Network Map"},"device"===this.props.type&&this.props.changeSelf&&u.a.createElement(f.BackButton,{key:"viz_back",onClick:function(){return e.changeImport(e.props.id)}}),u.a.createElement(f.ReloadButton,{key:"viz_reload",onClick:function(){return e.componentDidMount()}}),u.a.createElement(f.EditButton,{key:"viz_edit",onClick:function(){return e.toggleEdit()}}),u.a.createElement(t,{key:"viz_physics",onClick:function(){return e.togglePhysics()}}),u.a.createElement(f.FixButton,{key:"viz_fix",onClick:function(){return e.toggleFix()}}),u.a.createElement(f.SaveButton,{key:"viz_save",onClick:function(){return e.updateInfo()}}),u.a.createElement(f.NetworkButton,{key:"viz_net",onClick:function(){return e.setState({content:"network"})}}),u.a.createElement(f.TextButton,{key:"viz_opt",text:"Options",onClick:function(){return e.setState({content:"options"})}}),u.a.createElement(f.TextButton,{key:"viz_nodes",text:"Nodes",onClick:function(){return e.setState({content:"nodes"})}}),u.a.createElement(f.TextButton,{key:"viz_edges",text:"Edges",onClick:function(){return e.setState({content:"edges"})}}),u.a.createElement(p.TextInput,{key:"viz_name",id:"name",value:this.state.data.name,onChange:this.onChange}),u.a.createElement(h.Result,{key:"viz_result",result:this.state.result}),u.a.createElement("div",{className:m.a.network,style:this.showDiv("network"),ref:"edit_canvas"}),u.a.createElement("div",{className:m.a.network,style:this.showDiv("options")},u.a.createElement("textarea",{id:"options",name:"options",value:JSON.stringify(this.state.data.options,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:m.a.network,style:this.showDiv("nodes")},u.a.createElement("textarea",{id:"nodes",name:"nodes",value:JSON.stringify(this.state.data.nodes,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:m.a.network,style:this.showDiv("edges")},u.a.createElement("textarea",{id:"edges",name:"edges",value:JSON.stringify(this.state.data.edges,void 0,2),onChange:this.jsonHandler})))}}]),l}(l.Component)},42:function(e,t,n){"use strict";n.r(t),n.d(t,"Search",(function(){return v})),n.d(t,"Device",(function(){return m})),n.d(t,"List",(function(){return k}));var a=n(18),i=n(4),r=n(5),o=n(6),c=n(7),s=n(0),l=n.n(s),u=n(12),d=n(13),h=n(15),f=n(19),p=n(39),v=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).changeContent=function(e){return r.props.changeSelf(e)},r.onChange=function(e){return r.setState(Object(a.a)({},e.target.name,e.target.value))},r.state={field:"mac",search:""},r}return Object(r.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement(d.LineArticle,{key:"fs_art",header:"FDB Search"},l.a.createElement(h.SelectInput,{key:"field",id:"field",onChange:this.onChange,value:this.state.field},l.a.createElement("option",{value:"mac"},"MAC"),l.a.createElement("option",{value:"device_id"},"Device ID")),l.a.createElement(h.TextInput,{key:"search",id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"}),l.a.createElement(f.SearchButton,{key:"fs_btn_search",onClick:function(){return e.changeContent(l.a.createElement(k,Object.assign({key:"fdb_list"},e.state,{changeSelf:e.props.changeSelf})))},title:"Search FDB"}))}}]),n}(s.Component),m=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).changeContent=function(e){return r.props.changeSelf(e)},r.changeInterface=function(e){return n.e(1).then(n.bind(null,40)).then((function(t){return r.changeContent(l.a.createElement(t.Info,{key:"interface_info",device_id:r.props.id,interface_id:e,changeSelf:r.changeContent}))}))},r.listItem=function(e,t){return[e.vlan,e.snmp_index,l.a.createElement(f.HrefButton,{key:"fd_intf_"+e.interface_id,text:e.name,onClick:function(){return r.changeInterface(e.interface_id)}}),e.mac]},r.state={wait:null},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(u.c)("api/fdb/list",{field:"device_id",search:this.props.id}).then((function(t){return e.setState(t)}))}},{key:"syncFDB",value:function(){var e=this;this.setState({wait:l.a.createElement(d.Spinner,null)}),Object(u.c)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then((function(t){return e.setState({wait:null})}))}},{key:"render",value:function(){var e=this;return this.state.data?l.a.createElement(d.ContentReport,{key:"fd_cr",header:"FDB",thead:["VLAN","SNMP","Interface","MAC"],trows:this.state.data,listItem:this.listItem},l.a.createElement(f.ReloadButton,{key:"fd_btn_reload",onClick:function(){return e.componentDidMount()}}),l.a.createElement(f.SyncButton,{key:"fd_btn_sync",onClick:function(){return e.syncFDB()},title:"Resync FDB"}),this.state.wait):l.a.createElement(d.Spinner,null)}}]),a}(s.Component),k=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).changeSearch=function(e,t){return a.setState({content:l.a.createElement(y,{key:"fi_"+t,mac:e})})},a.changeVisualize=function(e){return"changeSelf"in a.props&&a.setState({content:l.a.createElement(p.Edit,{key:"viz_id_"+e,type:"device",id:e})})},a.searchHandler=function(e){return a.setState({searchfield:e.target.value})},a.listItem=function(e,t){return[e.device_id,e.hostname,e.vlan,e.snmp_index,e.name,l.a.createElement(f.HrefButton,{key:"fd_intf_"+t,text:e.mac,onClick:function(){return a.changeSearch(e.mac,t)}}),l.a.createElement(f.NetworkButton,{key:"fd_map_"+t,onClick:function(){return a.changeVisualize(e.device_id)}})]},a.state={searchfield:"",content:null},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(u.c)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;if(this.state.data){var t=this.state.searchfield.toUpperCase(),n=0===t.length?this.state.data:this.state.data.filter((function(e){return e.mac.includes(t)}));return l.a.createElement(s.Fragment,{key:"fl_frag"},l.a.createElement(d.ContentList,{key:"fl_cr",header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:n,listItem:this.listItem},l.a.createElement(f.ReloadButton,{key:"fl_btn_reload",onClick:function(){return e.componentDidMount()}}),l.a.createElement(h.SearchInput,{key:"fl_search",searchHandler:this.searchHandler,value:this.state.searchfield,placeholder:"Search MAC"})),l.a.createElement(d.ContentData,{key:"fl_content"},this.state.content))}return l.a.createElement(d.Spinner,null)}}]),n}(s.Component),y=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(u.c)("api/fdb/search",{mac:this.props.mac}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){return this.state.device?l.a.createElement(d.ContentReport,{key:"fd_cr",header:"".concat(this.state.device.hostname," (").concat(this.state.device.id,")"),thead:["ID","Name","Description"],trows:this.state.interfaces,listItem:function(e){return[e.interface_id,e.name,e.description]}}):this.state.status?l.a.createElement(d.LineArticle,{key:"fd_la",header:"Search error"},"Search result: ",this.state.info):l.a.createElement(d.Spinner,null)}}]),n}(s.Component)}}]);
//# sourceMappingURL=10.bef6c6d6.chunk.js.map