(this.webpackJsonprims=this.webpackJsonprims||[]).push([[3],{41:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return v})),n.d(e,"NetworkList",(function(){return _})),n.d(e,"AddressInfo",(function(){return C})),n.d(e,"AddressEvents",(function(){return S}));var a=n(19),i=n(10),r=n(5),s=n(6),o=n(8),c=n(7),d=n(3),u=n.n(d),l=n(14),h=n(15),j=n(16),p=n(21),b=n(1),f=n.n(b),O=n(0),v=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).changeContent=function(t){return a.setState(t)},a.state=Object(O.jsx)(_,{},"network_list"),a}return Object(s.a)(n,[{key:"render",value:function(){return Object(O.jsx)(O.Fragment,{children:this.state})}}]),n}(d.Component),_=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.id,t.netasc,t.description,t.service,Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(p.ConfigureButton,{onClick:function(){return a.changeContent(Object(O.jsx)(m,{id:t.id},"network_"+t.id))},title:"Edit network properties"},"conf"),Object(O.jsx)(p.ItemsButton,{onClick:function(){return a.changeContent(Object(O.jsx)(g,{network_id:t.id,changeSelf:a.changeContent},"address_list_"+t.id))},title:"View addresses"},"items"),"v4"===t.class&&Object(O.jsx)(p.ViewButton,{onClick:function(){return a.changeContent(Object(O.jsx)(x,{network_id:t.id,changeSelf:a.changeContent},"address_layout_"+t.id))},title:"View usage map"},"layout"),"v4"===t.class&&Object(O.jsx)(p.CheckButton,{onClick:function(){return a.changeContent(Object(O.jsx)(I,{network_id:t.id,changeSelf:a.changeContent},"resv_list_"+t.id))},title:"Reserved addresses for network"},"resv"),Object(O.jsx)(p.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete network"},"del"),Object(O.jsx)(p.ReloadButton,{onClick:function(){return a.resetStatus(t.id)},title:"Reset state for network addresses"},"reset")]})]},a.deleteList=function(t){return window.confirm("Really delete network")&&Object(l.d)("api/ipam/network_delete",{id:t}).then((function(e){e.deleted&&(a.setState({data:a.state.data.filter((function(e){return e.id!==t}))}),a.changeContent(null))}))},a.resetStatus=function(t){return Object(l.d)("api/ipam/clear",{network_id:t}).then((function(t){return a.setState({result:t.count})}))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/network_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(h.ContentList,{header:"Networks",thead:["ID","Network","Description","DHCP",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[Object(O.jsx)(p.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(O.jsx)(p.AddButton,{onClick:function(){return t.changeContent(Object(O.jsx)(m,{id:"new"},"network_new_"+Object(l.e)()))},title:"Add network"},"add"),Object(O.jsx)(p.LogButton,{onClick:function(){return t.changeContent(Object(O.jsx)(k,{},"network_leases"))},title:"View IPAM/DHCP leases"},"leases")]},"cl"),Object(O.jsx)(h.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(d.Component),m=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var s;return Object(r.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.changeContent=function(t){return s.setState({content:t})},s.updateInfo=function(){return Object(l.d)("api/ipam/network_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null,found:!0},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/network_info",{id:this.props.id,extra:["servers","domains"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(O.jsxs)(h.InfoArticle,{header:"Network",children:[Object(O.jsxs)(h.InfoColumns,{children:[Object(O.jsx)(j.TextLine,{id:"id",label:"ID",text:this.state.data.id},"id"),Object(O.jsx)(j.TextInput,{id:"description",value:this.state.data.description,onChange:this.onChange},"description"),Object(O.jsx)(j.TextInput,{id:"network",value:this.state.data.network,onChange:this.onChange},"network"),Object(O.jsx)(j.TextInput,{id:"mask",value:this.state.data.mask,onChange:this.onChange},"mask"),Object(O.jsx)(j.TextInput,{id:"gateway",value:this.state.data.gateway,onChange:this.onChange},"gateway"),Object(O.jsx)(j.SelectInput,{id:"server_id",label:"Server",value:this.state.data.server_id,onChange:this.onChange,children:this.state.servers.map((function(t,e){return Object(O.jsx)("option",{value:t.id,children:"".concat(t.service,"@").concat(t.node)},e)}))},"server_id"),Object(O.jsx)(j.SelectInput,{id:"reverse_zone_id",label:"Reverse Zone",value:this.state.data.reverse_zone_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(O.jsx)("option",{value:t.id,children:"".concat(t.server," (").concat(t.name,")")},e)}))},"reverse_zone_id")]},"network_content"),Object(O.jsx)(p.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"network_btn_save")]},"net_article"):Object(O.jsx)(h.Spinner,{})}}]),n}(d.Component),x=function(t){Object(o.a)(a,t);var e=Object(c.a)(a);function a(){var t;Object(r.a)(this,a);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).changeContent=function(e){return t.props.changeSelf(e)},t.changeDevice=function(e){return n.e(0).then(n.bind(null,36)).then((function(n){return t.changeContent(Object(O.jsx)(n.Info,{id:e},"di_"+e))}))},t.createDevice=function(e,a){return n.e(0).then(n.bind(null,36)).then((function(n){return t.changeContent(Object(O.jsx)(n.New,{ipam_network_id:e,ip:a},"dn_new"))}))},t}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/address_list",{network_id:this.props.network_id,dict:"ip_integer",extra:["device_id","reservation","ip_integer"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;if(!this.state)return Object(O.jsx)(h.Spinner,{});var e=function(){for(var e=t.state.data,n=Object(l.c)(t.state.network),a=[],i=function(i){var r=n+i;r in e?e[r].device_id?a.push(Object(O.jsx)(p.IpamRedButton,{onClick:function(){return t.changeDevice(e[r].device_id)},text:i%256},"btn_"+r)):a.push(Object(O.jsx)(p.IpamGreyButton,{text:i%256},"btn_"+r)):a.push(Object(O.jsx)(p.IpamGreenButton,{onClick:function(){return t.createDevice(t.props.network_id,Object(l.b)(r))},text:i%256},"btn_"+r))},r=0;r<t.state.size;r++)i(r);return{v:Object(O.jsx)(h.Article,{header:t.state.network+"/"+t.state.mask,children:a},"il_art")}}();return"object"===typeof e?e.v:void 0}}]),a}(d.Component),k=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.ip,t.mac,t.hostname,t.oui,t.starts,t.ends]},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/server_leases",{type:"active"}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return Object(O.jsx)(h.ContentReport,{header:"Leases",thead:["IP","Mac","Hostname","OUI","Starts","End"],trows:this.state.data,listItem:this.listItem},"lease_cr")}}]),n}(d.Component),g=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).changeContent=function(t){return a.props.changeSelf(t)},a.listItem=function(t){return[t.id,t.ip,t.hostname,t.domain,Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(h.StateLeds,{state:t.state},"state"),Object(O.jsx)(p.ConfigureButton,{onClick:function(){return a.changeContent(Object(O.jsx)(C,{id:t.id,changeSelf:a.changeContent},"address_info_"+t.id))},title:"Edit address entry"},"info"),Object(O.jsx)(p.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete address entry"},"del")]})]},a.deleteList=function(t){return window.confirm("Delete address?")&&Object(l.d)("api/ipam/address_delete",{id:t}).then((function(e){return e.deleted&&a.setState({data:a.state.data.filter((function(e){return e.id!==t}))})}))},a.state={data:null,result:null},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/address_list",{network_id:this.props.network_id,extra:["hostname","a_domain_id","device_id"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(O.jsxs)(h.ContentReport,{header:"Allocated IP Addresses",thead:["ID","IP","Hostname","Domain",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[Object(O.jsx)(p.ReloadButton,{onClick:function(){return t.componentDidMount()}},"al_btn_reload"),Object(O.jsx)(p.AddButton,{onClick:function(){return t.changeContent(Object(O.jsx)(C,{network_id:t.props.network_id,id:"new"},"address_new_"+Object(l.e)()))},title:"Add address entry"},"al_btn_add")]},"al_cr")}}]),n}(d.Component),C=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var s;return Object(r.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.updateInfo=function(){s.setState({status:void 0}),Object(l.d)("api/ipam/address_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/address_info",{id:this.props.id,network_id:this.props.network_id}).then((function(e){return t.setState(e)})),Object(l.d)("api/dns/domain_list",{filter:"forward"}).then((function(e){return t.setState({domains:e.data})}))}},{key:"render",value:function(){var t=this;if(this.state&&this.state.data&&this.state.domains){var e="";return this.state.status&&(e="OK"===this.state.status?"OK":this.state.info),Object(O.jsxs)(h.InfoArticle,{header:"IP Address",children:[Object(O.jsxs)(h.InfoColumns,{children:[Object(O.jsx)(j.TextLine,{id:"id",label:"ID",text:this.state.data.id},"id"),Object(O.jsx)(j.TextLine,{id:"network",text:this.state.extra.network},"network"),Object(O.jsx)(j.TextInput,{id:"ip",label:"IP",value:this.state.data.ip,onChange:this.onChange},"ip"),Object(O.jsx)(j.TextInput,{id:"hostname",value:this.state.data.hostname,onChange:this.onChange,title:"Hostname when creating FQDN for DNS entry"},"hostname"),Object(O.jsx)(j.SelectInput,{id:"a_domain_id",label:"Domain",value:this.state.data.a_domain_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(O.jsx)("option",{value:t.id,children:t.name},e)}))},"a_domain_id")]},"ip_content"),Object(O.jsx)(p.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"ip_btn_save"),"changeSelf"in this.props&&Object(O.jsx)(p.HealthButton,{onClick:function(){return t.props.changeSelf(Object(O.jsx)(S,{id:t.state.data.id,changeSelf:t.props.changeSelf},"address_events"))},title:"IPAM events - graphical"},"ip_btn_events"),"changeSelf"in this.props&&Object(O.jsx)(p.LogButton,{onClick:function(){return t.props.changeSelf(Object(O.jsx)(w,{id:t.state.data.id},"address_logs"))},title:"IPAM events - logs"},"ip_btn_logs"),Object(O.jsx)(h.Result,{result:e},"ip_operation")]},"ip_article")}return Object(O.jsx)(h.Spinner,{})}}]),n}(d.Component),w=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).listItem=function(t,e){return[t.time,Object(O.jsx)(h.StateLeds,{state:t.state})]},a.clearList=function(){return Object(l.d)("api/ipam/address_events",{op:"clear",id:a.props.id}).then((function(t){return a.setState({events:[]})}))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/address_events",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(O.jsx)(h.ContentReport,{header:"State changes",thead:["Time",""],trows:this.state.events,listItem:this.listItem,children:Object(O.jsx)(p.DeleteButton,{onClick:function(){return t.clearList()},title:"clear logs"},"alo_btn_clear")},"alo_cr_"+this.props.id)}}]),n}(d.Component),S=function(t){Object(o.a)(a,t);var e=Object(c.a)(a);function a(t){var n;return Object(r.a)(this,a),(n=e.call(this,t)).clearList=function(){return Object(l.d)("api/ipam/address_events",{op:"clear",id:n.props.id}).then((function(t){n.setState({timeline:null}),n.canvas.current.innerHTML="no events"}))},n.gotoNow=function(){var t=new Date;n.timeline.moveTo(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes())},n.state={},n.canvas=u.a.createRef(),n.timeline=null,n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;n.e(2).then(n.bind(null,57)).then((function(e){return Object(l.d)("api/ipam/address_events",{id:t.props.id}).then((function(n){if(n.count>0){var a=n.events.map((function(t){var e=t.state,n=t.time;return{content:e,start:n,style:"up"===e?"background-color:#26CB20;":"background-color:#CB2026;",title:n}})),i=new e.DataSet(a);t.timeline=new e.Timeline(t.canvas.current,i,{locale:"en",min:a[a.length-1].start,align:"left",width:"100%",height:150,zoomMin:6e4,zoomMax:12096e5,clickToUse:!0})}else t.canvas.current.innerHTML="no events"}))}))}},{key:"render",value:function(){var t=this;return Object(O.jsxs)(h.Article,{header:"Events",children:[Object(O.jsx)("div",{className:f.a.events,ref:this.canvas}),Object(O.jsx)(p.RevertButton,{onClick:function(){return t.gotoNow()},title:"Go to now"},"ae_btn_reset"),"changeSelf"in this.props&&Object(O.jsx)(p.ItemsButton,{onClick:function(){return t.props.changeSelf(Object(O.jsx)(w,{id:t.props.id},"address_logs"))},title:"List"},"ae_btn_list"),Object(O.jsx)(p.DeleteButton,{onClick:function(){return t.clearList()},title:"clear logs"},"ae_btn_clear")]},"ae_art")}}]),a}(d.Component),I=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).deleteList=function(t){return Object(l.d)("api/ipam/reservation_delete",{id:t}).then((function(e){return e.deleted&&a.setState({data:a.state.data.filter((function(e){return e.id!==t}))})}))},a.listItem=function(t,e){return[t.ip,t.type,Object(O.jsx)(p.DeleteButton,{onClick:function(){return a.deleteList(t.id)}},"resv_list_delete_"+t.id)]},a.addEntry=function(){return a.props.changeSelf(Object(O.jsx)(y,{network_id:a.props.network_id,changeSelf:a.props.changeSelf},"resv_new_"+a.props.network_id))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/reservation_list",{network_id:this.props.network_id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(O.jsx)(h.ContentReport,{header:"Reservations",thead:["IP","Type",""],trows:this.state.data,listItem:this.listItem,children:Object(O.jsx)(p.AddButton,{onClick:function(){return t.addEntry()}},"resv_list_add_btn")},"resv_list_"+this.props.server_id):Object(O.jsx)(h.Spinner,{})}}]),n}(d.Component),y=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var i;return Object(r.a)(this,n),(i=e.call(this,t)).onChange=function(t){return i.setState(Object(a.a)({},t.target.name,t.target.value))},i.updateInfo=function(){return Object(l.d)("api/ipam/reservation_new",{network_id:i.props.network_id,ip:i.state.ip,type:i.state.type,a_domain_id:i.state.a_domain_id,start:i.state.start,end:i.state.end}).then((function(t){return i.setState({result:t})}))},i.state={ip:"",start:"",end:"",result:void 0,type:"dhcp"},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(l.d)("api/ipam/network_info",{id:this.props.network_id}).then((function(e){return t.setState(Object(i.a)({},e.data))})),Object(l.d)("api/dns/domain_list",{filter:"forward"}).then((function(e){return t.setState({domains:e.data})}))}},{key:"render",value:function(){var t=this;if(this.state.domains){var e=this.props.network_id,n=this.state.result?JSON.stringify(this.state.result.resv):"";return Object(O.jsxs)(h.InfoArticle,{header:"Reservation Address/Scope",children:[Object(O.jsx)("span",{children:"Allocate address with either 'ip' or 'start' to 'end' (e.g. a scope)"}),Object(O.jsxs)(h.InfoColumns,{children:[Object(O.jsx)(j.TextLine,{id:"network_id",label:"Network ID",text:e},"id"),Object(O.jsx)(j.TextLine,{id:"network",text:this.state.network+"/"+this.state.mask},"network"),Object(O.jsx)(j.TextInput,{id:"ip",label:"IP",value:this.state.ip,onChange:this.onChange},"ip"),Object(O.jsx)(j.TextInput,{id:"start",label:"Start IP",value:this.state.start,onChange:this.onChange},"start"),Object(O.jsx)(j.TextInput,{id:"end",label:"End IP",value:this.state.end,onChange:this.onChange},"end"),Object(O.jsxs)(j.SelectInput,{id:"type",label:"Type",value:this.state.type,onChange:this.onChange,children:[Object(O.jsx)("option",{value:"dhcp",children:"dhcp"},"dhcp"),Object(O.jsx)("option",{value:"reservation",children:"reservation"},"reservation")]},"type"),Object(O.jsx)(j.SelectInput,{id:"a_domain_id",label:"Domain",value:this.state.a_domain_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(O.jsx)("option",{value:t.id,children:t.name},e)}))},"a_domain_id")]},"dn_content"),this.props.changeSelf&&Object(O.jsx)(p.BackButton,{onClick:function(){return t.props.changeSelf(Object(O.jsx)(I,{network_id:e,changeSelf:t.props.changeSelf},"resv_list_"+e))}},"dn_btn_back"),Object(O.jsx)(p.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"dn_btn_save"),Object(O.jsx)(h.Result,{result:n},"dn_operation")]},"dn_article")}return Object(O.jsx)(h.Spinner,{})}}]),n}(d.Component)}}]);
//# sourceMappingURL=3.be8fefa5.chunk.js.map