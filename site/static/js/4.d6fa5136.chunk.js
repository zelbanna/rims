(this.webpackJsonprims=this.webpackJsonprims||[]).push([[4],{46:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return b})),n.d(e,"NetworkList",(function(){return f})),n.d(e,"AddressInfo",(function(){return x}));var a=n(19),i=n(10),r=n(5),s=n(6),o=n(8),c=n(7),d=n(3),u=n(14),l=n(15),h=n(16),j=n(21),p=n(0),b=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).changeContent=function(t){return a.setState(t)},a.state=Object(p.jsx)(f,{},"network_list"),a}return Object(s.a)(n,[{key:"render",value:function(){return Object(p.jsx)(p.Fragment,{children:this.state})}}]),n}(d.Component),f=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.id,t.netasc,t.description,t.service,Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j.ConfigureButton,{onClick:function(){return a.changeContent(Object(p.jsx)(O,{id:t.id},"network_"+t.id))},title:"Edit network properties"},"conf"),Object(p.jsx)(j.ItemsButton,{onClick:function(){return a.changeContent(Object(p.jsx)(m,{network_id:t.id,changeSelf:a.changeContent},"address_list_"+t.id))},title:"View addresses"},"items"),"v4"===t.class&&Object(p.jsx)(j.ViewButton,{onClick:function(){return a.changeContent(Object(p.jsx)(v,{network_id:t.id,changeSelf:a.changeContent},"address_layout_"+t.id))},title:"View usage map"},"layout"),"v4"===t.class&&Object(p.jsx)(j.CheckButton,{onClick:function(){return a.changeContent(Object(p.jsx)(k,{network_id:t.id,changeSelf:a.changeContent},"resv_list_"+t.id))},title:"Reserved addresses for network"},"resv"),Object(p.jsx)(j.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete network"},"del"),Object(p.jsx)(j.ReloadButton,{onClick:function(){return a.resetStatus(t.id)},title:"Reset state for network addresses"},"reset")]})]},a.deleteList=function(t){return window.confirm("Really delete network")&&Object(u.d)("api/ipam/network_delete",{id:t}).then((function(e){e.deleted&&(a.setState({data:a.state.data.filter((function(e){return e.id!==t}))}),a.changeContent(null))}))},a.resetStatus=function(t){return Object(u.d)("api/ipam/clear",{network_id:t}).then((function(t){return a.setState({result:t.count})}))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/network_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(l.ContentList,{header:"Networks",thead:["ID","Network","Description","DHCP",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[Object(p.jsx)(j.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(p.jsx)(j.AddButton,{onClick:function(){return t.changeContent(Object(p.jsx)(O,{id:"new"},"network_new_"+Object(u.e)()))},title:"Add network"},"add"),Object(p.jsx)(j.LogButton,{onClick:function(){return t.changeContent(Object(p.jsx)(_,{},"network_leases"))},title:"View IPAM/DHCP leases"},"leases")]},"cl"),Object(p.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(d.Component),O=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var s;return Object(r.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.changeContent=function(t){return s.setState({content:t})},s.updateInfo=function(){return Object(u.d)("api/ipam/network_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null,found:!0},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/network_info",{id:this.props.id,extra:["servers","domains"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(p.jsxs)(l.InfoArticle,{header:"Network",children:[Object(p.jsxs)(l.InfoColumns,{children:[Object(p.jsx)(h.TextLine,{id:"id",label:"ID",text:this.state.data.id},"id"),Object(p.jsx)(h.TextInput,{id:"description",value:this.state.data.description,onChange:this.onChange},"description"),Object(p.jsx)(h.TextInput,{id:"network",value:this.state.data.network,onChange:this.onChange},"network"),Object(p.jsx)(h.TextInput,{id:"mask",value:this.state.data.mask,onChange:this.onChange},"mask"),Object(p.jsx)(h.TextInput,{id:"gateway",value:this.state.data.gateway,onChange:this.onChange},"gateway"),Object(p.jsx)(h.SelectInput,{id:"server_id",label:"Server",value:this.state.data.server_id,onChange:this.onChange,children:this.state.servers.map((function(t,e){return Object(p.jsx)("option",{value:t.id,children:"".concat(t.service,"@").concat(t.node)},e)}))},"server_id"),Object(p.jsx)(h.SelectInput,{id:"reverse_zone_id",label:"Reverse Zone",value:this.state.data.reverse_zone_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(p.jsx)("option",{value:t.id,children:"".concat(t.server," (").concat(t.name,")")},e)}))},"reverse_zone_id")]},"network_content"),Object(p.jsx)(j.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"network_btn_save")]},"net_article"):Object(p.jsx)(l.Spinner,{})}}]),n}(d.Component),v=function(t){Object(o.a)(a,t);var e=Object(c.a)(a);function a(){var t;Object(r.a)(this,a);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).changeContent=function(e){return t.props.changeSelf(e)},t.changeDevice=function(e){return n.e(0).then(n.bind(null,36)).then((function(n){return t.changeContent(Object(p.jsx)(n.Info,{id:e},"di_"+e))}))},t.createDevice=function(e,a){return n.e(0).then(n.bind(null,36)).then((function(n){return t.changeContent(Object(p.jsx)(n.New,{ipam_network_id:e,ip:a},"dn_new"))}))},t}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/address_list",{network_id:this.props.network_id,dict:"ip_integer",extra:["device_id","reservation","ip_integer"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;if(!this.state)return Object(p.jsx)(l.Spinner,{});var e=function(){for(var e=t.state.data,n=Object(u.c)(t.state.network),a=[],i=function(i){var r=n+i;r in e?e[r].device_id?a.push(Object(p.jsx)(j.IpamRedButton,{onClick:function(){return t.changeDevice(e[r].device_id)},text:i%256},"btn_"+r)):a.push(Object(p.jsx)(j.IpamGreyButton,{text:i%256},"btn_"+r)):a.push(Object(p.jsx)(j.IpamGreenButton,{onClick:function(){return t.createDevice(t.props.network_id,Object(u.b)(r))},text:i%256},"btn_"+r))},r=0;r<t.state.size;r++)i(r);return{v:Object(p.jsx)(l.Article,{header:t.state.network+"/"+t.state.mask,children:a},"il_art")}}();return"object"===typeof e?e.v:void 0}}]),a}(d.Component),_=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).listItem=function(t){return[t.ip,t.mac,t.hostname,t.oui,t.starts,t.ends]},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/server_leases",{type:"active"}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return Object(p.jsx)(l.ContentReport,{header:"Leases",thead:["IP","Mac","Hostname","OUI","Starts","End"],trows:this.state.data,listItem:this.listItem},"lease_cr")}}]),n}(d.Component),m=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).changeContent=function(t){return a.props.changeSelf(t)},a.listItem=function(t){return[t.id,t.ip,t.hostname,t.domain,Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(l.StateLeds,{state:t.state},"state"),Object(p.jsx)(j.ConfigureButton,{onClick:function(){return a.changeContent(Object(p.jsx)(x,{id:t.id,changeSelf:a.changeContent},"address_info_"+t.id))},title:"Edit address entry"},"info"),Object(p.jsx)(j.DeleteButton,{onClick:function(){return a.deleteList(t.id)},title:"Delete address entry"},"del")]})]},a.deleteList=function(t){return window.confirm("Delete address?")&&Object(u.d)("api/ipam/address_delete",{id:t}).then((function(e){return e.deleted&&a.setState({data:a.state.data.filter((function(e){return e.id!==t}))})}))},a.state={data:null,result:null},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/address_list",{network_id:this.props.network_id,extra:["hostname","a_domain_id","device_id"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(p.jsxs)(l.ContentReport,{header:"Allocated IP Addresses",thead:["ID","IP","Hostname","Domain",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[Object(p.jsx)(j.ReloadButton,{onClick:function(){return t.componentDidMount()}},"al_btn_reload"),Object(p.jsx)(j.AddButton,{onClick:function(){return t.changeContent(Object(p.jsx)(x,{network_id:t.props.network_id,id:"new"},"address_new_"+Object(u.e)()))},title:"Add address entry"},"al_btn_add")]},"al_cr")}}]),n}(d.Component),x=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var s;return Object(r.a)(this,n),(s=e.call(this,t)).onChange=function(t){return s.setState({data:Object(i.a)(Object(i.a)({},s.state.data),{},Object(a.a)({},t.target.name,t.target.value))})},s.updateInfo=function(){s.setState({status:void 0}),Object(u.d)("api/ipam/address_info",Object(i.a)({op:"update"},s.state.data)).then((function(t){return s.setState(t)}))},s.state={data:null},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/address_info",{id:this.props.id,network_id:this.props.network_id}).then((function(e){return t.setState(e)})),Object(u.d)("api/dns/domain_list",{filter:"forward"}).then((function(e){return t.setState({domains:e.data})}))}},{key:"render",value:function(){var t=this;if(this.state&&this.state.data&&this.state.domains){var e="";return this.state.status&&(e="OK"===this.state.status?"OK":this.state.info),Object(p.jsxs)(l.InfoArticle,{header:"IP Address",children:[Object(p.jsxs)(l.InfoColumns,{children:[Object(p.jsx)(h.TextLine,{id:"id",label:"ID",text:this.state.data.id},"id"),Object(p.jsx)(h.TextLine,{id:"network",text:this.state.extra.network},"network"),Object(p.jsx)(h.TextInput,{id:"ip",label:"IP",value:this.state.data.ip,onChange:this.onChange},"ip"),Object(p.jsx)(h.TextInput,{id:"hostname",value:this.state.data.hostname,onChange:this.onChange,title:"Hostname when creating FQDN for DNS entry"},"hostname"),Object(p.jsx)(h.SelectInput,{id:"a_domain_id",label:"Domain",value:this.state.data.a_domain_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(p.jsx)("option",{value:t.id,children:t.name},e)}))},"a_domain_id")]},"ip_content"),Object(p.jsx)(j.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"ip_btn_save"),Object(p.jsx)(l.Result,{result:e},"ip_operation")]},"ip_article")}return Object(p.jsx)(l.Spinner,{})}}]),n}(d.Component),k=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).deleteList=function(t){return Object(u.d)("api/ipam/reservation_delete",{id:t}).then((function(e){return e.deleted&&a.setState({data:a.state.data.filter((function(e){return e.id!==t}))})}))},a.listItem=function(t,e){return[t.ip,t.type,Object(p.jsx)(j.DeleteButton,{onClick:function(){return a.deleteList(t.id)}},"resv_list_delete_"+t.id)]},a.addEntry=function(){return a.props.changeSelf(Object(p.jsx)(C,{network_id:a.props.network_id,changeSelf:a.props.changeSelf},"resv_new_"+a.props.network_id))},a.state={},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/reservation_list",{network_id:this.props.network_id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?Object(p.jsx)(l.ContentReport,{header:"Reservations",thead:["IP","Type",""],trows:this.state.data,listItem:this.listItem,children:Object(p.jsx)(j.AddButton,{onClick:function(){return t.addEntry()}},"resv_list_add_btn")},"resv_list_"+this.props.server_id):Object(p.jsx)(l.Spinner,{})}}]),n}(d.Component),C=function(t){Object(o.a)(n,t);var e=Object(c.a)(n);function n(t){var i;return Object(r.a)(this,n),(i=e.call(this,t)).onChange=function(t){return i.setState(Object(a.a)({},t.target.name,t.target.value))},i.updateInfo=function(){return Object(u.d)("api/ipam/reservation_new",{network_id:i.props.network_id,ip:i.state.ip,type:i.state.type,a_domain_id:i.state.a_domain_id,start:i.state.start,end:i.state.end}).then((function(t){return i.setState({result:t})}))},i.state={ip:"",start:"",end:"",result:void 0,type:"dhcp"},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/ipam/network_info",{id:this.props.network_id}).then((function(e){return t.setState(Object(i.a)({},e.data))})),Object(u.d)("api/dns/domain_list",{filter:"forward"}).then((function(e){return t.setState({domains:e.data})}))}},{key:"render",value:function(){var t=this;if(this.state.domains){var e=this.props.network_id,n=this.state.result?JSON.stringify(this.state.result.resv):"";return Object(p.jsxs)(l.InfoArticle,{header:"Reservation Address/Scope",children:[Object(p.jsx)("span",{children:"Allocate address with either 'ip' or 'start' to 'end' (e.g. a scope)"}),Object(p.jsxs)(l.InfoColumns,{children:[Object(p.jsx)(h.TextLine,{id:"network_id",label:"Network ID",text:e},"id"),Object(p.jsx)(h.TextLine,{id:"network",text:this.state.network+"/"+this.state.mask},"network"),Object(p.jsx)(h.TextInput,{id:"ip",label:"IP",value:this.state.ip,onChange:this.onChange},"ip"),Object(p.jsx)(h.TextInput,{id:"start",label:"Start IP",value:this.state.start,onChange:this.onChange},"start"),Object(p.jsx)(h.TextInput,{id:"end",label:"End IP",value:this.state.end,onChange:this.onChange},"end"),Object(p.jsxs)(h.SelectInput,{id:"type",label:"Type",value:this.state.type,onChange:this.onChange,children:[Object(p.jsx)("option",{value:"dhcp",children:"dhcp"},"dhcp"),Object(p.jsx)("option",{value:"reservation",children:"reservation"},"reservation")]},"type"),Object(p.jsx)(h.SelectInput,{id:"a_domain_id",label:"Domain",value:this.state.a_domain_id,onChange:this.onChange,children:this.state.domains.map((function(t,e){return Object(p.jsx)("option",{value:t.id,children:t.name},e)}))},"a_domain_id")]},"dn_content"),this.props.changeSelf&&Object(p.jsx)(j.BackButton,{onClick:function(){return t.props.changeSelf(Object(p.jsx)(k,{network_id:e,changeSelf:t.props.changeSelf},"resv_list_"+e))}},"dn_btn_back"),Object(p.jsx)(j.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"dn_btn_save"),Object(p.jsx)(l.Result,{result:n},"dn_operation")]},"dn_article")}return Object(p.jsx)(l.Spinner,{})}}]),n}(d.Component)}}]);
//# sourceMappingURL=4.d6fa5136.chunk.js.map