"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[328,772],{772:(t,e,s)=>{s.r(e),s.d(e,{Info:()=>_,Main:()=>p,ModelInfo:()=>N,New:()=>D,Report:()=>w,ReportSoftware:()=>y});var i=s(43),n=s(524),a=s(662),o=s(307),d=s(97),h=s(728),r=s(328),l=s(263),c=s(579);class p extends i.Component{constructor(t){super(t),this.compileNavItems=()=>{this.context.loadNavigation((0,c.jsxs)(o.NavBar,{children:[(0,c.jsxs)(o.NavDropDown,{title:"Devices",children:[(0,c.jsx)(o.NavDropButton,{title:"List",onClick:()=>this.changeContent((0,c.jsx)(m,{rack_id:this.state.rack_id},"dl"))},"dev_nav_list"),(0,c.jsx)(o.NavDropButton,{title:"Search",onClick:()=>this.changeContent((0,c.jsx)(u,{changeSelf:this.changeContent},"ds"))},"dev_nav_srch"),(0,c.jsx)(o.NavDropButton,{title:"New",onClick:()=>this.changeContent((0,c.jsx)(D,{ip:"0.0.0.0"},"dn"))},"dev_nav_new"),(0,c.jsx)(o.NavDropButton,{title:"Types",onClick:()=>this.changeContent((0,c.jsx)(B,{changeSelf:this.changeContent},"dtl"))},"dev_nav_types"),(0,c.jsx)(o.NavDropButton,{title:"Models",onClick:()=>this.changeContent((0,c.jsx)(M,{},"dml"))},"dev_nav_model")]},"dev_nav_devs"),(0,c.jsxs)(o.NavDropDown,{title:"Tools",children:[(0,c.jsx)(o.NavDropButton,{title:"FDB Search",onClick:()=>this.changeContent((0,c.jsx)(r.Search,{changeSelf:this.changeContent},"fdb_search"))},"dev_nav_fdbx"),(0,c.jsx)(o.NavDropButton,{title:"FDB List",onClick:()=>this.changeContent((0,c.jsx)(r.List,{changeSelf:this.changeContent},"fdb_list"))},"dev_nav_fdbs"),(0,c.jsx)(o.NavDropButton,{title:"OUI Search",onClick:()=>this.changeContent((0,c.jsx)(L,{},"oui_search"))},"dev_nav_ouis"),(0,c.jsx)(o.NavDropButton,{title:"OUI List",onClick:()=>this.changeContent((0,c.jsx)(T,{},"oui_list"))},"dev_nav_ouil"),(0,c.jsx)(o.NavDropButton,{title:"Reservations",onClick:()=>this.changeImport("reservation","List",{})},"dev_nav_resv")]},"dev_nav_tools"),this.state.pdu.length>0&&(0,c.jsx)(o.NavDropDown,{title:"PDUs",children:this.state.pdu.map(((t,e)=>(0,c.jsx)(o.NavDropButton,{title:t.hostname,onClick:()=>this.changeImport("pdu","Inventory",{device_id:t.id,type:t.type})},"dev_nav_pdu_"+e)))},"dev_nav_pdus"),this.state.console.length>0&&(0,c.jsx)(o.NavDropDown,{title:"Consoles",children:this.state.console.map(((t,e)=>(0,c.jsx)(o.NavDropButton,{title:t.hostname,onClick:()=>this.changeImport("console","Inventory",{device_id:t.id,type:t.type})},"dev_nav_console_"+e)))},"dev_nav_consoles"),this.state.rack_id&&(0,c.jsx)(o.NavButton,{title:this.state.name,onClick:()=>this.changeImport("rack","Layout",{id:this.state.rack_id})},"dev_nav_rack"),(0,c.jsx)(o.NavButton,{title:"Maps",onClick:()=>this.changeImport("visualize","List",{}),style:{float:"right"}},"dev_nav_maps"),(0,c.jsxs)(o.NavDropDown,{title:"IPAM",style:{float:"right"},children:[(0,c.jsx)(o.NavDropButton,{title:"Networks",onClick:()=>this.changeImport("ipam","NetworkList",{})},"dev_nav_nets"),(0,c.jsx)(o.NavDropButton,{title:"Servers",onClick:()=>this.changeImport("server","List",{type:"DHCP"})},"dev_nav_isrv")]},"dev_nav_ipam"),(0,c.jsxs)(o.NavDropDown,{title:"DNS",style:{float:"right"},children:[(0,c.jsx)(o.NavDropButton,{title:"Domains",onClick:()=>this.changeImport("dns","DomainList",{})},"dev_nav_doms"),(0,c.jsx)(o.NavDropButton,{title:"Servers",onClick:()=>this.changeImport("server","List",{type:"NAMESERVER"})},"dev_nav_dsrv"),(0,c.jsx)(o.NavDropButton,{title:"Recursors",onClick:()=>this.changeImport("server","List",{type:"RECURSOR"})},"dev_nav_recs")]},"dev_nav_dns")]},"device_navbar"))},this.changeContent=t=>this.setState({content:t}),this.state={pdu:[],console:[],name:"N/A",rack_id:void 0}}componentDidMount(){this.props.rack_id?(0,n.Cc)("api/rack/inventory",{id:this.props.rack_id}).then((t=>{Object.assign(this.state,{rack_id:this.props.rack_id,...t}),this.compileNavItems()})):this.compileNavItems()}componentDidUpdate(t){t!==this.props&&this.compileNavItems()}changeImport(t,e,i){s(25)("./"+t+".jsx").then((s=>{var n=s[e];this.setState({content:(0,c.jsx)(n,{...i},t+"_"+e)})}))}render(){return(0,c.jsx)(c.Fragment,{children:this.state.content})}}p.contextType=a.RimsContext;class u extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({[t.target.name]:t.target.value}),this.state={field:"ip",search:""}}render(){return(0,c.jsxs)(a.LineArticle,{header:"Device Search",children:[(0,c.jsxs)(d.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,c.jsxs)("optgroup",{label:"Group",children:[(0,c.jsx)("option",{value:"hostname",children:"Hostname"}),(0,c.jsx)("option",{value:"type",children:"Type"}),(0,c.jsx)("option",{value:"model",children:"Model"})]}),(0,c.jsxs)("optgroup",{label:"Unique",children:[(0,c.jsx)("option",{value:"id",children:"ID"}),(0,c.jsx)("option",{value:"ip",children:"IP"}),(0,c.jsx)("option",{value:"mac",children:"MAC"}),(0,c.jsx)("option",{value:"interface_id",children:"Interface ID"})]})]},"field"),(0,c.jsx)(d.SearchInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,c.jsx)(h.SearchButton,{onClick:()=>this.props.changeSelf((0,c.jsx)(m,{...this.state},"device_list")),title:"Search devices"},"ds_btn_search")]},"ds_art")}}class m extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({[t.target.name]:t.target.value}),this.sortList=t=>{"hostname"===t?this.state.data.sort(((t,e)=>t.hostname.localeCompare(e.hostname))):this.state.data.sort(((t,e)=>{if(t.ip&&e.ip){return Number(t.ip.split(".").map((t=>`000${t}`.slice(-3))).join(""))-Number(e.ip.split(".").map((t=>`000${t}`.slice(-3))).join(""))}return t.ip?1:t.hostname.localeCompare(e.hostname)})),this.setState({sort:t})},this.listItem=t=>[t.ip,(0,c.jsx)(h.HrefButton,{text:t.hostname,onClick:()=>this.changeContent((0,c.jsx)(_,{id:t.id,changeSelf:this.changeContent},"di_"+t.id)),title:t.id},"info_"+t.id),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.StateLeds,{state:t.ip_state?t.ip_state:t.if_state},"state"),(0,c.jsx)(h.InfoButton,{onClick:()=>this.changeContent((0,c.jsx)(_,{id:t.id,changeSelf:this.changeContent},"di_"+t.id)),title:t.id},"info"),(0,c.jsx)(h.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete device"},"del")]})],this.deleteList=t=>window.confirm("Really delete device "+t+"?")&&(0,n.Cc)("api/device/delete",{id:t}).then((e=>{e.deleted&&(this.setState({data:this.state.data.filter((e=>e.id!==t))}),this.changeContent(null))})),this.state={data:null,sort:t.hasOwnProperty("sort")?t.sort:"hostname",rack_id:this.props.rack_id,searchfield:"",field:this.props.field?this.props.field:"id",search:this.props.search?this.props.search:""}}componentDidMount(){(0,n.Cc)("api/device/list",{sort:this.state.sort,rack_id:this.state.rack_id,field:this.state.field,search:this.state.search}).then((t=>this.setState(t)))}render(){if(this.state.data){const t=this.state.data,e=this.state.searchfield.toLowerCase(),s=0===e.length?t:t.filter((t=>t.hostname.toLowerCase().includes(e)||t.ip&&t.ip.includes(e))),i=[(0,c.jsx)(h.HeaderButton,{text:"IP",highlight:"ip"===this.state.sort,onClick:()=>this.sortList("ip")},"sort_ip"),(0,c.jsx)(h.HeaderButton,{text:"Hostname",highlight:"hostname"===this.state.sort,onClick:()=>this.sortList("hostname")},"sort_hostname"),""];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.ContentList,{header:"Device List",thead:i,listItem:this.listItem,trows:s,children:[(0,c.jsx)(h.ItemsButton,{onClick:()=>{Object.assign(this.state,{rack_id:void 0,field:"ip",search:""}),this.componentDidMount()},title:"List all items"},"items"),(0,c.jsx)(h.AddButton,{onClick:()=>this.changeContent((0,c.jsx)(D,{ip:"0.0.0.0"},"dn_new")),title:"Add device"},"add"),(0,c.jsx)(h.DevicesButton,{onClick:()=>this.changeContent((0,c.jsx)(b,{},"device_discover")),title:"Discover new devices"},"devices"),(0,c.jsx)("br",{}),(0,c.jsxs)(d.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,c.jsxs)("optgroup",{label:"Group",children:[(0,c.jsx)("option",{value:"hostname",children:"Hostname"}),(0,c.jsx)("option",{value:"type",children:"Type"}),(0,c.jsx)("option",{value:"model",children:"Model"})]}),(0,c.jsxs)("optgroup",{label:"Unique",children:[(0,c.jsx)("option",{value:"id",children:"ID"}),(0,c.jsx)("option",{value:"ip",children:"IP"}),(0,c.jsx)("option",{value:"mac",children:"MAC"}),(0,c.jsx)("option",{value:"interface_id",children:"Interface ID"})]})]},"field"),(0,c.jsx)(d.SearchInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,c.jsx)(h.SearchButton,{onClick:()=>this.componentDidMount(),title:"Search specific device"},"reload"),(0,c.jsx)(d.SearchField,{searchFire:t=>this.setState({searchfield:t}),placeholder:"Filter devices"},"filter")]},"mcl"),(0,c.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]})}return(0,c.jsx)(a.Spinner,{})}}class _ extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.changeContent=t=>this.setState({content:t}),this.changeSelf=t=>this.props.changeSelf(t),this.updateInfo=()=>(0,n.Cc)("api/device/info",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.reload=()=>{this.setState({rack:void 0,vm:void 0}),(0,n.Cc)("api/device/info",{id:this.props.id}).then((t=>this.setState(t)))},this.lookupInfo=()=>{this.setState({content:(0,c.jsx)(a.Spinner,{}),result:""}),(0,n.Cc)("api/device/info",{id:this.props.id,op:"lookup"}).then((t=>this.setState({...t,content:null})))},this.changeInterfaces=()=>s.e(617).then(s.bind(s,617)).then((t=>this.changeContent((0,c.jsx)(t.List,{device_id:this.props.id,changeSelf:this.changeContent},"interface_list")))),this.changeVisualize=()=>s.e(362).then(s.bind(s,362)).then((t=>this.changeSelf((0,c.jsx)(t.Edit,{type:"device",changeSelf:this.changeSelf,id:this.props.id},"viz_id_"+this.props.id)))),this.state={data:void 0,found:!0,content:null,navconf:!1}}componentDidMount(){(0,n.Cc)("api/device/info",{id:this.props.id,extra:["types","classes"]}).then((t=>this.setState(t)))}render(){if(this.state.data){const t=this.state.data,e=this.state.extra,s=!("vm"!==t.class||!this.state.vm)&&this.state.vm,i=!(!this.state.rack||"vm"===t.class)&&this.state.rack,n=this.props.changeSelf,l=e.ip,p=e.functions.length>0?e.functions.split(","):[],u=this.state.types.find((e=>e.id===parseInt(t.type_id)));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.InfoArticle,{header:"Device",children:[(0,c.jsxs)(a.InfoColumns,{style:{float:"left"},children:[(0,c.jsx)(d.TextLine,{id:"hostname",text:t.hostname},"hostname"),(0,c.jsx)(d.TextInput,{id:"mac",label:"MAC",value:t.mac,title:"System MAC",onChange:this.onChange},"mac"),l&&(0,c.jsx)(d.TextLine,{id:"ip",label:"Mgmt IP",text:e.ip},"ip"),l&&(0,c.jsx)(d.StateLine,{id:"state",state:e.state},"state"),(0,c.jsx)(d.TextLine,{id:"system_id",label:"System ID",text:this.props.id},"system_id")]},"ic_info"),(0,c.jsxs)(a.InfoColumns,{style:{float:"left"},children:[(0,c.jsx)(d.SelectInput,{id:"class",value:t.class,onChange:this.onChange,children:this.state.classes.map((t=>(0,c.jsx)("option",{value:t,children:t},t)))},"class"),(0,c.jsx)(d.SelectInput,{id:"type_id",label:"Type",value:t.type_id,onChange:this.onChange,children:this.state.types.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"type_id"),(0,c.jsx)(d.TextInput,{id:"model",value:t.model,onChange:this.onChange,extra:t.model},"model"),(0,c.jsx)(d.TextLine,{id:"version",text:t.version},"version"),(0,c.jsx)(d.TextInput,{id:"serial",label:"S/N",value:t.serial,onChange:this.onChange},"serial")]},"ic_extra"),(0,c.jsxs)(a.InfoColumns,{style:{float:"left"},children:[i&&(0,c.jsx)(d.TextLine,{id:"rack_pos",label:"Rack/Pos",text:`${i.rack_name} (${i.rack_unit})`},"pos"),i&&(0,c.jsx)(d.TextLine,{id:"rack_size",label:"Size (U)",text:i.rack_size},"size"),i&&(0,c.jsx)(d.TextLine,{id:"rack_con",label:"TS/Port",text:`${i.console_name} (${i.console_port})`},"con"),i&&this.state.pems.map((t=>(0,c.jsx)(d.TextLine,{id:"pem_"+t.id,label:t.name+" PDU",text:`${t.pdu_name} (${t.pdu_unit})`},t.id)))]},"ic_rack"),(0,c.jsxs)(a.InfoColumns,{style:{float:"left"},children:[s&&(0,c.jsx)(d.TextLine,{id:"vm_name",label:"VM Name",text:s.name},"name"),s&&(0,c.jsx)(d.TextLine,{id:"vm_host",label:"VM Host",text:s.host},"host"),s&&(0,c.jsx)(d.TextLine,{id:"vm_uuid",label:"VM UUID",text:s.bios_uuid,style:{maxWidth:170},extra:s.bios_uuid},"uuid"),s&&(0,c.jsx)(d.TextLine,{id:"vm_uuhost",label:"Host UUID",text:s.server_uuid,style:{maxWidth:170},extra:s.server_uuid},"uuhost")]},"ic_vm"),(0,c.jsxs)(a.InfoColumns,{style:{clear:"both"},children:[(0,c.jsx)(d.TextInput,{id:"comment",value:t.comment,onChange:this.onChange},"comment"),(0,c.jsx)(d.UrlInput,{id:"url",label:"URL",value:t.url,onChange:this.onChange},"url")]},"ic_text"),(0,c.jsx)(h.ReloadButton,{onClick:()=>this.reload()},"reload"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"save"),(0,c.jsx)(h.ConfigureButton,{onClick:()=>this.setState({navconf:!this.state.navconf}),title:"Toggle config mode"},"edit"),(0,c.jsx)(h.StartButton,{onClick:()=>this.changeContent((0,c.jsx)(I,{id:this.props.id},"device_control")),title:"Device control"},"cont"),(0,c.jsx)(h.CheckButton,{onClick:()=>this.changeContent((0,c.jsx)(k,{id:this.props.id},"device_configure")),title:"Configuration template"},"conf"),n&&(0,c.jsx)(h.NetworkButton,{onClick:()=>this.changeVisualize(),title:"Connectivity map"},"netw"),l&&(0,c.jsx)(h.SearchButton,{onClick:()=>this.lookupInfo(),title:"Information lookup"},"search"),p.includes("manage")&&(0,c.jsx)(h.GoButton,{onClick:()=>this.context.changeMain({module:this.state.extra.type_base,function:"Manage",args:{device_id:this.props.id,type:this.state.extra.type_name}}),title:"Manage "+t.hostname},"manage"),l&&(0,c.jsx)(h.TermButton,{onClick:()=>window.open(`ssh://${e.username}@${e.ip}`,"_self"),title:"SSH connection"},"ssh"),i&&i.console_url&&(0,c.jsx)(h.TermButton,{onClick:()=>window.open(i.console_url,"_self"),title:"Serial Connection"},"console"),t.url&&(0,c.jsx)(h.UiButton,{onClick:()=>window.open(t.url,"_blank"),title:"Web UI"},"ui"),(0,c.jsx)(a.Result,{result:JSON.stringify(this.state.update)},"result")]},"di_ia"),(0,c.jsxs)(o.NavBar,{id:"di_navigation",children:[this.state.navconf&&(0,c.jsx)(o.NavButton,{title:"Management",onClick:()=>this.changeContent((0,c.jsx)(x,{id:this.props.id},"device_configure"))},"management"),this.state.navconf&&["infrastructure","out-of-band"].includes(t.class)&&(0,c.jsx)(o.NavButton,{title:"Rack",onClick:()=>this.changeContent((0,c.jsx)(v,{device_id:this.props.id},"device_rack_info"))},"rack"),this.state.navconf&&["device","infrastructure","out-of-band"].includes(t.class)&&(0,c.jsx)(o.NavButton,{title:"PEMs",onClick:()=>this.changeContent((0,c.jsx)(C,{device_id:this.props.id,changeSelf:this.changeContent},"device_pem_list"))},"pems"),!this.state.navconf&&(0,c.jsx)(o.NavButton,{title:"Interfaces",onClick:()=>this.changeInterfaces()},"interfaces"),!this.state.navconf&&["infrastructure","out-of-band","vm"].includes(t.class)&&(0,c.jsx)(o.NavButton,{title:"Statistics",onClick:()=>this.changeContent((0,c.jsx)(g,{device_id:this.props.id,changeSelf:this.changeContent},"statistics_list"))},"stats"),!this.state.navconf&&"network"===u.base&&l&&(0,c.jsx)(o.NavButton,{title:"FDB",onClick:()=>this.changeContent((0,c.jsx)(r.Device,{id:this.props.id,ip:e.ip,type:u.name,changeSelf:this.changeContent},"fdb_device"))},"fdb"),!this.state.navconf&&p.filter((t=>"manage"!==t)).map(((t,e)=>(0,c.jsx)(o.NavButton,{title:t.replace("_"," "),onClick:()=>this.changeContent((0,c.jsx)(R,{id:this.props.id,op:t,type:this.state.extra.type_name},"dev_func_"+t))},"nav_"+e)))]},"device_navigation"),this.state.content]})}return(0,c.jsx)(a.Spinner,{})}}_.contextType=a.RimsContext;class x extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.changeContent=t=>this.setState({content:t}),this.updateInfo=()=>(0,n.Cc)("api/device/extended",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={data:void 0,found:!0,content:null}}componentDidMount(){(0,n.Cc)("api/device/extended",{id:this.props.id,extra:["domains"]}).then((t=>this.setState(t)))}render(){return this.state.data&&this.state.domains?(0,c.jsxs)(a.InfoArticle,{header:"Management Configuration",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.TextInput,{id:"hostname",value:this.state.data.hostname,onChange:this.onChange},"d_conf_hostname"),(0,c.jsx)(d.SelectInput,{id:"a_domain_id",label:"Host Domain",value:this.state.data.a_domain_id,onChange:this.onChange,children:this.state.domains.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"d_conf_a_domain_id"),(0,c.jsx)(d.SelectInput,{id:"ipam_id",label:"Mgmt IP",value:this.state.data.ipam_id,onChange:this.onChange,children:this.state.interfaces.map(((t,e)=>(0,c.jsx)("option",{value:t.ipam_id,children:`${t.ip} (${t.name})`},e)))},"d_conf_ipam_id"),(0,c.jsx)(d.TextLine,{id:"id",label:"Local ID",text:this.props.id,title:"Database ID"},"id"),(0,c.jsx)(d.TextLine,{id:"snmp",label:"SNMP",text:this.state.data.snmp},"snmp"),(0,c.jsx)(d.TextLine,{id:"oid",label:"Priv OID",text:this.state.extra.oid},"d_conf_oid"),(0,c.jsx)(d.TextLine,{id:"oui",label:"System OUI",text:this.state.extra.oui},"d_conf_oui")]},"d_conf_ic"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"d_conf_btn_save"),(0,c.jsx)(a.Result,{result:this.state.status},"d_conf_result")]},"d_conf_art"):(0,c.jsx)(a.Spinner,{})}}class v extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.updateInfo=()=>(0,n.Cc)("api/device/rack",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={}}componentDidMount(){(0,n.Cc)("api/device/rack",{device_id:this.props.device_id}).then((t=>this.setState(t)))}render(){if(this.state.data){const t=this.state.data.rack_id&&"NULL"!==this.state.data.rack_id;return(0,c.jsxs)(a.InfoArticle,{header:"Rack",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.SelectInput,{id:"rack_id",label:"Rack ID",value:this.state.data.rack_id,onChange:this.onChange,children:this.state.racks.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"d_rack_id"),t&&(0,c.jsx)(d.TextInput,{id:"rack_size",label:"Size",value:this.state.data.rack_size,onChange:this.onChange,title:"Size of device in U"},"d_rack_size"),t&&(0,c.jsx)(d.TextInput,{id:"rack_unit",label:"Unit",value:this.state.data.rack_unit,onChange:this.onChange,title:"First unit of placement"},"d_rack_unit"),t&&(0,c.jsx)(d.SelectInput,{id:"console_id",label:"Console",value:this.state.data.console_id,onChange:this.onChange,children:this.state.consoles.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.hostname},e)))},"d_rack_con_id"),t&&(0,c.jsx)(d.TextInput,{id:"console_port",label:"Console Port",value:this.state.data.console_port,onChange:this.onChange},"d_rack_con_port")]},"d_rack_ic"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"d_rack_btn_save")]},"d_rack_art")}return(0,c.jsx)(a.Spinner,{})}}class C extends i.Component{constructor(t){super(t),this.changeContent=t=>this.props.changeSelf(t),this.deleteList=t=>window.confirm("Really delete PEM?")&&(0,n.Cc)("api/pem/delete",{id:t}).then((e=>e.deleted&&this.setState({data:this.state.data.filter((e=>e.id!==t)),content:null}))),this.listItem=t=>[t.id,t.name,t.pdu_id,t.pdu_name,t.pdu_slot,t.pdu_unit,(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.InfoButton,{onClick:()=>this.changeContent((0,c.jsx)(j,{id:t.id,device_id:this.props.device_id,changeSelf:this.changeContent},"pem_info_"+t.id)),title:"Edit PEM information"},"info"),(0,c.jsx)(h.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete PEM"},"del")]})],this.state={}}componentDidMount(){(0,n.Cc)("api/pem/list",{device_id:this.props.device_id,lookup:!0}).then((t=>this.setState(t)))}render(){return this.state.data?(0,c.jsxs)(a.ContentReport,{header:"PEMs",thead:["ID","Name","PDU ID","PDU Name","PDU Slot","PDU Unit",""],trows:this.state.data,listItem:this.listItem,children:[(0,c.jsx)(h.ReloadButton,{onClick:()=>this.componentDidMount()},"pems_btn_reload"),(0,c.jsx)(h.AddButton,{onClick:()=>this.changeContent((0,c.jsx)(j,{id:"new",device_id:this.props.device_id,changeSelf:this.changeContent},"pem_new")),title:"Add PEM"},"pems_btn_add")]},"pems"):(0,c.jsx)(a.Spinner,{})}}class j extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.updateInfo=()=>(0,n.Cc)("api/pem/info",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={}}componentDidMount(){(0,n.Cc)("api/pem/info",{id:this.props.id,device_id:this.props.device_id}).then((t=>this.setState(t))),(0,n.Cc)("api/pdu/list",{device_id:this.props.device_id,empty:!0}).then((t=>this.setState({pdus:t.data})))}render(){if(this.state.data&&this.state.pdus){const t=this.state.pdus.find((t=>parseInt(t.device_id)===parseInt(this.state.data.pdu_id)));let e=[];if(t)for(let s=0;s<t.slots;s++)e.push({id:s,name:t[`${s}_slot_name`]});return(0,c.jsxs)(a.InfoArticle,{header:"PEM",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.TextInput,{id:"name",value:this.state.data.name,onChange:this.onChange},"d_pem_name"),(0,c.jsx)(d.SelectInput,{id:"pdu_id",label:"PDU",value:this.state.data.pdu_id,onChange:this.onChange,children:this.state.pdus.map(((t,e)=>(0,c.jsx)("option",{value:t.device_id,children:t.name},e)))},"d_pem_pdu_id"),(0,c.jsx)(d.SelectInput,{id:"pdu_slot",label:"Slot",value:this.state.data.pdu_slot,onChange:this.onChange,children:e.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"d_pem_pdu_slot"),(0,c.jsx)(d.TextInput,{id:"pdu_unit",label:"Unit",value:this.state.data.pdu_unit,onChange:this.onChange},"d_pem_pdu_unit")]},"d_pem_ic"),(0,c.jsx)(h.BackButton,{onClick:()=>this.props.changeSelf((0,c.jsx)(C,{device_id:this.props.device_id,changeSelf:this.props.changeSelf},"device_pem_list"))},"d_pem_btn_back"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"d_pem_btn_save"),(0,c.jsx)(a.Result,{result:this.state.update?this.state.result?JSON.stringify(this.state.result):JSON.stringify(this.state.update):""},"d_pem_result")]},"d_pem_art")}return(0,c.jsx)(a.Spinner,{})}}class g extends i.Component{constructor(t){super(t),this.loadList=t=>(0,n.Cc)("api/statistics/list",{device_id:this.props.device_id}).then((e=>this.setState(t?{...e,result:"",inserts:""}:e))),this.changeContent=t=>this.props.changeSelf(t),this.deleteList=t=>window.confirm("Really delete statistics point?")&&(0,n.Cc)("api/statistics/delete",{id:t}).then((e=>e.deleted&&this.setState({data:this.state.data.filter((e=>e.id!==t)),content:null}))),this.lookupStats=()=>(0,n.Cc)("api/statistics/lookup",{device_id:this.props.device_id}).then((t=>{this.setState(t),this.loadList()})),this.listItem=t=>[t.id,t.measurement,t.tags,t.name,t.oid,(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.InfoButton,{onClick:()=>this.changeContent((0,c.jsx)(S,{id:t.id,device_id:this.props.device_id},"statistics_info_"+t.id)),title:"Edit data point"},"info"),t.measurement&&t.name&&(0,c.jsx)(h.HealthButton,{onClick:()=>this.changeContent((0,c.jsx)(f,{device_id:this.props.device_id,measurement:t.measurement,name:t.name},t.id)),title:"Stats for data point"},"stats"),(0,c.jsx)(h.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete data point"},"del")]})],this.state={}}componentDidMount(){this.loadList()}render(){return this.state.data?(0,c.jsxs)(a.ContentReport,{header:"Device statistics",thead:["ID","Measurement","Tags","Name","OID",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[(0,c.jsx)(h.ReloadButton,{onClick:()=>this.loadList(!0)},"reload"),(0,c.jsx)(h.SearchButton,{onClick:()=>this.lookupStats(),title:"Lookup device type stats"},"lookup"),(0,c.jsx)(h.AddButton,{onClick:()=>this.changeContent((0,c.jsx)(S,{id:"new",device_id:this.props.device_id},"stats_new_")),title:"Add statistics"},"add")]},"cr_stats"):(0,c.jsx)(a.Spinner,{})}}class f extends i.Component{constructor(t){super(t),this.updateItems=t=>(0,n.Cc)("api/statistics/query_ddp",{device_id:this.props.device_id,measurement:this.props.measurement,name:this.props.name,range:t}).then((t=>{if("OK"===t.status){const e={};t.header.forEach(((t,s)=>e[t]=s));const s=new this.vis.DataSet(t.data.map((t=>({x:t[e._time],y:t[e._value],group:"data"}))));this.graph.setItems(s),this.graph.fit()}})),this.rangeChange=t=>{this.setState({[t.target.name]:t.target.value}),this.updateItems(t.target.value)},this.gotoNow=()=>{const t=new Date;this.graph.moveTo(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes())},this.state={range:1},this.canvas=i.createRef(),this.graph=null,this.vis=null}componentDidMount(){s.e(347).then(s.bind(s,347)).then((t=>{this.vis=t;const e=new this.vis.DataSet([{id:"data",content:this.props.name}]);this.graph=new this.vis.Graph2d(this.canvas.current,[],e,{locale:"en",width:"100%",height:"100%",zoomMin:6e4,zoomMax:12096e5,clickToUse:!0,drawPoints:!1,interpolation:!1,legend:!0,dataAxis:{alignZeros:!1,icons:!0,left:{title:{text:"value"}}}}),this.updateItems(this.state.range)}))}render(){return(0,c.jsxs)(a.Article,{header:"Statistics",children:[(0,c.jsx)(h.ReloadButton,{onClick:()=>this.updateItems(this.state.range),title:"Reload"},"reload"),(0,c.jsx)(h.RevertButton,{onClick:()=>this.gotoNow(),title:"Go to now"},"reset"),(0,c.jsx)("br",{}),(0,c.jsx)(d.TextLine,{id:"name",label:"Device Data Point",text:this.props.name},"name"),(0,c.jsx)("br",{}),(0,c.jsxs)(d.SelectInput,{id:"range",label:"Time range",value:this.state.range,onChange:this.rangeChange,children:[(0,c.jsx)("option",{value:"1",children:"1h"}),(0,c.jsx)("option",{value:"4",children:"4h"}),(0,c.jsx)("option",{value:"8",children:"8h"}),(0,c.jsx)("option",{value:"24",children:"24h"})]},"range"),(0,c.jsx)("div",{className:l.A.graphs,ref:this.canvas})]},"ds_art")}}class S extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.updateInfo=()=>(0,n.Cc)("api/statistics/info",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={}}componentDidMount(){(0,n.Cc)("api/statistics/info",{id:this.props.id,device_id:this.props.device_id}).then((t=>this.setState(t)))}render(){return this.state.data?(0,c.jsxs)(a.InfoArticle,{header:"Data point",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.TextInput,{id:"measurement",value:this.state.data.measurement,onChange:this.onChange,title:"Group, or measurement, that the data point belongs to"},"d_stat_measurement"),(0,c.jsx)(d.TextInput,{id:"tags",value:this.state.data.tags,onChange:this.onChange,title:"Tags are comma separated values that extend TSDB grouping"},"d_stat_tags"),(0,c.jsx)(d.TextInput,{id:"name",value:this.state.data.name,onChange:this.onChange,title:"Data point name"},"d_stat_name"),(0,c.jsx)(d.TextInput,{id:"oid",value:this.state.data.oid,onChange:this.onChange},"d_stat_oid")]},"d_stat_ic"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"d_stat_btn_save"),(0,c.jsx)(a.Result,{result:this.state.update&&this.state.result?JSON.stringify(this.state.result):JSON.stringify(this.state.update)},"d_stat_result")]},"d_stat_art"):(0,c.jsx)(a.Spinner,{})}}class I extends i.Component{constructor(t){super(t),this.operationDev=(t,e)=>{window.confirm(e)&&(this.setState({wait:(0,c.jsx)(a.Spinner,{})}),(0,n.Cc)("api/device/control",{id:this.props.id,device_op:t}).then((t=>this.setState({...t,wait:null}))))},this.operationPem=(t,e,s)=>{window.confirm(s)&&(this.setState({wait:(0,c.jsx)(a.Spinner,{})}),(0,n.Cc)("api/device/control",{id:this.props.id,pem_op:e,pem_id:t}).then((t=>this.setState({...t,wait:null}))))},this.lookupState=t=>console.log("State lookup TODO"),this.state={pems:[]}}componentDidMount(){(0,n.Cc)("api/device/control",{id:this.props.id}).then((t=>this.setState(t)))}render(){return(0,c.jsxs)(a.InfoArticle,{header:"Device Control",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)("label",{htmlFor:"reboot",children:"Reboot:"}),(0,c.jsx)(h.ReloadButton,{id:"reboot",onClick:()=>this.operationDev("reboot","Really reboot?"),title:"Restart device"},"reboot"),(0,c.jsx)("label",{htmlFor:"shutdown",children:"Shutdown:"}),(0,c.jsx)(h.ShutdownButton,{id:"shutdown",onClick:()=>this.operationDev("shutdown","Really shutdown?"),title:"Shutdown"},"shutdown"),this.state.pems.map((t=>"off"===t.state?(0,c.jsxs)(i.Fragment,{children:[(0,c.jsxs)("label",{htmlFor:t.id,children:[t.name,":"]}),(0,c.jsx)(h.StartButton,{id:t.id,onClick:()=>this.operationPem(t.id,"on","Power on PEM?"),title:"Power ON"},"dc_btn_start_"+t.id)]},t.id):"on"===t.state?(0,c.jsxs)(i.Fragment,{children:[(0,c.jsxs)("label",{htmlFor:t.id,children:[t.name,":"]}),(0,c.jsx)(h.ShutdownButton,{id:t.id,onClick:()=>this.operationPem(t.id,"off","Power off PEM?"),title:"Power OFF"},"dc_btn_stop_"+t.id)]},t.id):(0,c.jsxs)(i.Fragment,{children:[(0,c.jsxs)("label",{htmlFor:t.id,children:[t.name,":"]}),(0,c.jsx)(h.SearchButton,{id:t.id,onClick:()=>this.lookupState(t.id),title:"Lookup State"},"dc_btn_lookup_"+t.id)]},t.id)))]},"ic"),(0,c.jsx)(a.Result,{result:JSON.stringify(this.state.result)},"result"),this.state.wait]},"ia_dc")}}class k extends i.Component{componentDidMount(){(0,n.Cc)("api/device/configuration_template",{id:this.props.id}).then((t=>this.setState(t)))}render(){return this.state?(0,c.jsx)(a.CodeArticle,{children:"OK"===this.state.status?this.state.data.join("\n"):this.state.info},"dtemp_art"):(0,c.jsx)(a.Spinner,{})}}class D extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.addDevice=()=>{this.state.data.hostname&&(0,n.Cc)("api/device/new",this.state.data).then((t=>this.setState({result:JSON.stringify(t)})))},this.searchIP=()=>{this.state.data.ipam_network_id&&(0,n.Cc)("api/ipam/address_find",{network_id:this.state.data.ipam_network_id}).then((t=>this.setState({data:{...this.state.data,ip:t.ip}})))},this.state={data:{ip:this.props.ip,mac:"00:00:00:00:00:00",class:"device",ipam_network_id:this.props.ipam_network_id,hostname:""},found:!0}}componentDidMount(){(0,n.Cc)("api/dns/domain_list",{filter:"forward"}).then((t=>this.setState({domains:t.data}))),(0,n.Cc)("api/ipam/network_list").then((t=>this.setState({networks:t.data}))),(0,n.Cc)("api/device/class_list").then((t=>this.setState({classes:t.data})))}componentDidUpdate(t){t!==this.props&&this.setState({data:{ip:this.props.ip,mac:"00:00:00:00:00:00",class:"device",ipam_network_id:this.props.ipam_network_id,hostname:""}})}render(){return this.state.domains&&this.state.classes&&this.state.networks?(0,c.jsxs)(a.InfoArticle,{header:"Device Add",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.TextInput,{id:"hostname",value:this.state.data.hostname,placeholder:"Device hostname",onChange:this.onChange},"dn_hostname"),(0,c.jsx)(d.SelectInput,{id:"class",label:"Device Class",value:this.state.data.class,onChange:this.onChange,children:this.state.classes.map((t=>(0,c.jsx)("option",{value:t,children:t},t)))},"dn_class"),(0,c.jsx)(d.SelectInput,{id:"a_domain_id",label:"Host Domain",value:this.state.data.a_domain_id,onChange:this.onChange,children:this.state.domains.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"dn_a_domain_id"),(0,c.jsx)(d.SelectInput,{id:"if_domain_id",label:"Interface Domain",value:this.state.data.if_domain_id,onChange:this.onChange,children:this.state.domains.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"dn_if_domain_id"),(0,c.jsx)(d.SelectInput,{id:"ipam_network_id",label:"Interface Network",value:this.state.data.ipam_network_id,onChange:this.onChange,children:this.state.networks.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:`${t.netasc} (${t.description})`},e)))},"dn_ipam_network_id"),(0,c.jsx)(d.TextInput,{id:"ip",label:"IP",value:this.state.data.ip,onChange:this.onChange},"dn_ip"),(0,c.jsx)(d.TextInput,{id:"mac",label:"MAC",value:this.state.data.mac,onChange:this.onChange},"dn_mac")]},"dn_content"),(0,c.jsx)(h.StartButton,{onClick:()=>this.addDevice(),title:"Add device"},"dn_btn_start"),(0,c.jsx)(h.SearchButton,{onClick:()=>this.searchIP(),title:"Find available IP"},"dn_btn_search"),(0,c.jsx)(a.Result,{result:this.state.result},"dn_result")]},"dn_art"):(0,c.jsx)(a.Spinner,{})}}class b extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({[t.target.name]:t.target.value}),this.changeContent=t=>this.setState({content:t}),this.state={ipam_network_id:void 0,a_domain_id:void 0,content:null}}componentDidMount(){(0,n.Cc)("api/ipam/network_list").then((t=>this.setState({networks:t.data}))),(0,n.Cc)("api/dns/domain_list",{filter:"forward"}).then((t=>this.setState({domains:t.data})))}runDiscovery(){this.setState({content:(0,c.jsx)(a.Spinner,{})}),(0,n.Cc)("api/device/discover",{network_id:this.state.ipam_network_id,a_domain_id:this.state.a_domain_id,if_domain_id:this.state.if_domain_id}).then((t=>this.setState({content:(0,c.jsx)(a.CodeArticle,{children:JSON.stringify(t,null,2)},"dd_result")})))}render(){return this.state.networks&&this.state.domains?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.InfoArticle,{header:"Device Discovery",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.SelectInput,{id:"ipam_network_id",label:"Network",value:this.state.ipam_network_id,onChange:this.onChange,children:this.state.networks.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:`${t.netasc} (${t.description})`},e)))},"ipam_network_id"),(0,c.jsx)(d.SelectInput,{id:"a_domain_id",label:"Host Domain",value:this.state.a_domain_id,onChange:this.onChange,children:this.state.domains.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"a_domain_id"),(0,c.jsx)(d.SelectInput,{id:"if_domain_id",label:"Interface Domain",value:this.state.if_domain_id,onChange:this.onChange,children:this.state.domains.map(((t,e)=>(0,c.jsx)("option",{value:t.id,children:t.name},e)))},"if_domain_id")]},"ic"),(0,c.jsx)(h.StartButton,{onClick:()=>this.runDiscovery(),title:"Start discovery"},"start")]},"ia_dd"),(0,c.jsx)(o.NavBar,{id:"dd_navigation"},"dd_navigation"),this.state.content]}):(0,c.jsx)(a.Spinner,{})}}class w extends i.Component{constructor(){super(...arguments),this.listItem=t=>[t.id,t.hostname,t.class,t.ip,t.mac,t.oui,t.type_name,t.oid,t.serial,(0,c.jsx)(a.StateLeds,{state:t.state},"dr_"+t.id)]}componentDidMount(){(0,n.Cc)("api/device/list",{extra:["system","mac","type","oui","class"]}).then((t=>this.setState(t)))}render(){return this.state?(0,c.jsx)(a.ContentReport,{header:"Devices",thead:["ID","Hostname","Class","IP","MAC","OUI","Type","OID","Serial","State"],trows:this.state.data,listItem:this.listItem},"dev_cr"):(0,c.jsx)(a.Spinner,{})}}class y extends i.Component{constructor(){super(...arguments),this.listItem=t=>[t.id,t.hostname,t.ip,t.model,t.version,(0,c.jsx)(a.StateLeds,{state:t.ip_state},"dr_"+t.id)]}componentDidMount(){(0,n.Cc)("api/device/list",{extra:["model","version"]}).then((t=>this.setState(t)))}render(){return this.state?(0,c.jsx)(a.ContentReport,{header:"Devices",thead:["ID","Hostname","IP","Model","Version","State"],trows:this.state.data,listItem:this.listItem},"dev_cr"):(0,c.jsx)(a.Spinner,{})}}class B extends i.Component{constructor(t){super(t),this.changeSelf=t=>this.props.changeSelf(t),this.listItem=t=>[t.base,(0,c.jsx)(h.HrefButton,{text:t.name,onClick:()=>this.changeSelf((0,c.jsx)(m,{field:"type",search:t.name},"device_list"))},"tl_btn_"+t.name),t.icon],this.state={}}componentDidMount(){(0,n.Cc)("api/device/type_list").then((t=>this.setState(t)))}render(){return this.state.data?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.ContentList,{header:"Device Types",thead:["Class","Name","Icon"],trows:this.state.data,listItem:this.listItem},"cl"),(0,c.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]}):(0,c.jsx)(a.Spinner,{})}}class M extends i.Component{constructor(t){super(t),this.syncModels=()=>(0,n.Cc)("api/device/model_list",{op:"sync"}).then((t=>this.setState(t))),this.listItem=t=>[t.id,t.name,t.type,(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.ConfigureButton,{onClick:()=>this.changeContent((0,c.jsx)(N,{id:t.id},"model_info_"+t.id)),title:"Edit model information"},"info"),(0,c.jsx)(h.DeleteButton,{onClick:()=>this.deleteList(t.id),title:"Delete model"},"del")]})],this.deleteList=t=>window.confirm("Really delete model?")&&(0,n.Cc)("api/device/model_delete",{id:t}).then((e=>{e.deleted&&(this.setState({data:this.state.data.filter((e=>e.id!==t))}),this.changeContent(null))})),this.state={}}componentDidMount(){(0,n.Cc)("api/device/model_list").then((t=>this.setState({...t,result:"OK"})))}render(){return this.state.data?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(a.ContentList,{header:"Device Models",thead:["ID","Model","Type",""],trows:this.state.data,listItem:this.listItem,result:this.state.result,children:[(0,c.jsx)(h.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,c.jsx)(h.SyncButton,{onClick:()=>this.syncModels(),title:"Resync models"},"sync")]},"cl"),(0,c.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]}):(0,c.jsx)(a.Spinner,{})}}class N extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.updateInfo=()=>(0,n.Cc)("api/device/model_info",{op:"update",...this.state.data}).then((t=>this.setState(t))),this.state={data:null,found:!0}}componentDidMount(){(0,n.Cc)("api/device/model_info",{id:this.props.id}).then((t=>this.setState(t)))}render(){return this.state.data?(0,c.jsxs)(a.InfoArticle,{header:"Device Model",children:[(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)(d.TextLine,{id:"name",text:this.state.data.name},"dm_name"),(0,c.jsx)(d.TextLine,{id:"type",text:this.state.extra.type},"dm_type"),(0,c.jsx)(d.TextInput,{id:"defaults_file",label:"Default File",value:this.state.data.defaults_file,onChange:this.onChange},"dm_defaults_file"),(0,c.jsx)(d.TextInput,{id:"image_file",label:"Image  File",value:this.state.data.image_file,onChange:this.onChange},"dm_image_file")]},"dm_content"),(0,c.jsx)(d.TextAreaInput,{id:"parameters",onChange:this.onChange,value:this.state.data.parameters},"dm_parameters"),(0,c.jsx)(h.SaveButton,{onClick:()=>this.updateInfo(),title:"Save"},"dm_btn_save")]},"dm_art"):(0,c.jsx)(a.Spinner,{})}}class L extends i.Component{constructor(t){super(t),this.onChange=t=>this.setState({data:{...this.state.data,[t.target.name]:t.target.value}}),this.ouiSearch=()=>{(0,n.Cc)("api/services/oui/info",{oui:this.state.data.oui}).then((t=>this.setState({content:(0,c.jsx)(a.InfoArticle,{children:(0,c.jsxs)(a.InfoColumns,{children:[(0,c.jsx)("label",{htmlFor:"oui",children:"OUI:"}),(0,c.jsx)("span",{id:"oui",children:t.data.oui}),(0,c.jsx)("label",{htmlFor:"company",children:"Company:"}),(0,c.jsx)("span",{id:"company",children:t.data.company})]},"os_cont")},"os_art")})))},this.state={data:{oui:""},content:null}}render(){return(0,c.jsxs)(a.Flex,{children:[(0,c.jsxs)(a.LineArticle,{children:["Type MAC address to find ",(0,c.jsx)(d.TextInput,{id:"oui",onChange:this.onChange,value:this.state.data.oui,placeholder:"00:00:00"},"oui"),(0,c.jsx)(h.SearchButton,{onClick:()=>this.ouiSearch(),title:"Search for OUI"},"os_btn_search")]},"os_art"),this.state.content]},"flex")}}class T extends i.Component{constructor(t){super(t),this.state={}}componentDidMount(){(0,n.Cc)("api/services/oui/list").then((t=>this.setState(t)))}render(){return this.state.data?(0,c.jsx)(a.ContentReport,{header:"OUI",thead:["oui","company"],trows:this.state.data,listItem:t=>[`${t.oui.substring(0,2)}:${t.oui.substring(2,4)}:${t.oui.substring(4,6)}`,t.company]},"oui_list_cr"):(0,c.jsx)(a.Spinner,{})}}class R extends i.Component{componentDidMount(){(0,n.Cc)("api/device/function",{op:this.props.op,id:this.props.id,type:this.props.type}).then((t=>this.setState(t)))}render(){if(this.state){if("OK"===this.state.status){if(this.state.data.length>0){const t=Object.keys(this.state.data[0]);return(0,c.jsx)(a.ContentReport,{thead:t,trows:this.state.data,listItem:e=>t.map((t=>e[t]))},"df_cr")}return(0,c.jsx)(a.InfoArticle,{children:"No Data"},"df_art")}return(0,c.jsxs)(a.CodeArticle,{children:["Error in devdata: ",this.state.info]},"df_art")}return(0,c.jsx)(a.Spinner,{})}}},328:(t,e,s)=>{s.r(e),s.d(e,{Device:()=>l,List:()=>c,Search:()=>r});var i=s(43),n=s(524),a=s(662),o=s(97),d=s(728),h=s(579);class r extends i.Component{constructor(t){super(t),this.changeContent=t=>this.props.changeSelf(t),this.onChange=t=>this.setState({[t.target.name]:t.target.value}),this.state={field:"mac",search:""}}render(){return(0,h.jsxs)(a.LineArticle,{header:"FDB Search",children:[(0,h.jsxs)(o.SelectInput,{id:"field",onChange:this.onChange,value:this.state.field,children:[(0,h.jsx)("option",{value:"mac",children:"MAC"}),(0,h.jsx)("option",{value:"device_id",children:"Device ID"})]},"field"),(0,h.jsx)(o.TextInput,{id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"},"search"),(0,h.jsx)(d.SearchButton,{onClick:()=>this.changeContent((0,h.jsx)(c,{...this.state,changeSelf:this.props.changeSelf},"fdb_list")),title:"Search FDB"},"fs_btn_search")]},"fs_art")}}class l extends i.Component{constructor(t){super(t),this.changeContent=t=>this.props.changeSelf(t),this.changeInterface=t=>s.e(617).then(s.bind(s,617)).then((e=>this.changeContent((0,h.jsx)(e.Info,{device_id:this.props.id,interface_id:t,changeSelf:this.changeContent},"interface_info")))),this.listItem=(t,e)=>[t.vlan,t.snmp_index,(0,h.jsx)(d.HrefButton,{text:t.name,onClick:()=>this.changeInterface(t.interface_id)},"fd_intf_"+t.interface_id),t.mac,t.oui],this.state={wait:null,searchfield:""}}componentDidMount(){(0,n.Cc)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((t=>this.setState(t)))}syncFDB(){this.setState({wait:(0,h.jsx)(a.Spinner,{})}),(0,n.Cc)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then((t=>"OK"===t.status&&(0,n.Cc)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((t=>this.setState({...t,wait:null})))))}render(){if(this.state.data){const t=this.state.searchfield.toUpperCase(),e=0===t.length?this.state.data:this.state.data.filter((e=>e.mac.includes(t)));return(0,h.jsxs)(a.ContentReport,{header:"FDB",thead:["VLAN","SNMP","Interface","MAC","OUI"],trows:e,listItem:this.listItem,children:[(0,h.jsx)(d.ReloadButton,{onClick:()=>this.componentDidMount()},"fd_btn_reload"),(0,h.jsx)(d.SyncButton,{onClick:()=>this.syncFDB(),title:"Resync FDB"},"fd_btn_sync"),(0,h.jsx)(o.SearchField,{searchFire:t=>this.setState({searchfield:t}),placeholder:"Search MAC"},"fd_search"),this.state.wait]},"fd_cr")}return(0,h.jsx)(a.Spinner,{})}}class c extends i.Component{constructor(t){super(t),this.changeSearch=(t,e)=>this.changeContent((0,h.jsx)(p,{mac:t},"fdb_info")),this.changeVisualize=t=>"changeSelf"in this.props&&s.e(362).then(s.bind(s,362)).then((e=>this.changeContent((0,h.jsx)(e.Edit,{type:"device",id:t},"viz_id_"+t)))),this.listItem=(t,e)=>[t.device_id,t.hostname,t.vlan,t.snmp_index,t.name,(0,h.jsx)(d.HrefButton,{text:t.mac,onClick:()=>this.setState({searchfield:t.mac})},"intf_"+e),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.InfoButton,{onClick:()=>this.changeSearch(t.mac,e),title:"Find interface(s)"},"info"),(0,h.jsx)(d.NetworkButton,{onClick:()=>this.changeVisualize(t.device_id)},"map")]})],this.state={searchfield:""}}componentDidUpdate(t){t!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Cc)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then((t=>this.setState(t)))}render(){if(this.state.data){const t=this.state.searchfield.toUpperCase(),e=0===t.length?this.state.data:this.state.data.filter((e=>e.mac.includes(t)));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(a.ContentList,{header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:e,listItem:this.listItem,children:[(0,h.jsx)(d.ReloadButton,{onClick:()=>this.componentDidMount()},"reload"),(0,h.jsx)(o.SearchField,{searchFire:t=>this.setState({searchfield:t}),placeholder:"Search MAC",text:this.state.searchfield},"search")]},"cl"),(0,h.jsx)(a.ContentData,{mountUpdate:t=>this.changeContent=t},"cda")]})}return(0,h.jsx)(a.Spinner,{})}}class p extends i.Component{constructor(t){super(t),this.state={}}componentDidUpdate(t){t!==this.props&&this.componentDidMount()}componentDidMount(){(0,n.Cc)("api/fdb/search",{mac:this.props.mac}).then((t=>this.setState(t)))}render(){return this.state.device?(0,h.jsx)(a.ContentReport,{header:`${this.state.device.hostname} (${this.state.device.id})`,thead:["ID","Interface","Description","OUI"],trows:this.state.interfaces,listItem:t=>[t.interface_id,t.name,t.description,t.oui]},"fd_cr"):this.state.oui?(0,h.jsxs)(a.LineArticle,{header:"Search result",children:["OUI: ",this.state.oui]},"fd_oui_la"):this.state.status?(0,h.jsxs)(a.LineArticle,{header:"Search result",children:["Search result: ",this.state.info]},"fd_oui_la"):(0,h.jsx)(a.Spinner,{})}}}}]);
//# sourceMappingURL=772.036feb23.chunk.js.map