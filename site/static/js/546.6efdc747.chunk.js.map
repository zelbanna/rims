{"version":3,"file":"static/js/546.6efdc747.chunk.js","mappings":"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","sources":["reservation.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { post_call } from './infra/Functions.js';\nimport { RimsContext, Spinner, InfoArticle, InfoColumns, LineArticle, ContentList, ContentData, ContentReport } from './infra/UI.jsx';\nimport { AddButton, DeleteButton, InfoButton, ReloadButton, SaveButton, SearchButton } from './infra/Buttons.jsx';\nimport { RadioInput, TextInput, TextLine }  from './infra/Inputs.jsx';\n\n// ************** List **************\n//\nexport class List extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/reservation/list').then(result => this.setState(result))\n }\n\n extendItem = (device_id,user_id,days) => {\n  post_call('api/reservation/extend',{device_id:device_id, user_id:user_id, days:days}).then(result => this.componentDidMount())\n }\n\n deleteItem = (dev,user) => (window.confirm('Remove reservation?') && post_call('api/reservation/delete',{device_id:dev, user_id:user}).then(result => {\n  if (result.deleted){\n   this.setState({data:this.state.data.filter(row => (row.device_id !== dev))});\n   this.changeContent(null);\n  }}))\n\n listItem = (row) => {\n  const buttons = (this.context.settings.id === row.user_id || !row.valid);\n  return [row.alias,row.hostname,row.end,<>\n   {buttons && <InfoButton key='info' onClick={() => { this.changeContent(<Info key={'rsv_device_'+row.device_id} device_id={row.device_id} user_id={row.user_id} />) }} title='Info'/>}\n   {buttons && <AddButton  key='ext' onClick={() => { this.extendItem(row.device_id,row.user_id,14) }} title='Extend reservation' />}\n   {buttons && <DeleteButton key='del' onClick={() => { this.deleteItem(row.device_id,row.user_id) }} title='Remove reservation' />}\n  </>]\n }\n\n render(){\n  return <>\n   <ContentList key='cl' header='Reservations' thead={['User','Device','Until','']} trows={this.state.data} listItem={this.listItem}>\n    <ReloadButton key='reload' onClick={() => this.componentDidMount() } />\n    <AddButton key='add' onClick={() => this.changeContent(<New key='rsv_new' />)} />\n   </ContentList>\n   <ContentData key='cda' mountUpdate={(fun) => this.changeContent = fun} />\n  </>\n }\n}\nList.contextType = RimsContext;\n\n// ************** Info **************\n//\nclass Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {data:null, found:true};\n }\n\n componentDidMount(){\n  post_call('api/reservation/info',{device_id:this.props.device_id}).then(result => this.setState(result))\n }\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target.value}});\n\n updateInfo = () =>  post_call('api/reservation/info',{op:'update', ...this.state.data}).then(result => this.setState(result))\n\n extendItem = (days) => {\n  post_call('api/reservation/extend',{device_id:this.state.data.device_id, user_id:this.state.data.user_id, days:days}).then(result => result.status === 'OK' && this.componentDidMount())\n }\n\n render() {\n  if (this.state.data){\n   return <InfoArticle key='rsv_article' header='Reservation'>\n     <InfoColumns key='reservation_content'>\n      <TextLine key='alias' id='alias' text={this.state.data.alias} />\n      <TextLine key='time_start' id='Start' text={this.state.data.time_start} />\n      <TextLine key='time_end' id='End' text={this.state.data.time_end} />\n      <RadioInput key='shutdown' id='shutdown' value={this.state.data.shutdown} options={[{text:'no',value:'no'},{text:'yes',value:'yes'},{text:'reset',value:'reset'}]} onChange={this.onChange} />\n      <TextInput key='info' id='info' value={this.state.data.info} onChange={this.onChange} />\n     </InfoColumns>\n     {this.state.data.user_id === this.context.settings.id && <SaveButton key='rsv_btn_save' onClick={() => this.updateInfo()} title='Save' />}\n     {this.state.data.user_id === this.context.settings.id && <AddButton key='rsv_btn_extend' onClick={() => this.extendItem(14)} title='Extend' />}\n    </InfoArticle>\n  } else\n   return <Spinner />\n }\n}\nInfo.contextType = RimsContext;\n\n// ************** Report **************\n//\nclass New extends Component {\n constructor(props){\n  super(props)\n  this.state = {device:'',device_id:undefined,matching:''}\n }\n\n onChange = (e) => {\n  this.setState({device:e.target.value});\n }\n\n findDevice = () => post_call('api/device/search',{hostname:this.state.device}).then(result => result.found && this.setState({device_id:result.data.id,matching:result.data.hostname}));\n\n reserveDevice = () => post_call('api/reservation/new',{device_id:this.state.device_id,user_id:this.context.settings.id}).then(result => result.status === 'OK' && this.setState({device:'',device_id:undefined,matching:''}));\n\n render(){\n  return <LineArticle key='rsv_art' header='New reservation'>\n   <TextInput key='device' id='device' label='Search device' onChange={this.onChange} value={this.state.device} placeholder='search' /> found <TextLine key='matching' id='matching device' text={this.state.matching} />\n   {this.state.device && <SearchButton key='rsv_btn_search' onClick={() => this.findDevice()} title='Find device' />}\n   {this.state.device_id && <AddButton key='rsv_btn_new' onClick={() => this.reserveDevice()} title='Reserve device' />}\n   </LineArticle>\n }\n}\nNew.contextType = RimsContext;\n\n// ************** Report **************\n//\nexport class Report extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/reservation/list',{extended:true}).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.alias,row.hostname,row.start,row.end,row.info]\n\n render(){\n  return <ContentReport key='rsv_cr' header='Reservations' thead={['User','Device','Start','End','Info']} trows={this.state.data} listItem={this.listItem} />\n }\n}\n"],"names":["List","Component","constructor","props","super","extendItem","device_id","user_id","days","post_call","then","result","this","componentDidMount","deleteItem","dev","user","window","confirm","deleted","setState","data","state","filter","row","changeContent","listItem","buttons","context","settings","id","valid","alias","hostname","end","_jsxs","_Fragment","children","_jsx","InfoButton","onClick","Info","title","AddButton","DeleteButton","render","ContentList","header","thead","trows","ReloadButton","New","ContentData","mountUpdate","fun","contextType","RimsContext","onChange","e","target","name","value","updateInfo","op","status","found","InfoArticle","InfoColumns","TextLine","text","time_start","time_end","RadioInput","shutdown","options","TextInput","info","SaveButton","Spinner","device","findDevice","matching","reserveDevice","undefined","LineArticle","label","placeholder","SearchButton","Report","start","extended","ContentReport"],"sourceRoot":""}