(this.webpackJsonprims=this.webpackJsonprims||[]).push([[18],{47:function(t,e,n){"use strict";n.r(e),n.d(e,"List",(function(){return f})),n.d(e,"LogShow",(function(){return g})),n.d(e,"TaskShow",(function(){return C}));var o=n(19),a=n(10),i=n(5),r=n(6),s=n(8),c=n(7),d=n(3),u=n(14),l=n(15),j=n(17),h=n(16),O=n(21),b=n(0),f=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).listItem=function(t){return[t.node,t.url,Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(O.InfoButton,{onClick:function(){return o.changeContent(Object(b.jsx)(p,{id:t.id},"node_info"))},title:"Node information"},"info"),Object(b.jsx)(O.DeleteButton,{onClick:function(){return o.deleteList(t.id)},title:"Delete node"},"del")]})]},o.deleteList=function(t){return window.confirm("Really delete node?")&&Object(u.d)("api/master/node_delete",{id:t}).then((function(e){e.deleted&&(o.setState({data:o.state.data.filter((function(e){return e.id!==t}))}),o.changeContent(null))}))},o.state={},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/master/node_list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(l.ContentList,{header:"Nodes",thead:["Node","URL",""],trows:this.state.data,listItem:this.listItem,children:[Object(b.jsx)(O.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),Object(b.jsx)(O.AddButton,{onClick:function(){return t.changeContent(Object(b.jsx)(p,{id:"new"},"node_info"))},title:"Add node"},"add")]},"cl"),Object(b.jsx)(l.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(d.Component),p=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).searchInfo=function(){return Object(u.d)("api/device/search",{node:r.state.data.node}).then((function(t){return t.found&&r.setState({data:Object(a.a)(Object(a.a)({},r.state.data),{},{hostname:t.data.hostname,device_id:t.data.id})})}))},r.onChange=function(t){return r.setState({data:Object(a.a)(Object(a.a)({},r.state.data),{},Object(o.a)({},t.target.name,t.target.value))})},r.changeContent=function(t){return r.setState({content:t})},r.updateInfo=function(){return Object(u.d)("api/master/node_info",Object(a.a)({op:"update"},r.state.data)).then((function(t){return r.setState(t)}))},r.state={data:null,found:!0},r}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(t){t!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/master/node_info",{id:this.props.id}).then((function(e){return t.setState(Object(a.a)(Object(a.a)({},e),{},{content:null}))}))}},{key:"render",value:function(){var t=this;if(this.state.found){if(this.state.data){var e=this.state.data.id,n="new"!==e;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(l.InfoArticle,{header:"Node",children:[Object(b.jsxs)(l.InfoColumns,{children:[Object(b.jsx)(h.TextInput,{id:"node",value:this.state.data.node,onChange:this.onChange},"node"),Object(b.jsx)(h.UrlInput,{id:"url",value:this.state.data.url,onChange:this.onChange},"url"),Object(b.jsx)(h.TextInput,{id:"hostname",value:this.state.data.hostname,onChange:this.onChange},"hostname")]},"ic"),Object(b.jsx)(O.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save information"},"save"),n&&!this.state.data.hostname&&Object(b.jsx)(O.SearchButton,{onClick:this.searchInfo,title:"Try to map node to device"},"search"),n&&Object(b.jsx)(O.ReloadButton,{onClick:function(){return t.changeContent(Object(b.jsx)(m,{node:t.state.data.node},"node_reload_"+e))}},"reload"),n&&Object(b.jsx)(O.LogButton,{onClick:function(){return t.changeContent(Object(b.jsx)(g,{node:t.state.data.node},"node_logs_"+e))},title:"View node logs"},"logs"),n&&Object(b.jsx)(O.DeleteButton,{onClick:function(){return t.changeContent(Object(b.jsx)(v,{node:t.state.data.node},"node_logc_"+e))},title:"Clear logs"},"logc"),n&&Object(b.jsx)(O.TimeButton,{onClick:function(){return t.changeContent(Object(b.jsx)(C,{node:t.state.data.node},"node_tasks_"+e))},title:"View node tasks"},"tasks")]},"ia_node"),Object(b.jsx)(j.NavBar,{id:"node_navigation"},"node_navigation"),this.state.content]})}return Object(b.jsx)(l.Spinner,{})}return Object(b.jsxs)(l.InfoArticle,{children:["Node with id: ",this.props.id," removed"]},"ia_node")}}]),n}(d.Component),m=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/system/reload",{},{"X-Route":this.props.node}).then((function(e){e?t.setState(e):t.setState({modules:["error reloading modules (check REST call)"]})}))}},{key:"render",value:function(){return this.state?Object(b.jsx)(l.CodeArticle,{header:"Module",children:this.state.modules.join("\n")},"nr_code"):Object(b.jsx)(l.Spinner,{})}}]),n}(d.Component),v=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/system/logs_clear",{},{"X-Route":this.props.node}).then((function(e){return t.setState({logs:e.file})}))}},{key:"render",value:function(){return this.state?Object(b.jsx)(l.CodeArticle,{header:"Cleared",children:Object.entries(this.state.logs).map((function(t){return"".concat(t[0],": ").concat(t[1])})).join("\n")},"nc_code"):Object(b.jsx)(l.Spinner,{})}}]),n}(d.Component),g=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).state={},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/system/logs_get",{},{"X-Route":this.props.node}).then((function(e){var n=e?{logs:e}:{error:!0};t.setState(n)}))}},{key:"render",value:function(){return this.state.logs?Object(b.jsx)("div",{children:Object.entries(this.state.logs).map((function(t,e){return Object(b.jsx)(l.CodeArticle,{header:t[0],children:t[1].join("\n")},e)}))}):this.state.error?Object(b.jsx)(l.CodeArticle,{children:"error retrieving logs (check REST call)"}):Object(b.jsx)(l.Spinner,{})}}]),n}(d.Component),C=function(t){Object(s.a)(n,t);var e=Object(c.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).listItem=function(t){return[t.module,t.function,t.frequency,JSON.stringify(t.output),JSON.stringify(t.args)]},o.state={},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(u.d)("api/system/task_list",{},{"X-Route":this.props.node}).then((function(e){var n=e?{tasks:e}:{error:!0};t.setState(n)}))}},{key:"render",value:function(){return this.state.tasks?Object(b.jsx)(l.ContentReport,{header:"Tasks",thead:["Module","Function","Frequency","Output","Arguments"],trows:this.state.tasks.data,listItem:this.listItem},"cr_task_show"):this.state.error?Object(b.jsx)(l.CodeArticle,{children:"error retrieving tasks (check REST call)"}):Object(b.jsx)(l.Spinner,{})}}]),n}(d.Component)}}]);
//# sourceMappingURL=18.57468ad9.chunk.js.map