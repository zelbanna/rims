{"version":3,"sources":["fdb.jsx"],"names":["Search","props","changeContent","elem","changeSelf","onChange","e","setState","target","name","value","state","field","search","key","header","id","this","placeholder","onClick","List","title","Component","Device","changeInterface","interface_id","then","lib","Info","device_id","listItem","row","idx","vlan","snmp_index","text","mac","oui","wait","searchfield","post_call","extra","result","ip","type","status","data","toUpperCase","length","filter","includes","thead","trows","componentDidMount","syncFDB","searchFire","s","changeSearch","content","changeVisualize","Edit","hostname","prevProps","device","interfaces","description","info"],"mappings":"wTAQaA,EAAb,kDACE,WAAYC,GAAO,IAAD,8BAClB,cAAMA,IAIPC,cAAgB,SAACC,GAAD,OAAU,EAAKF,MAAMG,WAAWD,IAL7B,EAOnBE,SAAW,SAACC,GAAD,OAAO,EAAKC,SAAL,eAAgBD,EAAEE,OAAOC,KAAMH,EAAEE,OAAOE,SALzD,EAAKC,MAAQ,CAACC,MAAM,MAAMC,OAAO,IAFf,EADpB,qDAUW,IAAD,OACR,OAAO,kBAAC,cAAD,CAAaC,IAAI,SAASC,OAAO,cACvC,kBAAC,cAAD,CAAaD,IAAI,QAAQE,GAAG,QAAQX,SAAUY,KAAKZ,SAAUK,MAAOO,KAAKN,MAAMC,OAC9E,4BAAQF,MAAM,OAAd,OACA,4BAAQA,MAAM,aAAd,cAED,kBAAC,YAAD,CAAWI,IAAI,SAASE,GAAG,SAASX,SAAUY,KAAKZ,SAAUK,MAAOO,KAAKN,MAAME,OAAQK,YAAY,WACnG,kBAAC,eAAD,CAAcJ,IAAI,gBAAgBK,QAAS,kBAAM,EAAKjB,cAAc,kBAACkB,EAAD,eAAMN,IAAI,YAAe,EAAKH,MAA9B,CAAqCP,WAAY,EAAKH,MAAMG,gBAAiBiB,MAAM,oBAjB1J,GAA4BC,aAwBfC,EAAb,kDACC,WAAYtB,GAAO,IAAD,8BACjB,cAAMA,IAIPC,cAAgB,SAACC,GAAD,OAAU,EAAKF,MAAMG,WAAWD,IAL9B,EAgBlBqB,gBAAkB,SAACC,GAAD,OAAkB,6BAA0BC,MAAK,SAAAC,GAAG,OAAI,EAAKzB,cAAc,kBAACyB,EAAIC,KAAL,CAAUd,IAAI,iBAAiBe,UAAW,EAAK5B,MAAMe,GAAIS,aAAcA,EAAcrB,WAAY,EAAKF,qBAhBjL,EAkBlB4B,SAAW,SAACC,EAAIC,GAAL,MAAa,CAACD,EAAIE,KAAKF,EAAIG,WAAW,kBAAC,aAAD,CAAYpB,IAAK,WAAWiB,EAAIN,aAAcU,KAAMJ,EAAItB,KAAMU,QAAS,kBAAM,EAAKK,gBAAgBO,EAAIN,iBAAkBM,EAAIK,IAAIL,EAAIM,MAhBpL,EAAK1B,MAAQ,CAAC2B,KAAK,KAAMC,YAAY,IAFpB,EADnB,gEAQqB,IAAD,OAClBC,YAAU,eAAe,CAAC5B,MAAM,YAAYC,OAAOI,KAAKhB,MAAMe,GAAIyB,MAAM,CAAC,SAASf,MAAK,SAAAgB,GAAM,OAAI,EAAKnC,SAASmC,QATjH,gCAYW,IAAD,OACRzB,KAAKV,SAAS,CAAC+B,KAAK,kBAAC,UAAD,QACpBE,YAAU,eAAe,CAACxB,GAAGC,KAAKhB,MAAMe,GAAI2B,GAAG1B,KAAKhB,MAAM0C,GAAIC,KAAK3B,KAAKhB,MAAM2C,OAAOlB,MAAK,SAAAgB,GAAM,MAAsB,OAAlBA,EAAOG,QAAmBL,YAAU,eAAe,CAAC5B,MAAM,YAAYC,OAAO,EAAKZ,MAAMe,GAAIyB,MAAM,CAAC,SAASf,MAAK,SAAAgB,GAAM,OAAI,EAAKnC,SAAL,eAAkBmC,EAAlB,CAA0BJ,KAAK,gBAdhQ,+BAqBU,IAAD,OACP,GAAIrB,KAAKN,MAAMmC,KAAM,CACpB,IAAMjC,EAASI,KAAKN,MAAM4B,YAAYQ,cAChCD,EAA0B,IAAlBjC,EAAOmC,OAAgB/B,KAAKN,MAAMmC,KAAO7B,KAAKN,MAAMmC,KAAKG,QAAO,SAAAlB,GAAG,OAAIA,EAAIK,IAAIc,SAASrC,MACtG,OAAO,kBAAC,gBAAD,CAAeC,IAAI,QAAQC,OAAO,MAAMoC,MAAO,CAAC,OAAO,OAAO,YAAY,MAAM,OAAQC,MAAON,EAAMhB,SAAUb,KAAKa,UAC1H,kBAAC,eAAD,CAAchB,IAAI,gBAAgBK,QAAS,kBAAM,EAAKkC,uBACtD,kBAAC,aAAD,CAAYvC,IAAI,cAAcK,QAAS,kBAAM,EAAKmC,WAAYjC,MAAM,eACpE,kBAAC,cAAD,CAAaP,IAAI,YAAYyC,WAAY,SAACC,GAAD,OAAO,EAAKjD,SAAS,CAACgC,YAAYiB,KAAKtC,YAAY,eAC3FD,KAAKN,MAAM2B,MAGb,OAAO,kBAAC,UAAD,UAhCV,GAA4BhB,aAsCfF,EAAb,kDACC,WAAYnB,GAAO,IAAD,8BACjB,cAAMA,IAcPwD,aAAe,SAACrB,EAAIJ,GAAL,OAAa,EAAKzB,SAAS,CAACmD,QAAQ,kBAAC9B,EAAD,CAAMd,IAAK,MAAMkB,EAAKI,IAAKA,OAf5D,EAiBlBuB,gBAAkB,SAAC9B,GAAD,MAAgB,eAAgB,EAAK5B,OAAS,6BAA0ByB,MAAK,SAAAC,GAAG,OAAI,EAAKpB,SAAS,CAACmD,QAAQ,kBAAC/B,EAAIiC,KAAL,CAAU9C,IAAK,UAAYe,EAAWe,KAAK,SAASxC,WAAY,EAAKH,MAAMG,WAAYY,GAAIa,UAjBtM,EAmBlBC,SAAW,SAACC,EAAIC,GAAL,MAAa,CAACD,EAAIF,UAAUE,EAAI8B,SAAS9B,EAAIE,KAAKF,EAAIG,WAAWH,EAAItB,KAAK,kBAAC,aAAD,CAAYK,IAAK,QAAQkB,EAAKG,KAAMJ,EAAIK,IAAKjB,QAAS,kBAAM,EAAKZ,SAAS,CAACgC,YAAYR,EAAIK,SAAU,oCACxL,kBAAC,aAAD,CAAYtB,IAAI,OAAOK,QAAS,kBAAM,EAAKsC,aAAa1B,EAAIK,IAAIJ,IAAMX,MAAM,sBAC5E,kBAAC,gBAAD,CAAeP,IAAI,MAAMK,QAAS,kBAAM,EAAKwC,gBAAgB5B,EAAIF,iBAnBlE,EAAKlB,MAAQ,CAAC4B,YAAY,GAAImB,QAAQ,MAFrB,EADnB,+DAMoBI,GACfA,IAAc7C,KAAKhB,OACrBgB,KAAKoC,sBARR,0CAYqB,IAAD,OAClBb,YAAU,eAAe,CAAC3B,OAAOI,KAAKhB,MAAMY,OAAQD,MAAMK,KAAKhB,MAAMW,MAAO6B,MAAM,CAAC,YAAY,cAAcf,MAAK,SAAAgB,GAAM,OAAI,EAAKnC,SAASmC,QAb5I,+BAyBU,IAAD,OACP,GAAIzB,KAAKN,MAAMmC,KAAK,CACnB,IAAMjC,EAASI,KAAKN,MAAM4B,YAAYQ,cAChCD,EAA0B,IAAlBjC,EAAOmC,OAAgB/B,KAAKN,MAAMmC,KAAO7B,KAAKN,MAAMmC,KAAKG,QAAO,SAAAlB,GAAG,OAAIA,EAAIK,IAAIc,SAASrC,MACtG,OAAO,oCACN,kBAAC,cAAD,CAAaC,IAAI,KAAKC,OAAO,MAAMoC,MAAO,CAAC,KAAK,WAAW,OAAO,OAAO,YAAY,MAAM,IAAKC,MAAON,EAAMhB,SAAUb,KAAKa,UAC3H,kBAAC,eAAD,CAAchB,IAAI,SAASK,QAAS,kBAAM,EAAKkC,uBAC/C,kBAAC,cAAD,CAAavC,IAAI,SAASyC,WAAY,SAACC,GAAD,OAAO,EAAKjD,SAAS,CAACgC,YAAYiB,KAAKtC,YAAY,aAAaiB,KAAMlB,KAAKN,MAAM4B,eAExH,kBAAC,cAAD,CAAazB,IAAI,MAAMG,KAAKN,MAAM+C,UAGnC,OAAO,kBAAC,UAAD,UArCV,GAA0BpC,aA2CpBM,E,kDACL,WAAY3B,GAAO,IAAD,8BACjB,cAAMA,IACDU,MAAQ,GAFI,E,gEAKE,IAAD,OAClB6B,YAAU,iBAAiB,CAACJ,IAAInB,KAAKhB,MAAMmC,MAAMV,MAAK,SAAAgB,GAAM,OAAI,EAAKnC,SAASmC,Q,+BAI9E,OAAIzB,KAAKN,MAAMoD,OACP,kBAAC,gBAAD,CAAejD,IAAI,QAAQC,OAAM,UAAKE,KAAKN,MAAMoD,OAAOF,SAAvB,aAAoC5C,KAAKN,MAAMoD,OAAO/C,GAAtD,KAA6DmC,MAAO,CAAC,KAAK,YAAY,cAAc,OAAQC,MAAOnC,KAAKN,MAAMqD,WAAYlC,SAAU,SAACC,GAAD,MAAS,CAACA,EAAIN,aAAaM,EAAItB,KAAKsB,EAAIkC,YAAYlC,EAAIM,QAC5OpB,KAAKN,MAAM0B,IACZ,kBAAC,cAAD,CAAavB,IAAI,YAAYC,OAAO,iBAApC,QAA0DE,KAAKN,MAAM0B,KACpEpB,KAAKN,MAAMkC,OACZ,kBAAC,cAAD,CAAa/B,IAAI,YAAYC,OAAO,iBAApC,kBAAoEE,KAAKN,MAAMuD,MAE/E,kBAAC,UAAD,U,GAlBS5C","file":"static/js/13.c179928d.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { post_call } from './infra/Functions.js';\nimport { Spinner, LineArticle, ContentReport, ContentList, ContentData } from './infra/UI.jsx';\nimport { TextInput, SearchInput, SelectInput } from './infra/Inputs.jsx';\nimport { HrefButton, InfoButton, NetworkButton, ReloadButton, SearchButton, SyncButton } from './infra/Buttons.jsx';\n\n// ************** Search **************\n//\nexport class Search extends Component {\n  constructor(props){\n  super(props)\n  this.state = {field:'mac',search:''}\n }\n\n changeContent = (elem) => this.props.changeSelf(elem);\n\n onChange = (e) => this.setState({[e.target.name]:e.target.value})\n\n render() {\n  return <LineArticle key='fs_art' header='FDB Search'>\n   <SelectInput key='field' id='field' onChange={this.onChange} value={this.state.field}>\n    <option value='mac'>MAC</option>\n    <option value='device_id'>Device ID</option>\n   </SelectInput>\n   <TextInput key='search' id='search' onChange={this.onChange} value={this.state.search} placeholder='search' />\n   <SearchButton key='fs_btn_search' onClick={() => this.changeContent(<List key='fdb_list' {...this.state} changeSelf={this.props.changeSelf} />)} title='Search FDB' />\n  </LineArticle>\n }\n}\n\n// *************** Device *****************\n//\nexport class Device extends Component {\n constructor(props){\n  super(props)\n  this.state = {wait:null, searchfield:''}\n }\n\n changeContent = (elem) => this.props.changeSelf(elem);\n\n componentDidMount(){\n  post_call('api/fdb/list',{field:\"device_id\",search:this.props.id, extra:['oui']}).then(result => this.setState(result))\n }\n\n syncFDB(){\n  this.setState({wait:<Spinner />})\n  post_call('api/fdb/sync',{id:this.props.id, ip:this.props.ip, type:this.props.type}).then(result => result.status === 'OK' && post_call('api/fdb/list',{field:\"device_id\",search:this.props.id, extra:['oui']}).then(result => this.setState({...result, wait:null})));\n }\n\n changeInterface = (interface_id) => import('./interface.jsx').then(lib => this.changeContent(<lib.Info key='interface_info' device_id={this.props.id} interface_id={interface_id} changeSelf={this.changeContent} />))\n\n listItem = (row,idx) => [row.vlan,row.snmp_index,<HrefButton key={'fd_intf_'+row.interface_id} text={row.name} onClick={() => this.changeInterface(row.interface_id)} />,row.mac,row.oui]\n\n render(){\n  if (this.state.data) {\n   const search = this.state.searchfield.toUpperCase();\n   const data = (search.length === 0) ? this.state.data : this.state.data.filter(row => row.mac.includes(search))\n   return <ContentReport key='fd_cr' header='FDB' thead={['VLAN','SNMP','Interface','MAC','OUI']} trows={data} listItem={this.listItem}>\n    <ReloadButton key='fd_btn_reload' onClick={() => this.componentDidMount()} />\n    <SyncButton key='fd_btn_sync' onClick={() => this.syncFDB() } title='Resync FDB' />\n    <SearchInput key='fd_search' searchFire={(s) => this.setState({searchfield:s})} placeholder='Search MAC' />\n    {this.state.wait}\n   </ContentReport>\n  } else\n   return <Spinner />\n }\n}\n\n// *************** List *****************\n//\nexport class List extends Component {\n constructor(props){\n  super(props)\n  this.state = {searchfield:'', content:null}\n }\n\n componentDidUpdate(prevProps){\n  if(prevProps !== this.props){\n   this.componentDidMount()\n  }\n }\n\n componentDidMount(){\n  post_call('api/fdb/list',{search:this.props.search, field:this.props.field, extra:['device_id','hostname']}).then(result => this.setState(result))\n }\n\n changeSearch = (mac,idx) => this.setState({content:<Info key={'fi_'+idx} mac={mac} />});\n\n changeVisualize = (device_id) => ('changeSelf' in this.props && import('./visualize.jsx').then(lib => this.setState({content:<lib.Edit key={'viz_id_' + device_id} type='device' changeSelf={this.props.changeSelf} id={device_id} />})));\n\n listItem = (row,idx) => [row.device_id,row.hostname,row.vlan,row.snmp_index,row.name,<HrefButton key={'intf_'+idx} text={row.mac} onClick={() => this.setState({searchfield:row.mac})} />,<>\n   <InfoButton key='info' onClick={() => this.changeSearch(row.mac,idx)} title='Find interface(s)' />\n   <NetworkButton key='map' onClick={() => this.changeVisualize(row.device_id)} />\n  </>]\n\n render(){\n  if (this.state.data){\n   const search = this.state.searchfield.toUpperCase();\n   const data = (search.length === 0) ? this.state.data : this.state.data.filter(row => row.mac.includes(search))\n   return <>\n    <ContentList key='cl' header='FDB' thead={['ID','Hostname','VLAN','SNMP','Interface','MAC','']} trows={data} listItem={this.listItem}>\n     <ReloadButton key='reload' onClick={() => this.componentDidMount()} />\n     <SearchInput key='search' searchFire={(s) => this.setState({searchfield:s})} placeholder='Search MAC' text={this.state.searchfield} />\n    </ContentList>\n    <ContentData key='cd'>{this.state.content}</ContentData>\n   </>\n  } else\n   return <Spinner />\n }\n}\n\n// *************** Info *****************\n//\nclass Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/fdb/search',{mac:this.props.mac}).then(result => this.setState(result))\n }\n\n render(){\n  if (this.state.device)\n   return <ContentReport key='fd_cr' header={`${this.state.device.hostname} (${this.state.device.id})`} thead={['ID','Interface','Description','OUI']} trows={this.state.interfaces} listItem={(row) => [row.interface_id,row.name,row.description,row.oui]} />\n  else if (this.state.oui)\n   return <LineArticle key='fd_oui_la' header='Search result'>OUI: {this.state.oui}</LineArticle>\n  else if (this.state.status)\n   return <LineArticle key='fd_oui_la' header='Search result'>Search result: {this.state.info}</LineArticle>\n  else\n   return <Spinner />\n }\n}\n"],"sourceRoot":""}