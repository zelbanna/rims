(this.webpackJsonprims=this.webpackJsonprims||[]).push([[10,2,24],{41:function(e,t,n){"use strict";n.r(t),n.d(t,"Main",(function(){return k})),n.d(t,"List",(function(){return y})),n.d(t,"Show",(function(){return g})),n.d(t,"Edit",(function(){return b}));var a=n(18),i=n(14),o=n(3),r=n(4),c=n(5),s=n(6),l=n(0),u=n.n(l),d=n(12),h=n(13),f=n(19),p=n(15),m=n(1),v=n.n(m),k=function(e){Object(s.a)(Main,e);var t=Object(c.a)(Main);function Main(e){var n;return Object(o.a)(this,Main),(n=t.call(this,e)).changeContent=function(e){return n.setState(e)},n.state=u.a.createElement(y,{key:"viz_list"}),n}return Object(r.a)(Main,[{key:"render",value:function render(){return u.a.createElement(l.Fragment,null,this.state)}}]),Main}(l.Component),y=function(e){Object(s.a)(List,e);var t=Object(c.a)(List);function List(e){var n;return Object(o.a)(this,List),(n=t.call(this,e)).listItem=function(e){return[e.id,e.name,u.a.createElement(l.Fragment,null,u.a.createElement(f.EditButton,{key:"vl_btn_edt_"+e.id,onClick:function onClick(){return n.changeContent(u.a.createElement(b,{key:"viz_edit_"+e.id,id:e.id,changeSelf:n.changeContent,type:"map"}))},title:"Show and edit map"}),u.a.createElement(f.NetworkButton,{key:"vl_btn_net_"+e.id,onClick:function onClick(){return window.open("viz.html?id=".concat(e.id),"_blank")},title:"Show resulting map"}),u.a.createElement(f.DeleteButton,{key:"vl_btn_del_"+e.id,onClick:function onClick(){return n.deleteList(e.id)}}))]},n.changeContent=function(e){return n.setState({content:e})},n.deleteList=function(e){return window.confirm("Delete map?")&&Object(d.d)("api/visualize/delete",{id:e}).then((function(t){return t.deleted&&n.setState({data:n.state.data.filter((function(t){return t.id!==e})),content:null})}))},n.state={},n}return Object(r.a)(List,[{key:"componentDidMount",value:function componentDidMount(){var e=this;Object(d.d)("api/visualize/list").then((function(t){e.setState(t)}))}},{key:"render",value:function render(){var e=this;return u.a.createElement(l.Fragment,null,u.a.createElement(h.ContentList,{key:"vl_cl",header:"Maps",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(f.ReloadButton,{key:"vl_btn_reload",onClick:function onClick(){return e.componentDidMount()}})),u.a.createElement(h.ContentData,{key:"vl_cd"},this.state.content))}}]),List}(l.Component),g=function(e){Object(s.a)(Show,e);var t=Object(c.a)(Show);function Show(){var e;Object(o.a)(this,Show);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).doubleClick=function(e){console.log("DoubleClick",e.nodes),e.nodes[0]&&Object(d.d)("api/device/management",{id:e.nodes[0]}).then((function(e){e&&"OK"===e.status?e.data.url&&e.data.url.length>0?window.open(e.data.url):window.open("ssh://"+e.data.username+"@"+e.data.ip,"_self"):console.log("Data not ok:"+e)}))},e}return Object(r.a)(Show,[{key:"componentDidMount",value:function componentDidMount(){var e=this,t=this.props.hasOwnProperty("id")?{id:this.props.id}:{name:this.props.name};n.e(5).then(n.bind(null,60)).then((function(n){Object(d.d)("api/visualize/show",t).then((function(t){var a=new n.DataSet(t.data.nodes),i=new n.DataSet(t.data.edges),o=new n.Network(e.refs.show_canvas,{nodes:a,edges:i},t.data.options);o.on("stabilizationIterationsDone",(function(){return o.setOptions({physics:!1})})),o.on("doubleClick",(function(t){return e.doubleClick(t)}))}))}))}},{key:"render",value:function render(){return u.a.createElement(h.Article,{key:"viz_show"},u.a.createElement("div",{className:v.a.network,id:"div_network",ref:"show_canvas"}))}}]),Show}(l.Component),b=function(e){Object(s.a)(Edit,e);var t=Object(c.a)(Edit);function Edit(e){var r;return Object(o.a)(this,Edit),(r=t.call(this,e)).changeImport=function(e){return n.e(0).then(n.bind(null,40)).then((function(t){return r.props.changeSelf(u.a.createElement(t.Info,{key:"di_"+e,id:e}))}))},r.onChange=function(e){return r.setState({data:Object(i.a)({},r.state.data,Object(a.a)({},e.target.name,e.target.value))})},r.jsonHandler=function(e){var t=Object(i.a)({},r.state.data);try{t[e.target.name]=JSON.parse(e.target.value),r.setState({data:t})}catch(n){console.log("Error converting string to JSON")}},r.updateInfo=function(){return Object(d.d)("api/visualize/network",Object(i.a)({op:"update"},r.state.data)).then((function(e){return r.setState(e)}))},r.doubleClick=function(e){console.log("DoubleClick",e.nodes[0]),r.props.changeSelf&&r.changeImport(e.nodes[0])},r.toggleEdit=function(){r.edit=!r.edit,r.viz.network.setOptions({manipulation:{enabled:r.edit}}),r.setState({result:"Edit:"+r.edit})},r.toggleFix=function(){r.viz.nodes.forEach((function(e,t){return r.viz.nodes.update({id:t,fixed:!e.fixed})})),r.setState({data:Object(i.a)({},r.state.data,{nodes:r.viz.nodes.get()}),result:"Fix/Unfix positions"})},r.togglePhysics=function(){var e=r.state.data;e.options.physics.enabled=!e.options.physics.enabled,r.viz.network.setOptions({physics:e.options.physics.enabled}),r.setState({data:e,physics_button:e.options.physics.enabled?f.StopButton:f.StartButton,result:"Physics:"+e.options.physics.enabled})},r.networkSync=function(e){r.viz.network.storePositions(),r.setState({data:Object(i.a)({},r.state.data,{nodes:r.viz.nodes.get(),edges:r.viz.edges.get()}),result:"Moved "+r.viz.nodes.get(e.nodes[0]).label})},r.showDiv=function(e){return e===r.state.content?{display:"block"}:{display:"none"}},r.state={content:"network",physics_button:f.StartButton,found:!0,data:{name:"N/A"},result:""},r.viz={network:null,nodes:null,edges:null},r.results=u.a.createRef(),r.edit=!1,r}return Object(r.a)(Edit,[{key:"componentDidMount",value:function componentDidMount(){var e=this;n.e(5).then(n.bind(null,60)).then((function(t){Object(d.d)("api/visualize/network",{id:e.props.id,type:e.props.type}).then((function(n){e.viz.nodes=new t.DataSet(n.data.nodes),e.viz.edges=new t.DataSet(n.data.edges),n.data.options.physics.enabled=!0,e.viz.network=new t.Network(e.refs.edit_canvas,{nodes:e.viz.nodes,edges:e.viz.edges},n.data.options),e.viz.network.on("stabilizationIterationsDone",(function(){return e.viz.network.setOptions({physics:!1})})),e.viz.network.on("doubleClick",(function(t){return e.doubleClick(t)})),e.viz.network.on("dragEnd",(function(t){return e.networkSync(t)})),n.data.options.physics.enabled=!1,e.setState(n)}))}))}},{key:"render",value:function render(){var e=this,t=this.state.physics_button;return u.a.createElement(h.Article,{key:"viz_art",header:"Network Map"},"device"===this.props.type&&this.props.changeSelf&&u.a.createElement(f.BackButton,{key:"viz_back",onClick:function onClick(){return e.changeImport(e.props.id)}}),u.a.createElement(f.ReloadButton,{key:"viz_reload",onClick:function onClick(){return e.componentDidMount()}}),u.a.createElement(f.EditButton,{key:"viz_edit",onClick:function onClick(){return e.toggleEdit()}}),u.a.createElement(t,{key:"viz_physics",onClick:function onClick(){return e.togglePhysics()}}),u.a.createElement(f.FixButton,{key:"viz_fix",onClick:function onClick(){return e.toggleFix()}}),u.a.createElement(f.SaveButton,{key:"viz_save",onClick:function onClick(){return e.updateInfo()}}),u.a.createElement(f.NetworkButton,{key:"viz_net",onClick:function onClick(){return e.setState({content:"network"})}}),u.a.createElement(f.TextButton,{key:"viz_opt",text:"Options",onClick:function onClick(){return e.setState({content:"options"})}}),u.a.createElement(f.TextButton,{key:"viz_nodes",text:"Nodes",onClick:function onClick(){return e.setState({content:"nodes"})}}),u.a.createElement(f.TextButton,{key:"viz_edges",text:"Edges",onClick:function onClick(){return e.setState({content:"edges"})}}),u.a.createElement(p.TextInput,{key:"viz_name",id:"name",value:this.state.data.name,onChange:this.onChange}),u.a.createElement(h.Result,{key:"viz_result",result:this.state.result}),u.a.createElement("div",{className:v.a.network,style:this.showDiv("network"),ref:"edit_canvas"}),u.a.createElement("div",{className:v.a.network,style:this.showDiv("options")},u.a.createElement("textarea",{id:"options",name:"options",value:JSON.stringify(this.state.data.options,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:v.a.network,style:this.showDiv("nodes")},u.a.createElement("textarea",{id:"nodes",name:"nodes",value:JSON.stringify(this.state.data.nodes,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:v.a.network,style:this.showDiv("edges")},u.a.createElement("textarea",{id:"edges",name:"edges",value:JSON.stringify(this.state.data.edges,void 0,2),onChange:this.jsonHandler})))}}]),Edit}(l.Component)},44:function(e,t,n){"use strict";n.r(t),n.d(t,"Search",(function(){return m})),n.d(t,"Device",(function(){return v})),n.d(t,"List",(function(){return k}));var a=n(18),i=n(3),o=n(4),r=n(5),c=n(6),s=n(0),l=n.n(s),u=n(12),d=n(13),h=n(15),f=n(19),p=n(41),m=function(e){Object(c.a)(Search,e);var t=Object(r.a)(Search);function Search(e){var n;return Object(i.a)(this,Search),(n=t.call(this,e)).changeContent=function(e){return n.props.changeSelf(e)},n.onChange=function(e){return n.setState(Object(a.a)({},e.target.name,e.target.value))},n.state={field:"mac",search:""},n}return Object(o.a)(Search,[{key:"render",value:function render(){var e=this;return l.a.createElement(d.LineArticle,{key:"fs_art",header:"FDB Search"},l.a.createElement(h.SelectInput,{key:"field",id:"field",onChange:this.onChange,value:this.state.field},l.a.createElement("option",{value:"mac"},"MAC"),l.a.createElement("option",{value:"device_id"},"Device ID")),l.a.createElement(h.TextInput,{key:"search",id:"search",onChange:this.onChange,value:this.state.search,placeholder:"search"}),l.a.createElement(f.SearchButton,{key:"fs_btn_search",onClick:function onClick(){return e.changeContent(l.a.createElement(k,Object.assign({key:"fdb_list"},e.state,{changeSelf:e.props.changeSelf})))},title:"Search FDB"}))}}]),Search}(s.Component),v=function(e){Object(c.a)(Device,e);var t=Object(r.a)(Device);function Device(e){var a;return Object(i.a)(this,Device),(a=t.call(this,e)).changeContent=function(e){return a.props.changeSelf(e)},a.changeInterface=function(e){return n.e(1).then(n.bind(null,42)).then((function(t){return a.changeContent(l.a.createElement(t.Info,{key:"interface_info",device_id:a.props.id,interface_id:e,changeSelf:a.changeContent}))}))},a.listItem=function(e,t){return[e.vlan,e.snmp_index,l.a.createElement(f.HrefButton,{key:"fd_intf_"+e.interface_id,text:e.name,onClick:function onClick(){return a.changeInterface(e.interface_id)}}),e.mac,e.oui]},a.state={wait:null,searchfield:""},a}return Object(o.a)(Device,[{key:"componentDidMount",value:function componentDidMount(){var e=this;Object(u.d)("api/fdb/list",{field:"device_id",search:this.props.id,extra:["oui"]}).then((function(t){return e.setState(t)}))}},{key:"syncFDB",value:function syncFDB(){var e=this;this.setState({wait:l.a.createElement(d.Spinner,null)}),Object(u.d)("api/fdb/sync",{id:this.props.id,ip:this.props.ip,type:this.props.type}).then((function(t){return e.setState({wait:null})}))}},{key:"render",value:function render(){var e=this;if(this.state.data){var t=this.state.searchfield.toUpperCase(),n=0===t.length?this.state.data:this.state.data.filter((function(e){return e.mac.includes(t)}));return l.a.createElement(d.ContentReport,{key:"fd_cr",header:"FDB",thead:["VLAN","SNMP","Interface","MAC","OUI"],trows:n,listItem:this.listItem},l.a.createElement(f.ReloadButton,{key:"fd_btn_reload",onClick:function onClick(){return e.componentDidMount()}}),l.a.createElement(f.SyncButton,{key:"fd_btn_sync",onClick:function onClick(){return e.syncFDB()},title:"Resync FDB"}),l.a.createElement(h.SearchInput,{key:"fd_search",searchFire:function searchFire(t){return e.setState({searchfield:t})},placeholder:"Search MAC"}),this.state.wait)}return l.a.createElement(d.Spinner,null)}}]),Device}(s.Component),k=function(e){Object(c.a)(List,e);var t=Object(r.a)(List);function List(e){var n;return Object(i.a)(this,List),(n=t.call(this,e)).changeSearch=function(e,t){return n.setState({content:l.a.createElement(y,{key:"fi_"+t,mac:e})})},n.changeVisualize=function(e){return"changeSelf"in n.props&&n.setState({content:l.a.createElement(p.Edit,{key:"viz_id_"+e,type:"device",id:e})})},n.listItem=function(e,t){return[e.device_id,e.hostname,e.vlan,e.snmp_index,e.name,l.a.createElement(f.HrefButton,{key:"fd_intf_"+t,text:e.mac,onClick:function onClick(){return n.setState({searchfield:e.mac})}}),l.a.createElement(s.Fragment,null,l.a.createElement(f.InfoButton,{key:"fd_intf_"+t,onClick:function onClick(){return n.changeSearch(e.mac,t)},title:"Find interface(s)"}),l.a.createElement(f.NetworkButton,{key:"fd_map_"+t,onClick:function onClick(){return n.changeVisualize(e.device_id)}}))]},n.state={searchfield:"",content:null},n}return Object(o.a)(List,[{key:"componentDidUpdate",value:function componentDidUpdate(e){e!==this.props&&this.componentDidMount()}},{key:"componentDidMount",value:function componentDidMount(){var e=this;Object(u.d)("api/fdb/list",{search:this.props.search,field:this.props.field,extra:["device_id","hostname"]}).then((function(t){return e.setState(t)}))}},{key:"render",value:function render(){var e=this;if(this.state.data){var t=this.state.searchfield.toUpperCase(),n=0===t.length?this.state.data:this.state.data.filter((function(e){return e.mac.includes(t)}));return l.a.createElement(s.Fragment,null,l.a.createElement(d.ContentList,{key:"fl_cr",header:"FDB",thead:["ID","Hostname","VLAN","SNMP","Interface","MAC",""],trows:n,listItem:this.listItem},l.a.createElement(f.ReloadButton,{key:"fl_btn_reload",onClick:function onClick(){return e.componentDidMount()}}),l.a.createElement(h.SearchInput,{key:"fl_search",searchFire:function searchFire(t){return e.setState({searchfield:t})},placeholder:"Search MAC",text:this.state.searchfield})),l.a.createElement(d.ContentData,{key:"fl_content"},this.state.content))}return l.a.createElement(d.Spinner,null)}}]),List}(s.Component),y=function(e){Object(c.a)(Info,e);var t=Object(r.a)(Info);function Info(e){var n;return Object(i.a)(this,Info),(n=t.call(this,e)).state={},n}return Object(o.a)(Info,[{key:"componentDidMount",value:function componentDidMount(){var e=this;Object(u.d)("api/fdb/search",{mac:this.props.mac}).then((function(t){return e.setState(t)}))}},{key:"render",value:function render(){return this.state.device?l.a.createElement(d.ContentReport,{key:"fd_cr",header:"".concat(this.state.device.hostname," (").concat(this.state.device.id,")"),thead:["ID","Interface","Description","OUI"],trows:this.state.interfaces,listItem:function listItem(e){return[e.interface_id,e.name,e.description,e.oui]}}):this.state.oui?l.a.createElement(d.LineArticle,{key:"fd_oui_la",header:"Search result"},"OUI: ",this.state.oui):this.state.status?l.a.createElement(d.LineArticle,{key:"fd_oui_la",header:"Search result"},"Search result: ",this.state.info):l.a.createElement(d.Spinner,null)}}]),Info}(s.Component)}}]);
//# sourceMappingURL=10.841945cd.chunk.js.map