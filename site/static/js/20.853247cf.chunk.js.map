{"version":3,"sources":["server.jsx"],"names":["List","props","listItem","row","node","service","type","key","id","onClick","changeContent","Info","title","deleteList","hasOwnProperty","ui","length","window","open","elem","setState","content","confirm","post_call","then","result","deleted","data","state","filter","this","prevProps","header","thead","trows","componentDidMount","rnd","Component","onChange","e","target","name","value","updateInfo","op","found","nodes","type_id","services","old","label","text","map","Operation","operation","JSON","stringify"],"mappings":"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","file":"static/js/20.853247cf.chunk.js","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport { post_call, rnd } from './infra/Functions.js';\nimport { Spinner, CodeArticle, InfoArticle, InfoColumns, ContentList, ContentData } from './infra/UI.jsx';\nimport { NavBar } from './infra/Navigation.jsx';\nimport { SelectInput, TextLine, UrlInput } from './infra/Inputs.jsx';\nimport { AddButton, CheckButton, DeleteButton, InfoButton, ReloadButton, SaveButton, SyncButton, SearchButton, UiButton } from './infra/Buttons.jsx';\n\n// ************** List **************\n//\nexport class List extends Component {\n constructor(props){\n  super(props)\n  this.state = {}\n }\n\n componentDidMount(){\n  post_call('api/master/server_list',{type:this.props.type}).then(result => this.setState(result))\n }\n\n componentDidUpdate(prevProps){\n  if(prevProps !== this.props)\n   post_call('api/master/server_list',{type:this.props.type}).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.node,row.service,row.type,<Fragment>\n   <InfoButton key={'sl_btn_info_'+row.id} onClick={() => this.changeContent(<Info key={'server_info_'+row.id} id={row.id} />)} title='Service information' />\n   <DeleteButton key={'sl_btn_delete'+row.id} onClick={() => this.deleteList(row.id)} title='Delete service' />\n   {row.hasOwnProperty('ui') && row.ui.length > 0 && <UiButton key={'sl_btn_ui'+row.id} onClick={() =>  window.open(row.ui,'_blank')} title='Server UI' />}\n  </Fragment>]\n\n changeContent = (elem) => this.setState({content:elem})\n deleteList = (id) => (window.confirm('Really delete service?') && post_call('api/master/server_delete', {id:id}).then(result => result.deleted && this.setState({data:this.state.data.filter(row => (row.id !== id)),content:null})))\n\n render(){\n  return <Fragment>\n   <ContentList key='sl_cl' header='Servers' thead={['Node','Service','Type','']} trows={this.state.data} listItem={this.listItem}>\n    <ReloadButton key='sl_btn_reload' onClick={() => this.componentDidMount()} />\n    <AddButton key='sl_btn_add' onClick={() => this.changeContent(<Info key={'sl_new_' + rnd()} id='new' type={this.props.type} />)} title='Add service' />\n   </ContentList>\n   <ContentData key='sl_cd'>{this.state.content}</ContentData>\n  </Fragment>\n }\n}\n\n// *************** Info ***************\n//\nclass Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {data:null, found:true, content:null};\n }\n\n componentDidMount(){\n  post_call('api/master/server_info',{id:this.props.id}).then(result => {\n   if (!result.data.node)\n    result.data.node = result.nodes[0];\n   if (!result.data.type_id)\n    result.data.type_id = result.services[0].id;\n   this.setState(result);\n   })\n }\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target.value}});\n\n changeContent = (elem) => this.setState({content:elem})\n\n updateInfo = () => post_call('api/master/server_info',{op:'update', ...this.state.data}).then(result => this.setState(result))\n\n render() {\n  if (!this.state.found)\n   return <InfoArticle key='si_art'>Server with id: {this.props.id} removed</InfoArticle>\n  else if (this.state.data){\n   const old = (this.state.data.id !== 'new');\n   return (\n    <Fragment>\n    <InfoArticle key='si_art' header='Server'>\n     <InfoColumns key='si_content'>\n      <TextLine key='server' id='server' label='ID' text={this.state.data.id} />\n      <SelectInput key='node' id='node' value={this.state.data.node} onChange={this.onChange}>{this.state.nodes.map(row => <option key={row} value={row}>{row}</option>)}</SelectInput>\n      <SelectInput key='type_id' id='type_id' label='Service' value={this.state.data.type_id} onChange={this.onChange}>{this.state.services.map(row => <option key={row.id} value={row.id}>{`${row.service} (${row.type})`}</option>)}</SelectInput>\n      <UrlInput key='ui' id='ui' label='UI' value={this.state.data.ui} onChange={this.onChange} />\n     </InfoColumns>\n     <SaveButton key='si_btn_save' onClick={() => this.updateInfo()} title='Save' />\n     {old && <SyncButton key='si_sync' onClick={() => this.changeContent(<Operation key={'srv_op_sync'} id={this.state.data.id} operation='sync' />)} title='Sync service' />}\n     {old && <ReloadButton key='si_restart' onClick={() => this.changeContent(<Operation key={'srv_op_rst'}  id={this.state.data.id} operation='restart' />)} title='Restart service' />}\n     {old && <SearchButton key='si_status' onClick={() => this.changeContent(<Operation key={'srv_op_stat'} id={this.state.data.id} operation='status' />)} title='Service status' />}\n     {old && <CheckButton key='si_params' onClick={() => this.changeContent(<Operation key={'srv_op_params'} id={this.state.data.id} operation='parameters' />)} title='Service parameters' />}\n    </InfoArticle>\n    <NavBar key='server_navigation' id='server_navigation' />\n    {this.state.content}\n    </Fragment>\n   );\n  } else\n   return <Spinner />\n }\n}\n\n// *************** Operation ***************\n//\nclass Operation extends Component {\n componentDidMount(){\n  post_call('api/master/server_operation',{op:this.props.operation,id:this.props.id}).then(result => this.setState(result))\n }\n\n render(){\n  return (this.state) ? <CodeArticle key='srv_operation'>{JSON.stringify(this.state,null,2)}</CodeArticle> : <Spinner />\n }\n}\n"],"sourceRoot":""}