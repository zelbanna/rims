(this.webpackJsonprims=this.webpackJsonprims||[]).push([[9,2,4,24],{41:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return v})),n.d(e,"List",(function(){return y})),n.d(e,"Show",(function(){return _})),n.d(e,"Edit",(function(){return C}));var a=n(18),o=n(14),i=n(3),r=n(4),c=n(5),l=n(6),s=n(0),u=n.n(s),d=n(12),k=n(13),f=n(19),h=n(15),m=n(1),p=n.n(m),v=function(t){Object(l.a)(Main,t);var e=Object(c.a)(Main);function Main(t){var n;return Object(i.a)(this,Main),(n=e.call(this,t)).changeContent=function(t){return n.setState(t)},n.state=u.a.createElement(y,{key:"viz_list"}),n}return Object(r.a)(Main,[{key:"render",value:function render(){return u.a.createElement(s.Fragment,null,this.state)}}]),Main}(s.Component),y=function(t){Object(l.a)(List,t);var e=Object(c.a)(List);function List(t){var n;return Object(i.a)(this,List),(n=e.call(this,t)).listItem=function(t){return[t.id,t.name,u.a.createElement(s.Fragment,null,u.a.createElement(f.EditButton,{key:"vl_btn_edt_"+t.id,onClick:function onClick(){return n.changeContent(u.a.createElement(C,{key:"viz_edit_"+t.id,id:t.id,changeSelf:n.changeContent,type:"map"}))},title:"Show and edit map"}),u.a.createElement(f.NetworkButton,{key:"vl_btn_net_"+t.id,onClick:function onClick(){return window.open("viz.html?id=".concat(t.id),"_blank")},title:"Show resulting map"}),u.a.createElement(f.DeleteButton,{key:"vl_btn_del_"+t.id,onClick:function onClick(){return n.deleteList(t.id)}}))]},n.changeContent=function(t){return n.setState({content:t})},n.deleteList=function(t){return window.confirm("Delete map?")&&Object(d.d)("api/visualize/delete",{id:t}).then((function(e){return e.deleted&&n.setState({data:n.state.data.filter((function(e){return e.id!==t})),content:null})}))},n.state={},n}return Object(r.a)(List,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/visualize/list").then((function(e){t.setState(e)}))}},{key:"render",value:function render(){var t=this;return u.a.createElement(s.Fragment,null,u.a.createElement(k.ContentList,{key:"vl_cl",header:"Maps",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(f.ReloadButton,{key:"vl_btn_reload",onClick:function onClick(){return t.componentDidMount()}})),u.a.createElement(k.ContentData,{key:"vl_cd"},this.state.content))}}]),List}(s.Component),_=function(t){Object(l.a)(Show,t);var e=Object(c.a)(Show);function Show(){var t;Object(i.a)(this,Show);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).doubleClick=function(t){console.log("DoubleClick",t.nodes),t.nodes[0]&&Object(d.d)("api/device/management",{id:t.nodes[0]}).then((function(t){t&&"OK"===t.status?t.data.url&&t.data.url.length>0?window.open(t.data.url):window.open("ssh://"+t.data.username+"@"+t.data.ip,"_self"):console.log("Data not ok:"+t)}))},t}return Object(r.a)(Show,[{key:"componentDidMount",value:function componentDidMount(){var t=this,e=this.props.hasOwnProperty("id")?{id:this.props.id}:{name:this.props.name};n.e(5).then(n.bind(null,60)).then((function(n){Object(d.d)("api/visualize/show",e).then((function(e){var a=new n.DataSet(e.data.nodes),o=new n.DataSet(e.data.edges),i=new n.Network(t.refs.show_canvas,{nodes:a,edges:o},e.data.options);i.on("stabilizationIterationsDone",(function(){return i.setOptions({physics:!1})})),i.on("doubleClick",(function(e){return t.doubleClick(e)}))}))}))}},{key:"render",value:function render(){return u.a.createElement(k.Article,{key:"viz_show"},u.a.createElement("div",{className:p.a.network,id:"div_network",ref:"show_canvas"}))}}]),Show}(s.Component),C=function(t){Object(l.a)(Edit,t);var e=Object(c.a)(Edit);function Edit(t){var r;return Object(i.a)(this,Edit),(r=e.call(this,t)).changeImport=function(t){return n.e(0).then(n.bind(null,40)).then((function(e){return r.props.changeSelf(u.a.createElement(e.Info,{key:"di_"+t,id:t}))}))},r.onChange=function(t){return r.setState({data:Object(o.a)({},r.state.data,Object(a.a)({},t.target.name,t.target.value))})},r.jsonHandler=function(t){var e=Object(o.a)({},r.state.data);try{e[t.target.name]=JSON.parse(t.target.value),r.setState({data:e})}catch(n){console.log("Error converting string to JSON")}},r.updateInfo=function(){return Object(d.d)("api/visualize/network",Object(o.a)({op:"update"},r.state.data)).then((function(t){return r.setState(t)}))},r.doubleClick=function(t){console.log("DoubleClick",t.nodes[0]),r.props.changeSelf&&r.changeImport(t.nodes[0])},r.toggleEdit=function(){r.edit=!r.edit,r.viz.network.setOptions({manipulation:{enabled:r.edit}}),r.setState({result:"Edit:"+r.edit})},r.toggleFix=function(){r.viz.nodes.forEach((function(t,e){return r.viz.nodes.update({id:e,fixed:!t.fixed})})),r.setState({data:Object(o.a)({},r.state.data,{nodes:r.viz.nodes.get()}),result:"Fix/Unfix positions"})},r.togglePhysics=function(){var t=r.state.data;t.options.physics.enabled=!t.options.physics.enabled,r.viz.network.setOptions({physics:t.options.physics.enabled}),r.setState({data:t,physics_button:t.options.physics.enabled?f.StopButton:f.StartButton,result:"Physics:"+t.options.physics.enabled})},r.networkSync=function(t){r.viz.network.storePositions(),r.setState({data:Object(o.a)({},r.state.data,{nodes:r.viz.nodes.get(),edges:r.viz.edges.get()}),result:"Moved "+r.viz.nodes.get(t.nodes[0]).label})},r.showDiv=function(t){return t===r.state.content?{display:"block"}:{display:"none"}},r.state={content:"network",physics_button:f.StartButton,found:!0,data:{name:"N/A"},result:""},r.viz={network:null,nodes:null,edges:null},r.results=u.a.createRef(),r.edit=!1,r}return Object(r.a)(Edit,[{key:"componentDidMount",value:function componentDidMount(){var t=this;n.e(5).then(n.bind(null,60)).then((function(e){Object(d.d)("api/visualize/network",{id:t.props.id,type:t.props.type}).then((function(n){t.viz.nodes=new e.DataSet(n.data.nodes),t.viz.edges=new e.DataSet(n.data.edges),n.data.options.physics.enabled=!0,t.viz.network=new e.Network(t.refs.edit_canvas,{nodes:t.viz.nodes,edges:t.viz.edges},n.data.options),t.viz.network.on("stabilizationIterationsDone",(function(){return t.viz.network.setOptions({physics:!1})})),t.viz.network.on("doubleClick",(function(e){return t.doubleClick(e)})),t.viz.network.on("dragEnd",(function(e){return t.networkSync(e)})),n.data.options.physics.enabled=!1,t.setState(n)}))}))}},{key:"render",value:function render(){var t=this,e=this.state.physics_button;return u.a.createElement(k.Article,{key:"viz_art",header:"Network Map"},"device"===this.props.type&&this.props.changeSelf&&u.a.createElement(f.BackButton,{key:"viz_back",onClick:function onClick(){return t.changeImport(t.props.id)}}),u.a.createElement(f.ReloadButton,{key:"viz_reload",onClick:function onClick(){return t.componentDidMount()}}),u.a.createElement(f.EditButton,{key:"viz_edit",onClick:function onClick(){return t.toggleEdit()}}),u.a.createElement(e,{key:"viz_physics",onClick:function onClick(){return t.togglePhysics()}}),u.a.createElement(f.FixButton,{key:"viz_fix",onClick:function onClick(){return t.toggleFix()}}),u.a.createElement(f.SaveButton,{key:"viz_save",onClick:function onClick(){return t.updateInfo()}}),u.a.createElement(f.NetworkButton,{key:"viz_net",onClick:function onClick(){return t.setState({content:"network"})}}),u.a.createElement(f.TextButton,{key:"viz_opt",text:"Options",onClick:function onClick(){return t.setState({content:"options"})}}),u.a.createElement(f.TextButton,{key:"viz_nodes",text:"Nodes",onClick:function onClick(){return t.setState({content:"nodes"})}}),u.a.createElement(f.TextButton,{key:"viz_edges",text:"Edges",onClick:function onClick(){return t.setState({content:"edges"})}}),u.a.createElement(h.TextInput,{key:"viz_name",id:"name",value:this.state.data.name,onChange:this.onChange}),u.a.createElement(k.Result,{key:"viz_result",result:this.state.result}),u.a.createElement("div",{className:p.a.network,style:this.showDiv("network"),ref:"edit_canvas"}),u.a.createElement("div",{className:p.a.network,style:this.showDiv("options")},u.a.createElement("textarea",{id:"options",name:"options",value:JSON.stringify(this.state.data.options,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:p.a.network,style:this.showDiv("nodes")},u.a.createElement("textarea",{id:"nodes",name:"nodes",value:JSON.stringify(this.state.data.nodes,void 0,2),onChange:this.jsonHandler})),u.a.createElement("div",{className:p.a.network,style:this.showDiv("edges")},u.a.createElement("textarea",{id:"edges",name:"edges",value:JSON.stringify(this.state.data.edges,void 0,2),onChange:this.jsonHandler})))}}]),Edit}(s.Component)},43:function(t,e,n){"use strict";n.r(e),n.d(e,"List",(function(){return m})),n.d(e,"Info",(function(){return p}));var a=n(18),o=n(14),i=n(3),r=n(4),c=n(5),l=n(6),s=n(0),u=n.n(s),d=n(12),k=n(13),f=n(19),h=n(15),m=function(t){Object(l.a)(List,t);var e=Object(c.a)(List);function List(t){var n;return Object(i.a)(this,List),(n=e.call(this,t)).changeContent=function(t){return n.setState({content:t})},n.deleteList=function(t){return window.confirm("Really delete location?")&&Object(d.d)("api/location/delete",{id:t}).then((function(e){return e.deleted&&n.setState({data:n.state.data.filter((function(e){return e.id!==t})),content:null})}))},n.listItem=function(t){return[t.id,t.name,u.a.createElement(s.Fragment,null,u.a.createElement(f.ConfigureButton,{key:"loc_btn_info_"+t.id,onClick:function onClick(){return n.changeContent(u.a.createElement(p,{key:"location_"+t.id,id:t.id}))},title:"Edit location"}),u.a.createElement(f.DeleteButton,{key:"loc_btn_delete_"+t.id,onClick:function onClick(){return n.deleteList(t.id)},title:"Delete location"}))]},n.state={},n}return Object(r.a)(List,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/location/list").then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return u.a.createElement(s.Fragment,null,u.a.createElement(k.ContentList,{key:"loc_cl",header:"Locations",thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(f.ReloadButton,{key:"loc_btn_reload",onClick:function onClick(){return t.componentDidMount()}}),u.a.createElement(f.AddButton,{key:"loc_btn_add",onClick:function onClick(){return t.changeContent(u.a.createElement(p,{key:"location_new_"+Object(d.e)(),id:"new"}))},title:"Add location"})),u.a.createElement(k.ContentData,{key:"loc_cd"},this.state.content))}}]),List}(s.Component),p=function(t){Object(l.a)(Info,t);var e=Object(c.a)(Info);function Info(t){var n;return Object(i.a)(this,Info),(n=e.call(this,t)).onChange=function(t){return n.setState({data:Object(o.a)({},n.state.data,Object(a.a)({},t.target.name,t.target.value))})},n.changeContent=function(t){return n.setState({content:t})},n.updateInfo=function(){return Object(d.d)("api/location/info",Object(o.a)({op:"update"},n.state.data)).then((function(t){return n.setState(t)}))},n.state={data:null,found:!0},n}return Object(r.a)(Info,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/location/info",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return this.state.found?this.state.data?u.a.createElement(k.InfoArticle,{key:"loc_article",header:"Location"},u.a.createElement(k.InfoColumns,{key:"loc_content"},u.a.createElement(h.TextInput,{key:"name",id:"name",value:this.state.data.name,onChange:this.onChange})),u.a.createElement(f.SaveButton,{key:"loc_btn_save",onClick:function onClick(){return t.updateInfo()},title:"Save"})):u.a.createElement(k.Spinner,null):u.a.createElement(k.InfoArticle,{key:"loc_removed"},"Location id: ",this.props.id," removed")}}]),Info}(s.Component)},54:function(t,e,n){"use strict";n.r(e),n.d(e,"Main",(function(){return C})),n.d(e,"List",(function(){return g})),n.d(e,"Layout",(function(){return E})),n.d(e,"Infra",(function(){return O}));var a=n(18),o=n(14),i=n(3),r=n(4),c=n(5),l=n(6),s=n(0),u=n.n(s),d=n(12),k=n(13),f=n(15),h=n(19),m=n(16),p=n(61),v=n.n(p),y=n(40),_=n(43),C=function(t){Object(l.a)(Main,t);var e=Object(c.a)(Main);function Main(t){var n;return Object(i.a)(this,Main),(n=e.call(this,t)).compileNavItems=function(){return n.context.loadNavigation(u.a.createElement(m.NavBar,{key:"rack_navbar"},u.a.createElement(m.NavDropDown,{key:"dev_nav_racks",title:"Rack"},u.a.createElement(m.NavDropButton,{key:"dev_nav_all_rack",title:"Racks",onClick:function onClick(){return n.changeContent(u.a.createElement(g,{key:"rack_list"}))}}),u.a.createElement(m.NavDropButton,{key:"dev_nav_all_pdu",title:"PDUs",onClick:function onClick(){return n.changeContent(u.a.createElement(O,{key:"pdu_list",type:"pdu"}))}}),u.a.createElement(m.NavDropButton,{key:"dev_nav_all_con",title:"Consoles",onClick:function onClick(){return n.changeContent(u.a.createElement(O,{key:"console_list",type:"console"}))}})),u.a.createElement(m.NavButton,{key:"dev_nav_loc",title:"Locations",onClick:function onClick(){return n.changeContent(u.a.createElement(_.List,{key:"location_list"}))}})))},n.changeContent=function(t){return n.setState(t)},n.state=u.a.createElement(g,{key:"rack_list"}),n}return Object(r.a)(Main,[{key:"componentDidMount",value:function componentDidMount(){this.compileNavItems()}},{key:"componentDidUpdate",value:function componentDidUpdate(t){t!==this.props&&this.compileNavItems()}},{key:"render",value:function render(){return u.a.createElement(s.Fragment,null,this.state)}}]),Main}(s.Component);C.contextType=k.RimsContext;var g=function(t){Object(l.a)(List,t);var e=Object(c.a)(List);function List(t){var n;return Object(i.a)(this,List),(n=e.call(this,t)).listItem=function(t){return[u.a.createElement(h.HrefButton,{key:"rl_btn_loc_"+t.id,text:t.location,onClick:function onClick(){return n.changeContent(u.a.createElement(_.Info,{key:"li_"+t.location_id,id:t.location_id}))}}),t.name,u.a.createElement(s.Fragment,null,u.a.createElement(h.InfoButton,{key:"rl_btn_info_"+t.id,onClick:function onClick(){return n.changeContent(u.a.createElement(b,{key:"rack_info_"+t.id,id:t.id}))},title:"Rack information"}),u.a.createElement(h.GoButton,{key:"rl_btn_go_"+t.id,onClick:function onClick(){return n.context.changeMain(u.a.createElement(y.Main,{key:"rack_device_"+t.id,rack_id:t.id}))},title:"Rack inventory"}),u.a.createElement(h.ItemsButton,{key:"rl_btn_list_"+t.id,onClick:function onClick(){return n.changeContent(u.a.createElement(E,{key:"rack_layout_"+t.id,id:t.id,changeSelf:n.changeContent}))},title:"Rack layout"}),u.a.createElement(h.DeleteButton,{key:"rl_btn_del_"+t.id,onClick:function onClick(){return n.deleteList(t.id)},title:"Delete rack"}))]},n.changeContent=function(t){return n.setState({content:t})},n.deleteList=function(t){return window.confirm("Really delete rack?")&&Object(d.d)("api/rack/delete",{id:t}).then((function(e){return e.deleted&&n.setState({data:n.state.data.filter((function(e){return e.id!==t})),content:null})}))},n.state={},n}return Object(r.a)(List,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/rack/list",{sort:"name"}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return u.a.createElement(s.Fragment,null,u.a.createElement(k.ContentList,{key:"rack_cl",header:"Racks",thead:["Location","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(h.ReloadButton,{key:"rl_btn_reload",onClick:function onClick(){return t.componentDidMount()}}),u.a.createElement(h.AddButton,{key:"rl_btn_add",onClick:function onClick(){return t.changeContent(u.a.createElement(b,{key:"rack_new_"+Object(d.e)(),id:"new"}))},title:"Add rack"})),u.a.createElement(k.ContentData,{key:"rack_cd"},this.state.content))}}]),List}(s.Component);g.contextType=k.RimsContext;var b=function(t){Object(l.a)(Info,t);var e=Object(c.a)(Info);function Info(t){var n;return Object(i.a)(this,Info),(n=e.call(this,t)).onChange=function(t){return n.setState({data:Object(o.a)({},n.state.data,Object(a.a)({},t.target.name,t.target.value))})},n.updateInfo=function(){return Object(d.d)("api/rack/info",Object(o.a)({op:"update"},n.state.data)).then((function(t){return n.setState(t)}))},n.state={data:null,found:!0},n}return Object(r.a)(Info,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/rack/info",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return this.state.data?u.a.createElement(k.InfoArticle,{key:"rack_article",header:"Rack"},u.a.createElement(k.InfoColumns,{key:"rack_content"},u.a.createElement(f.TextInput,{key:"name",id:"name",value:this.state.data.name,onChange:this.onChange}),u.a.createElement(f.TextInput,{key:"size",id:"size",value:this.state.data.size,onChange:this.onChange}),u.a.createElement(f.SelectInput,{key:"console",id:"console",value:this.state.data.console,onChange:this.onChange},this.state.consoles.map((function(t){return u.a.createElement("option",{key:t.id,value:t.id},t.hostname)}))),u.a.createElement(f.SelectInput,{key:"location_id",id:"location_id",label:"Location",value:this.state.data.location_id,onChange:this.onChange},this.state.locations.map((function(t){return u.a.createElement("option",{key:t.id,value:t.id},t.name)}))),u.a.createElement(f.SelectInput,{key:"pdu_1",id:"pdu_1",label:"PDU1",value:this.state.data.pdu_1,onChange:this.onChange},this.state.pdus.map((function(t){return u.a.createElement("option",{key:t.id,value:t.id},t.hostname)}))),u.a.createElement(f.SelectInput,{key:"pdu_2",id:"pdu_2",label:"PDU2",value:this.state.data.pdu_2,onChange:this.onChange},this.state.pdus.map((function(t){return u.a.createElement("option",{key:t.id,value:t.id},t.hostname)})))),u.a.createElement(h.SaveButton,{key:"ri_btn_save",onClick:function onClick(){return t.updateInfo()},title:"Save"})):u.a.createElement(k.Spinner,null)}}]),Info}(s.Component),E=function(t){Object(l.a)(Layout,t);var e=Object(c.a)(Layout);function Layout(t){var n;return Object(i.a)(this,Layout),(n=e.call(this,t)).changeContent=function(t){n.props.changeSelf&&n.props.changeSelf(t)},n.state={},n}return Object(r.a)(Layout,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/rack/devices",{id:this.props.id}).then((function(e){return t.setState(e)}))}},{key:"createRack",value:function createRack(t,e,n){for(var a=this,o=[],i=1;i<this.state.size+1;i++)o.push(u.a.createElement("div",{key:t+"_left_"+i,className:v.a.rackLeft,style:{gridRow:-i}},i),u.a.createElement("div",{key:t+"_right_"+i,className:v.a.rackRight,style:{gridRow:-i}},i));return e.forEach((function(t){return o.push(u.a.createElement("div",{key:"rd_"+t.id,className:v.a.rackItem,style:{gridRowStart:a.state.size+2-n*t.rack_unit,gridRowEnd:a.state.size+2-(n*t.rack_unit+t.rack_size)}},u.a.createElement(h.HrefButton,{key:"rd_btn_"+t.id,style:{color:"var(--ui-txt-color)"},onClick:function onClick(){return a.changeContent(u.a.createElement(y.Info,{key:"device_info",id:t.id}))},text:t.hostname})))})),u.a.createElement("div",{className:v.a.rack,style:{grid:"repeat(".concat(this.state.size-1,", 2vw)/2vw 25vw 2vw")}},o)}},{key:"render",value:function render(){return this.state.size?u.a.createElement(s.Fragment,null,u.a.createElement(k.InfoArticle,{key:"rl_front",header:"Front"},this.createRack("front",this.state.front,1)),u.a.createElement(k.InfoArticle,{key:"rl_back",header:"Back"},this.createRack("back",this.state.back,-1))):u.a.createElement(k.Spinner,null)}}]),Layout}(s.Component),O=function(t){Object(l.a)(Infra,t);var e=Object(c.a)(Infra);function Infra(t){var n;return Object(i.a)(this,Infra),(n=e.call(this,t)).listItem=function(t){return[u.a.createElement(h.HrefButton,{key:"rinfra_dev_"+t.id,text:t.id,onClick:function onClick(){return n.changeContent(u.a.createElement(y.Info,{key:"device_"+t.id,id:t.id}))},title:"Device info"}),t.hostname,u.a.createElement(h.InfoButton,{key:"rinfra_btn_"+t.id,onClick:function onClick(){return n.context.changeMain({module:t.type_base,function:"Manage",args:{device_id:t.id,type:t.type_name}})},title:"Manage device"})]},n.changeContent=function(t){return n.setState({content:t})},n.state={},n}return Object(r.a)(Infra,[{key:"componentDidMount",value:function componentDidMount(){var t=this;Object(d.d)("api/device/list",{field:"base",search:this.props.type,extra:["type"]}).then((function(e){return t.setState(e)}))}},{key:"render",value:function render(){var t=this;return u.a.createElement(s.Fragment,null,u.a.createElement(k.ContentList,{key:"rinfra_cl",header:this.props.type,thead:["ID","Name",""],trows:this.state.data,listItem:this.listItem},u.a.createElement(h.ReloadButton,{key:"rinfra_btn_reload",onClick:function onClick(){return t.componentDidMount()}})),u.a.createElement(k.ContentData,{key:"rinfra_cd"},this.state.content))}}]),Infra}(s.Component);O.contextType=k.RimsContext},61:function(t,e,n){t.exports={rack:"rack_rack__2xnnq",rackLeft:"rack_rackLeft__1E8o9",rackRight:"rack_rackRight__1Jn29",rackItem:"rack_rackItem__2yVLG"}}}]);
//# sourceMappingURL=9.1443d83a.chunk.js.map