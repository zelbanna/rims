"use strict";(self.webpackChunkrims_frontend=self.webpackChunkrims_frontend||[]).push([[905],{905:function(t,e,n){n.r(e),n.d(e,{List:function(){return x},Report:function(){return p}});var i=n(942),a=n(413),s=n(671),r=n(144),o=n(340),d=n(882),u=n(791),c=n(252),v=n(885),h=n(682),l=n(698),f=n(184),x=function(t){(0,o.Z)(n,t);var e=(0,d.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,t)).extendItem=function(t,e,n){(0,c.Fh)("api/reservation/extend",{device_id:t,user_id:e,days:n}).then((function(t){return i.componentDidMount()}))},i.deleteItem=function(t,e){return window.confirm("Remove reservation?")&&(0,c.Fh)("api/reservation/delete",{device_id:t,user_id:e}).then((function(e){e.deleted&&(i.setState({data:i.state.data.filter((function(e){return e.device_id!==t}))}),i.changeContent(null))}))},i.listItem=function(t){var e=i.context.settings.id===t.user_id||!t.valid;return[t.alias,t.hostname,t.end,(0,f.jsxs)(f.Fragment,{children:[e&&(0,f.jsx)(h.InfoButton,{onClick:function(){i.changeContent((0,f.jsx)(_,{device_id:t.device_id,user_id:t.user_id},"rsv_device_"+t.device_id))},title:"Info"},"info"),e&&(0,f.jsx)(h.AddButton,{onClick:function(){i.extendItem(t.device_id,t.user_id,14)},title:"Extend reservation"},"ext"),e&&(0,f.jsx)(h.DeleteButton,{onClick:function(){i.deleteItem(t.device_id,t.user_id)},title:"Remove reservation"},"del")]})]},i.state={},i}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,c.Fh)("api/reservation/list").then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(v.ContentList,{header:"Reservations",thead:["User","Device","Until",""],trows:this.state.data,listItem:this.listItem,children:[(0,f.jsx)(h.ReloadButton,{onClick:function(){return t.componentDidMount()}},"reload"),(0,f.jsx)(h.AddButton,{onClick:function(){return t.changeContent((0,f.jsx)(m,{},"rsv_new"))}},"add")]},"cl"),(0,f.jsx)(v.ContentData,{mountUpdate:function(e){return t.changeContent=e}},"cda")]})}}]),n}(u.Component);x.contextType=v.RimsContext;var _=function(t){(0,o.Z)(n,t);var e=(0,d.Z)(n);function n(t){var r;return(0,s.Z)(this,n),(r=e.call(this,t)).onChange=function(t){return r.setState({data:(0,a.Z)((0,a.Z)({},r.state.data),{},(0,i.Z)({},t.target.name,t.target.value))})},r.updateInfo=function(){return(0,c.Fh)("api/reservation/info",(0,a.Z)({op:"update"},r.state.data)).then((function(t){return r.setState(t)}))},r.extendItem=function(t){(0,c.Fh)("api/reservation/extend",{device_id:r.state.data.device_id,user_id:r.state.data.user_id,days:t}).then((function(t){return"OK"===t.status&&r.componentDidMount()}))},r.state={data:null,found:!0},r}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,c.Fh)("api/reservation/info",{device_id:this.props.device_id}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){var t=this;return this.state.data?(0,f.jsxs)(v.InfoArticle,{header:"Reservation",children:[(0,f.jsxs)(v.InfoColumns,{children:[(0,f.jsx)(l.TextLine,{id:"alias",text:this.state.data.alias},"alias"),(0,f.jsx)(l.TextLine,{id:"Start",text:this.state.data.time_start},"time_start"),(0,f.jsx)(l.TextLine,{id:"End",text:this.state.data.time_end},"time_end"),(0,f.jsx)(l.RadioInput,{id:"shutdown",value:this.state.data.shutdown,options:[{text:"no",value:"no"},{text:"yes",value:"yes"},{text:"reset",value:"reset"}],onChange:this.onChange},"shutdown"),(0,f.jsx)(l.TextInput,{id:"info",value:this.state.data.info,onChange:this.onChange},"info")]},"reservation_content"),this.state.data.user_id===this.context.settings.id&&(0,f.jsx)(h.SaveButton,{onClick:function(){return t.updateInfo()},title:"Save"},"rsv_btn_save"),this.state.data.user_id===this.context.settings.id&&(0,f.jsx)(h.AddButton,{onClick:function(){return t.extendItem(14)},title:"Extend"},"rsv_btn_extend")]},"rsv_article"):(0,f.jsx)(v.Spinner,{})}}]),n}(u.Component);_.contextType=v.RimsContext;var m=function(t){(0,o.Z)(n,t);var e=(0,d.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,t)).onChange=function(t){i.setState({device:t.target.value})},i.findDevice=function(){return(0,c.Fh)("api/device/search",{hostname:i.state.device}).then((function(t){return t.found&&i.setState({device_id:t.data.id,matching:t.data.hostname})}))},i.reserveDevice=function(){return(0,c.Fh)("api/reservation/new",{device_id:i.state.device_id,user_id:i.context.settings.id}).then((function(t){return"OK"===t.status&&i.setState({device:"",device_id:void 0,matching:""})}))},i.state={device:"",device_id:void 0,matching:""},i}return(0,r.Z)(n,[{key:"render",value:function(){var t=this;return(0,f.jsxs)(v.LineArticle,{header:"New reservation",children:[(0,f.jsx)(l.TextInput,{id:"device",label:"Search device",onChange:this.onChange,value:this.state.device,placeholder:"search"},"device")," found ",(0,f.jsx)(l.TextLine,{id:"matching device",text:this.state.matching},"matching"),this.state.device&&(0,f.jsx)(h.SearchButton,{onClick:function(){return t.findDevice()},title:"Find device"},"rsv_btn_search"),this.state.device_id&&(0,f.jsx)(h.AddButton,{onClick:function(){return t.reserveDevice()},title:"Reserve device"},"rsv_btn_new")]},"rsv_art")}}]),n}(u.Component);m.contextType=v.RimsContext;var p=function(t){(0,o.Z)(n,t);var e=(0,d.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,t)).listItem=function(t){return[t.alias,t.hostname,t.start,t.end,t.info]},i.state={},i}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,c.Fh)("api/reservation/list",{extended:!0}).then((function(e){return t.setState(e)}))}},{key:"render",value:function(){return(0,f.jsx)(v.ContentReport,{header:"Reservations",thead:["User","Device","Start","End","Info"],trows:this.state.data,listItem:this.listItem},"rsv_cr")}}]),n}(u.Component)}}]);
//# sourceMappingURL=905.39d3c73d.chunk.js.map