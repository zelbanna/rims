(this.webpackJsonprims=this.webpackJsonprims||[]).push([[17],{41:function(e,t,n){"use strict";n.r(t),n.d(t,"List",(function(){return _})),n.d(t,"Report",(function(){return p}));var a=n(9),i=n(13),r=n(3),o=n(4),s=n(6),c=n(5),u=n(7),d=n(0),l=n.n(d),v=n(8),m=n(1),h=n(2),f=n(10),_=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).extendItem=function(e,t,a){Object(v.b)("api/reservation/update",{op:"extend",device_id:e,user_id:t,days:a}).then((function(e){return n.componentDidMount()}))},n.changeContent=function(e){return n.setState({content:e})},n.deleteItem=function(e,t){return window.confirm("Remove reservation?")&&Object(v.b)("api/reservation/update",{op:"delete",device_id:e,user_id:t}).then((function(t){return t.result&&n.setState({data:n.state.data.filter((function(t){return t.device_id!==e})),content:null})}))},n.listItem=function(e){var t=n.context.cookie.id===e.user_id||!e.valid;return[e.alias,e.hostname,l.a.createElement("span",{className:e.valid?"":"orange"},e.end),l.a.createElement(d.Fragment,{key:"reservation_buttons"},t&&l.a.createElement(h.InfoButton,{key:"rsv_btn_info_"+e.device_id,onClick:function(){n.changeContent(l.a.createElement(b,{key:"rsv_device_"+e.device_id,device_id:e.device_id,user_id:e.user_id}))},title:"Info"}),t&&l.a.createElement(h.AddButton,{key:"rsv_btn_ext_"+e.device_id,onClick:function(){n.extendItem(e.device_id,e.user_id,14)},title:"Extend reservation"}),t&&l.a.createElement(h.DeleteButton,{key:"rsv_btn_del_"+e.device_id,onClick:function(){n.deleteItem(e.device_id,e.user_id)},title:"Remove reservation"}))]},n.state={},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(v.b)("api/reservation/list").then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;return l.a.createElement(d.Fragment,{key:"rsv_fragment"},l.a.createElement(m.ContentList,{key:"rsv_cl",header:"Reservations",thead:["User","Device","Until",""],trows:this.state.data,listItem:this.listItem},l.a.createElement(h.ReloadButton,{key:"rsv_btn_reload",onClick:function(){return e.componentDidMount()}})),l.a.createElement(m.ContentData,{key:"rsv_cd"},this.state.content))}}]),t}(d.Component);_.contextType=m.RimsContext;var b=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).onChange=function(e){return n.setState({data:Object(i.a)({},n.state.data,Object(a.a)({},e.target.name,e.target.value))})},n.updateInfo=function(){return Object(v.b)("api/reservation/info",Object(i.a)({op:"update"},n.state.data)).then((function(e){return n.setState(e)}))},n.state={data:null,found:!0},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(v.b)("api/reservation/info",{device_id:this.props.device_id}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;return this.state.data?l.a.createElement("article",{className:"info"},l.a.createElement("h1",null,"Reservation"),l.a.createElement(m.InfoColumns,{key:"reservation_content"},l.a.createElement(f.TextLine,{key:"alias",id:"alias",text:this.state.data.alias}),l.a.createElement(f.TextLine,{key:"time_start",id:"Start",text:this.state.data.time_start}),l.a.createElement(f.TextLine,{key:"time_end",id:"End",text:this.state.data.time_end}),l.a.createElement(f.RadioInput,{key:"shutdown",id:"shutdown",value:this.state.data.shutdown,options:[{text:"no",value:0},{text:"yes",value:1},{text:"reset",value:2}],onChange:this.onChange}),l.a.createElement(f.TextInput,{key:"info",id:"info",value:this.state.data.info,onChange:this.onChange})),l.a.createElement(h.SaveButton,{key:"rsv_btn_save",onClick:function(){return e.updateInfo()},title:"Save"})):l.a.createElement(m.Spinner,null)}}]),t}(d.Component),p=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).listItem=function(e){return[e.alias,e.hostname,e.start,e.end,e.info]},n.state={},n}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(v.b)("api/reservation/list",{extended:!0}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){return l.a.createElement(m.ContentReport,{key:"rsv_cr",header:"Reservations",thead:["User","Device","Start","End","Info"],trows:this.state.data,listItem:this.listItem})}}]),t}(d.Component)}}]);
//# sourceMappingURL=17.f9572e26.chunk.js.map