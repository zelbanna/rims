(this.webpackJsonprims=this.webpackJsonprims||[]).push([[10],{40:function(e,t,n){"use strict";n.r(t),n.d(t,"Main",(function(){return y})),n.d(t,"DomainList",(function(){return k}));var a=n(21),i=n(19),r=n(16),o=n(4),c=n(5),s=n(7),d=n(6),u=n(8),l=n(0),h=n.n(l),m=n(13),f=n(14),p=n(15),_=n(20),y=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).changeContent=function(e){return n.setState(e)},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState(h.a.createElement(k,{key:"domain_list"}))}},{key:"render",value:function(){return h.a.createElement(l.Fragment,{key:"main_base"},this.state)}}]),t}(l.Component),k=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).listItem=function(e){return[e.id,e.name,e.service,h.a.createElement(l.Fragment,{key:"domain_buttons_"+e.id},h.a.createElement(_.ConfigureButton,{key:"net_info_"+e.id,onClick:function(){return n.changeContent(h.a.createElement(v,{key:"domain_"+e.id,id:e.id}))},title:"Edit domain information"}),h.a.createElement(_.ItemsButton,{key:"net_items_"+e.id,onClick:function(){return n.changeContent(h.a.createElement(C,{changeSelf:n.changeContent,key:"items_"+e.id,domain_id:e.id}))},title:"View domain records"}),h.a.createElement(_.DeleteButton,{key:"net_delete_"+e.id,onClick:function(){return n.deleteList(e.id)},title:"Delete domain"}))]},n.changeContent=function(e){return n.setState({content:e})},n.deleteList=function(e){return window.confirm("Really delete domain")&&Object(m.c)("api/dns/domain_delete",{id:e}).then((function(t){return t.deleted&&n.setState({data:n.state.data.filter((function(t){return t.id!==e})),content:null})}))},n.state={},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.c)("api/dns/domain_list").then((function(t){t.result="OK",e.setState(t)}))}},{key:"syncDomains",value:function(){var e=this;Object(m.c)("api/dns/domain_list",{sync:!0}).then((function(t){t.result=JSON.stringify(t.result),e.setState(t)}))}},{key:"render",value:function(){var e=this;return h.a.createElement(l.Fragment,{key:"dl_fragment"},h.a.createElement(f.ContentList,{key:"dl_cl",header:"Domains",thead:["ID","Domain","Server",""],trows:this.state.data,listItem:this.listItem,result:this.state.result},h.a.createElement(_.ReloadButton,{key:"dl_btn_reload",onClick:function(){return e.componentDidMount()}}),h.a.createElement(_.AddButton,{key:"dl_btn_add",onClick:function(){return e.changeContent(h.a.createElement(v,{key:"domain_new_"+Object(m.d)(),id:"new"}))},title:"Add domain"}),h.a.createElement(_.SyncButton,{key:"dl_btn_sync",onClick:function(){return e.syncDomains()},title:"Sync external DNS servers with cache"}),h.a.createElement(_.LogButton,{key:"dl_btn_document",onClick:function(){return e.changeContent(h.a.createElement(b,{key:"domain_status"}))},title:"View DNS statistics"})),h.a.createElement(f.ContentData,{key:"dl_cd"},this.state.content))}}]),t}(l.Component),v=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).onChange=function(e){return n.setState({data:Object(r.a)({},n.state.data,Object(i.a)({},e.target.name,e.target.value))})},n.changeContent=function(e){return n.setState({content:e})},n.updateInfo=function(){return Object(m.c)("api/dns/domain_info",Object(r.a)({op:"update"},n.state.data)).then((function(e){return n.setState(e)}))},n.state={data:null,found:!0},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.c)("api/dns/domain_info",{id:this.props.id}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;if(this.state.found){if(this.state.data){var t="new"!==this.state.data.id;return h.a.createElement(f.InfoArticle,{key:"dom_art",header:"Domain"},h.a.createElement(f.InfoColumns,{key:"domain_content"},t&&h.a.createElement(p.TextLine,{key:"node",id:"node",text:this.state.infra.node}),t&&h.a.createElement(p.TextLine,{key:"service",id:"service",text:this.state.infra.service}),t&&h.a.createElement(p.TextLine,{key:"foreign_id",id:"foreign_id",label:"Foreign ID",text:this.state.infra.foreign_id}),!t&&h.a.createElement(p.SelectInput,{key:"server_id",id:"server_id",label:"Server",value:this.state.data.server_id,onChange:this.onChange},this.state.servers.map((function(e,t){return h.a.createElement("option",{key:"srv_"+t,value:e.id},"".concat(e.service,"@").concat(e.node))}))),h.a.createElement(p.TextInput,{key:"name",id:"name",value:this.state.data.name,onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"master",id:"master",value:this.state.data.master,onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"type",id:"type",value:this.state.data.type,onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"notified_serial",id:"notified_serial",label:"Notified Serial",value:this.state.data.notified_serial,onChange:this.onChange})),h.a.createElement(_.SaveButton,{key:"domain_save",onClick:function(){return e.updateInfo()},title:"Save domain information"}))}return h.a.createElement(f.Spinner,null)}return h.a.createElement(f.InfoArticle,{key:"dom_art"},"Domain with id: ",this.props.id," removed")}}]),t}(l.Component),b=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.c)("api/dns/status").then((function(t){for(var n=[],i=function(){var e=Object(a.a)(o[r],2),t=e[0],i=e[1],c=t.split("_");i.forEach((function(e){return n.push([c[0],c[1],e.count,e.fqdn])}))},r=0,o=Object.entries(t.top);r<o.length;r++)i();for(var c=[],s=function(){var e=Object(a.a)(u[d],2),t=e[0],n=e[1],i=t.split("_");n.forEach((function(e){return c.push([i[0],i[1],e.count,e.who,e.fqdn])}))},d=0,u=Object.entries(t.who);d<u.length;d++)s();e.setState({top:n,who:c})}))}},{key:"render",value:function(){return this.state.top&&this.state.who?h.a.createElement(f.Flex,{key:"status_flex"},h.a.createElement(f.ContentReport,{key:"top_cr",header:"Top looked up FQDN",thead:["Node","Service","Hit","FQDN"],trows:this.state.top,listItem:function(e){return e}}),h.a.createElement(f.ContentReport,{key:"who_cr",header:"Top looked up who",thead:["Node","Service","Hit","Who","FQDN"],trows:this.state.who,listItem:function(e){return e}})):h.a.createElement(f.Spinner,null)}}]),t}(l.Component),C=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).changeContent=function(e){return n.props.changeSelf(e)},n.listItem=function(e){return[e.id,e.name,e.content,e.type,e.ttl,h.a.createElement(l.Fragment,{key:"rl_buttons_"+e.id},h.a.createElement(_.ConfigureButton,{key:"record_info_btn_"+e.id,onClick:function(){return n.changeContent(h.a.createElement(E,{key:"record_info_"+e.id,domain_id:n.props.domain_id,id:e.id}))},title:"Configure record"}),["A","CNAME","PTR"].includes(e.type)&&h.a.createElement(_.DeleteButton,{key:"record_del_btn_"+e.id,onClick:function(){return n.deleteList(e.id)},title:"Delete record"}))]},n.deleteList=function(e){return window.confirm("Delete record?")&&Object(m.c)("api/dns/record_delete",{domain_id:n.props.domain_id,id:e}).then((function(t){return t.deleted&&n.setState({data:n.state.data.filter((function(t){return t.id!==e}))})}))},n.state={},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.c)("api/dns/record_list",{domain_id:this.props.domain_id}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;return h.a.createElement(f.ContentReport,{key:"rl_cr",header:"Records",thead:["ID","Name","Content","Type","TTL",""],trows:this.state.data,listItem:this.listItem,result:this.state.result},h.a.createElement(_.ReloadButton,{key:"rl_btn_reload",onClick:function(){return e.componentDidMount()}}),h.a.createElement(_.AddButton,{key:"rl_btn_add",onClick:function(){return e.changeContent(h.a.createElement(E,{key:"record_new_"+Object(m.d)(),domain_id:e.props.domain_id,id:"new"}))},title:"Add DNS record"}))}}]),t}(l.Component),E=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).onChange=function(e){return n.setState({data:Object(r.a)({},n.state.data,Object(i.a)({},e.target.name,e.target.value))})},n.updateInfo=function(){return Object(m.c)("api/dns/record_info",Object(r.a)({op:"update"},n.state.data)).then((function(e){return n.setState(e)}))},n.state={data:null,found:!0},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({info:void 0}),Object(m.c)("api/dns/record_info",{id:this.props.id,domain_id:this.props.domain_id}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;return this.state.data?h.a.createElement(f.InfoArticle,{key:"rec_art",header:"Record"},h.a.createElement(f.InfoColumns,{key:"record_content"},h.a.createElement(p.TextInput,{key:"name",id:"name",value:this.state.data.name,title:"E.g. A:FQDN, PTR:x.y.z.in-addr.arpa",onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"content",id:"content",value:this.state.data.content,title:"E.g. A:IP, PTR:FQDN",onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"ttl",id:"ttl",label:"TTL",value:this.state.data.ttl,onChange:this.onChange}),h.a.createElement(p.TextInput,{key:"type",id:"type",value:this.state.data.type,onChange:this.onChange,placeholder:"A, PTR or CNAME typically"})),h.a.createElement(_.SaveButton,{key:"record_save",onClick:function(){return e.updateInfo()},title:"Save record information"}),h.a.createElement(f.Result,{key:"record_result",result:"OK"!==this.state.status?this.state.info:"OK"})):h.a.createElement(f.Spinner,null)}}]),t}(l.Component)}}]);
//# sourceMappingURL=10.e17d68d2.chunk.js.map