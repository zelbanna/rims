{"version":3,"sources":["reservation.jsx"],"names":["List","props","extendItem","device_id","user_id","days","rest_call","op","then","result","componentDidMount","changeContent","elem","setState","content","deleteItem","dev","user","window","confirm","data","state","filter","row","listItem","buttons","context","cookie","id","valid","alias","hostname","className","end","key","onClick","Info","title","header","thead","trows","this","Component","contextType","RimsContext","onChange","e","target","name","value","updateInfo","found","text","time_start","time_end","shutdown","options","info","Report","start","extended"],"mappings":"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","file":"static/js/17.f9572e26.chunk.js","sourcesContent":["import React, { Fragment, Component } from 'react';\nimport { rest_call } from './infra/Functions.js';\nimport { Spinner, InfoColumns, RimsContext, ContentList, ContentData, ContentReport } from './infra/UI.jsx';\nimport { AddButton, DeleteButton, InfoButton, ReloadButton, SaveButton }  from './infra/Buttons.jsx';\nimport { RadioInput, TextInput, TextLine }  from './infra/Inputs.jsx';\n\n// ************** List **************\n//\nexport class List extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  rest_call('api/reservation/list').then(result => this.setState(result))\n }\n\n extendItem = (device_id,user_id,days) => {\n  rest_call('api/reservation/update',{op:'extend', device_id:device_id,user_id:user_id,days:days}).then(result => this.componentDidMount())\n }\n\n changeContent = (elem) => this.setState({content:elem})\n deleteItem = (dev,user) => (window.confirm('Remove reservation?') && rest_call('api/reservation/update',{op:'delete', device_id:dev, user_id:user}).then(result => result.result && this.setState({data:this.state.data.filter(row => row.device_id !== dev),content:null})))\n\n listItem = (row) => {\n  const buttons = (this.context.cookie.id === row.user_id || !row.valid);\n  return [row.alias,row.hostname,<span className={(row.valid) ? '' : 'orange'}>{row.end}</span>,<Fragment key='reservation_buttons'>\n   {buttons && <InfoButton key={'rsv_btn_info_'+row.device_id} onClick={() => { this.changeContent(<Info key={'rsv_device_'+row.device_id} device_id={row.device_id} user_id={row.user_id} />) }} title='Info'/>}\n   {buttons && <AddButton  key={'rsv_btn_ext_'+row.device_id}  onClick={() => { this.extendItem(row.device_id,row.user_id,14) }} title='Extend reservation' />}\n   {buttons && <DeleteButton key={'rsv_btn_del_'+row.device_id}  onClick={() => { this.deleteItem(row.device_id,row.user_id) }} title='Remove reservation' />}\n  </Fragment>]\n }\n\n render(){\n  return <Fragment key='rsv_fragment'>\n   <ContentList key='rsv_cl' header='Reservations' thead={['User','Device','Until','']} trows={this.state.data} listItem={this.listItem}>\n    <ReloadButton key='rsv_btn_reload' onClick={() => this.componentDidMount() } />\n   </ContentList>\n   <ContentData key='rsv_cd'>{this.state.content}</ContentData>\n  </Fragment>\n }\n}\nList.contextType = RimsContext;\n\n// ************** Info **************\n//\nclass Info extends Component {\n constructor(props){\n  super(props);\n  this.state = {data:null, found:true};\n }\n\n componentDidMount(){\n  rest_call('api/reservation/info',{device_id:this.props.device_id}).then(result => this.setState(result))\n }\n\n onChange = (e) => this.setState({data:{...this.state.data, [e.target.name]:e.target.value}});\n\n updateInfo = () =>  rest_call('api/reservation/info',{op:'update', ...this.state.data}).then(result => this.setState(result))\n\n render() {\n  if (this.state.data){\n   return (\n    <article className='info'>\n     <h1>Reservation</h1>\n     <InfoColumns key='reservation_content'>\n      <TextLine key='alias' id='alias' text={this.state.data.alias} />\n      <TextLine key='time_start' id='Start' text={this.state.data.time_start} />\n      <TextLine key='time_end' id='End' text={this.state.data.time_end} />\n      <RadioInput key='shutdown' id='shutdown' value={this.state.data.shutdown} options={[{text:'no',value:0},{text:'yes',value:1},{text:'reset',value:2}]} onChange={this.onChange} />\n      <TextInput key='info' id='info' value={this.state.data.info} onChange={this.onChange} />\n     </InfoColumns>\n     <SaveButton key='rsv_btn_save' onClick={() => this.updateInfo()} title='Save' />\n    </article>\n   );\n  } else\n   return <Spinner />\n }\n}\n\n// ************** Report **************\n//\nexport class Report extends Component {\n constructor(props){\n  super(props);\n  this.state = {}\n }\n\n componentDidMount(){\n  rest_call('api/reservation/list',{extended:true}).then(result => this.setState(result))\n }\n\n listItem = (row) => [row.alias,row.hostname,row.start,row.end,row.info]\n\n render(){\n  return <ContentReport key='rsv_cr' header='Reservations' thead={['User','Device','Start','End','Info']} trows={this.state.data} listItem={this.listItem} />\n }\n}\n"],"sourceRoot":""}