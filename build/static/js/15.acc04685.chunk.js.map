{"version":3,"sources":["pdu.jsx"],"names":["Manage","changeContent","elem","setState","rest_call","id","this","props","device_id","then","result","context","loadNavigation","key","title","data","onClick","Inventory","type","Info","state","Component","contextType","RimsContext","lookupSlots","op","slots","i","push","label","text","style","justifyContent","header","JSON","stringify","componentDidMount","content","listItem","row","idx","slotname","unit","Unit","name","Operation","thead","trows","undefined","operation","wait","slot","status","off","onChange","e","target","value","updatePDU","info"],"mappings":"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","file":"static/js/15.acc04685.chunk.js","sourcesContent":["import React, { Fragment, Component } from 'react';\nimport { rest_call } from './infra/Functions.js';\nimport { RimsContext, Flex, InfoArticle, InfoColumns, Spinner, ContentList, ContentData, Result } from './infra/UI.jsx';\nimport { TextInput, TextLine } from './infra/Inputs.jsx';\nimport { HrefButton, ReloadButton, SaveButton, SearchButton, StartButton, StopButton } from './infra/Buttons.jsx';\nimport { NavBar, NavButton, NavInfo } from './infra/Navigation.jsx';\n\n// ************** Manage **************\n//\nexport class Manage extends Component {\n componentDidMount(){\n  rest_call('api/device/hostname',{id:this.props.device_id}).then(result => {\n   this.context.loadNavigation(<NavBar key='pdu_navbar'>\n    <NavInfo key='pdu_nav_name' title={result.data} />\n    <NavButton key='pdu_nav_inv' title='Inventory' onClick={() => this.changeContent(<Inventory key='pdu_inventory' device_id={this.props.device_id} type={this.props.type} />)} />\n    <NavButton key='pdu_nav_info' title='Info' onClick={() => this.changeContent(<Info key='pdu_info' device_id={this.props.device_id} type={this.props.type} />)} />\n   </NavBar>)\n  })\n  this.setState(<Inventory key='pdu_inventory' device_id={this.props.device_id} type={this.props.type} />);\n }\n\n changeContent = (elem) => this.setState(elem)\n\n render(){\n  return  <Fragment key='manage_base'>{this.state}</Fragment>\n }\n}\nManage.contextType = RimsContext;\n\n// ************** Info **************\n//\nclass Info extends Component{\n constructor(props){\n  super(props)\n  this.state = {}\n }\n\n componentDidMount(){\n  rest_call('api/'+this.props.type+'/info',{device_id:this.props.device_id}).then(result => this.setState(result))\n }\n\n lookupSlots = () => rest_call('api/'+this.props.type+'/info',{device_id:this.props.device_id,op:'lookup'}).then(result => this.setState(result))\n\n render(){\n  if (this.state.data){\n   let slots = [];\n   for (let i = 0; i < this.state.data.slots; i++){\n    slots.push(<TextLine key={'pi_sn_' + i} id={'pi_slot_name_' + i} label={'Slot ' + i + ' Name'} text={this.state.data[i + '_slot_name']} />);\n    slots.push(<TextLine key={'pi_si_' + i} id={'pi_slot_id_' + i} label={'Slot ' + i + ' ID'} text={this.state.data[i + '_slot_id']} />);\n   }\n   return <Flex key='pi_flex' style={{justifyContent:'space-evenly'}}>\n    <InfoArticle key='pi_article' header={'PDU Device Info - '+this.props.type}>\n     <InfoColumns key='pi_info'>\n      <TextLine key='pi_slots' id='slots' label='Right/Left slots' text={JSON.stringify(this.state.data.slots === 2)} />\n      {slots}\n     </InfoColumns>\n     <ReloadButton key='pi_btn_reload' onClick={() => this.componentDidMount() } />\n     <SearchButton key='pi_btn_search' onClick={() => this.lookupSlots() } />\n    </InfoArticle>\n   </Flex>\n  } else\n   return <Spinner />\n }\n}\n\n// ************** Inventory **************\n//\nexport class Inventory extends Component{\n constructor(props){\n  super(props)\n  this.state = {}\n }\n\n componentDidMount(){\n  rest_call('api/' + this.props.type + '/inventory',{device_id:this.props.device_id}).then(result => this.setState(result))\n }\n\n changeContent = (elem) => this.setState({content:elem})\n\n listItem = (row,idx) => [`${row.slotname}.${row.unit}`,<HrefButton key={'pdu_inv_btn_' + idx} onClick={() => this.changeContent(<Unit key={'pdu_unit_'+idx} device_id={this.props.device_id} type={this.props.type} {...row} />)} text={row.name} title='Edit port info' />,<Operation key={'pdu_state'+idx} idx={idx} device_id={this.props.device_id} type={this.props.type} {...row} />]\n\n render(){\n  if (this.state.data){\n   return <Fragment key='pdu_fragment'>\n    <ContentList key='pdu_cl' header='Inventory' thead={['Position','Device','State']} trows={this.state.data} listItem={this.listItem}>\n     <ReloadButton key='pdu_btn_reload' onClick={() => {this.setState({data:undefined}); this.componentDidMount()} } />\n    </ContentList>\n    <ContentData key='pdu_cd'>{this.state.content}</ContentData>\n   </Fragment>\n  } else\n   return <Spinner />\n }\n}\n\n// *************** Operation ***************\n//\nclass Operation extends Component{\n constructor(props){\n  super(props)\n  this.state = {state:this.props.state, status:'',wait:null};\n }\n\n operation = (state) => {\n  this.setState({wait:<Spinner />})\n  rest_call('api/'+this.props.type+'/op',{device_id:this.props.device_id, slot:this.props.slot, unit:this.props.unit, state:state}).then(result => this.setState({...result, wait:null}));\n }\n\n render(){\n   const off = (this.state.state === 'off');\n   return <Fragment key={'pdu_frag_'+this.props.idx}>\n    {off && <StartButton key={'pdu_btn_start_'+this.props.idx} onClick={() => this.operation('on')} title={this.state.status} />}\n    {!off && <StopButton key={'pdu_btn_stop_'+this.props.idx} onClick={() => this.operation('off')} title={this.state.status} />}\n    {!off && <ReloadButton key={'pdu_btn_reload_'+this.props.idx} onClick={() => this.operation('reboot')} title={this.state.status} />}\n    {this.state.wait}\n   </Fragment>\n }\n}\n\n// ************** Unit **************\n//\nclass Unit extends Component {\n constructor(props){\n  super(props)\n  this.state = {text:this.props.name,wait:null}\n }\n\n onChange = (e) => this.setState({[e.target.name]:e.target.value});\n\n updatePDU = () => {\n  this.setState({wait:<Spinner />, info:undefined});\n  rest_call('api/'+this.props.type+'/update',{op:'update',device_id:this.props.device_id,slot:this.props.slot,unit:this.props.unit,text:this.state.text}).then(result => this.setState({...result,wait:null}));\n }\n\n render(){\n  let result = ''\n  if (this.state.status)\n   result = (this.state.status === 'OK') ? 'OK' : this.state.info;\n  return <InfoArticle key='pu_article'>\n   <InfoColumns key='pu_info'>\n    <TextLine key='pu_slot_unit' id='su' label='Slot.Unit' text={`${this.props.slotname}.${this.props.unit}`} />\n    <TextInput key='pu_slot_text' id='text' value={this.state.text} onChange={this.onChange} />\n   </InfoColumns>\n   <Result key='pu_result' result={result} />\n   <SaveButton key='pu_btn_save' onClick={() => this.updatePDU()} title='Update pdu' />\n   {this.state.wait}\n  </InfoArticle>\n }\n}\n"],"sourceRoot":""}