(this.webpackJsonprims=this.webpackJsonprims||[]).push([[13],{37:function(e,t,a){"use strict";a.r(t),a.d(t,"Main",(function(){return b}));var n=a(10),i=a(13),r=a(3),l=a(4),s=a(6),c=a(5),m=a(7),o=a(0),u=a.n(o),d=a(8),h=a(1),p=a(9),f=a(11),_=a(2),b=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).changeContent=function(e){return a.setState({content:e})},a.reloadList=function(){return Object(d.b)("api/multimedia/list").then((function(e){return a.setState(e)}))},a.deleteList=function(e){return window.confirm("Delete file "+e.file+"?")&&Object(d.b)("api/multimedia/delete",e).then((function(t){return t.deleted&&a.setState({data:a.state.data.filter((function(t){return!(t.path===e.path&&t.file===e.file)})),content:null})}))},a.listItem=function(e,t){return[e.file,u.a.createElement(o.Fragment,{key:"mm_buttons_"+t},u.a.createElement(_.InfoButton,{key:"mm_btn_info_"+t,onClick:function(){return a.changeContent(u.a.createElement(k,{key:"multimedia_title_"+t,path:e.path,file:e.file}))},title:"Title info"}),u.a.createElement(_.SearchButton,{key:"mm_btn_lookup_"+t,onClick:function(){return a.changeContent(u.a.createElement(y,{key:"multimedia_lookup_"+t,path:e.path,file:e.file}))},title:"Lookup info"}),u.a.createElement(_.DocButton,{key:"mm_btn_subs_"+t,onClick:function(){return a.changeContent(u.a.createElement(E,{key:"multimedia_subs_"+t,path:e.path,file:e.file}))},title:"Subtitles"}),u.a.createElement(_.DeleteButton,{key:"mm_btn_delete_"+t,onClick:function(){return a.deleteList(e)},title:"Delete file"}))]},a.state={content:void 0,ip:void 0},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(d.b)("api/system/external_ip").then((function(t){var a=t&&"OK"===t.status?t.ip:"0.0.0.0";e.context.loadNavigation(u.a.createElement(f.a,{key:"multimedia_navbar"},u.a.createElement(f.e,{key:"mm_nav_ip",title:a})))})),this.reloadList()}},{key:"render",value:function(){var e=this;return this.state.data?u.a.createElement(o.Fragment,{key:"mm_fragment"},u.a.createElement(h.ContentList,{key:"mm_cl",header:"Media files",thead:["File",""],trows:this.state.data,listItem:this.listItem,result:this.state.result},u.a.createElement(_.ReloadButton,{key:"mm_btn_reload",onClick:function(){return e.reloadList()}}),u.a.createElement(_.DeleteButton,{key:"mm_btn_cleanup",onClick:function(){return window.confirm("Really clean up files?")&&e.changeContent(u.a.createElement(x,{key:"multimedia_cleanup_"+Object(d.c)()}))},title:"Cleanup multimedia directory"})),u.a.createElement(h.ContentData,{key:"mm_cd"},this.state.content)):u.a.createElement(h.Spinner,null)}}]),t}(o.Component);b.contextType=h.RimsContext;var k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).onChange=function(e){return a.setState({data:Object(i.a)({},a.state.data,Object(n.a)({},e.target.name,e.target.value))})},a.threadChange=function(e){return a.setState(Object(n.a)({},e.target.name,e.target.checked))},a.updateInfo=function(){return Object(d.b)("api/multimedia/check_titlt",Object(i.a)({op:"update"},a.state.data)).then((function(e){return a.setState(e)}))},a.transferFile=function(){window.confirm("Transfer file to repository?")&&(a.state.thread?Object(d.b)("api/system/worker",{module:"multimedia",function:"transfer",output:!0,args:{path:a.props.path,file:a.props.file}}).then((function(e){return a.setState({op:"transfer",result:e})})):(a.setState({wait:u.a.createElement(h.Spinner,null)}),Object(d.b)("api/multimedia/transfer",{path:a.props.path,file:a.props.file}).then((function(e){return a.setState({op:"transfer",result:e,wait:null})}))))},a.processFile=function(){window.confirm("Process file?")&&(a.state.thread?Object(d.b)("api/system/worker",{module:"multimedia",function:"process",output:!0,args:Object(i.a)({path:a.props.path,file:a.props.file},a.state.data)}).then((function(e){return a.setState({op:"process",result:e})})):(a.setState({wait:u.a.createElement(h.Spinner,null)}),Object(d.b)("api/multimedia/process",Object(i.a)({path:a.props.path,file:a.props.file},a.state.data)).then((function(e){return a.setState({op:"process",result:e,wait:null})}))))},a.state={thread:!0,wait:null},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(d.b)("api/multimedia/check_title",{path:this.props.path,file:this.props.file}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){var e=this;if(this.state.op){if(this.state.thread||"transfer"===this.state.op)return u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,this.state.thread?"Task activation":"Transfer"),u.a.createElement("label",{className:"info",htmlFor:"res"},"Result:"),u.a.createElement("span",{id:"res"},JSON.stringify(this.state.result)));if("NOT_OK"===this.state.result.status)return u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,"Process Error"),u.a.createElement("pre",null,JSON.stringify(this.state.result.info,null,2)));var t=this.state.result.data;return u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,"Process success"),u.a.createElement("span",null,"Elapsed time for processing file: ",this.state.result.seconds," seconds"),u.a.createElement(h.InfoColumns,{key:"mm_proc_ic"},u.a.createElement(p.TextLine,{key:"mm_proc_prefix",id:"prefix",text:t.prefix}),u.a.createElement(p.TextLine,{key:"mm_proc_suffix",id:"suffix",text:t.suffix}),u.a.createElement(p.TextLine,{key:"mm_proc_dest",id:"dest",label:"Destination",text:JSON.stringify(t.dest)}),u.a.createElement(p.TextLine,{key:"mm_proc_rename",id:"rename",text:JSON.stringify(t.rename)}),u.a.createElement(p.TextLine,{key:"mm_proc_aac",id:"aac",label:"Add AAC",text:JSON.stringify(t.aac_probe)}),u.a.createElement(p.TextLine,{key:"mm_proc_chg_aac",id:"chg_aac",label:"Param AAC",text:t.changes.aac}),u.a.createElement(p.TextLine,{key:"mm_proc_chg_aud",id:"chg_aud",label:"Param Audio",text:t.changes.audio}),u.a.createElement(p.TextLine,{key:"mm_proc_chg_sub",id:"chg_sub",label:"Param Subtitles",text:t.changes.subtitle}),u.a.createElement(p.TextLine,{key:"mm_proc_chg_srt",id:"chg_srt",label:"Param SRT files",text:t.changes.srt})))}if(this.state.data){var a=this.state.data;return u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,"Title"),u.a.createElement(h.InfoColumns,{key:"mm_tit_ic"},u.a.createElement(p.TextLine,{key:"mm_tit_type",id:"type",text:a.type}),u.a.createElement(p.TextLine,{key:"mm_tit_title",id:"title",text:a.title}),u.a.createElement(p.TextLine,{key:"mm_tit_path",id:"path",text:a.path}),u.a.createElement(p.TextInput,{key:"mm_tit_name",id:"name",value:a.name,onChange:this.onChange}),a.epside&&u.a.createElement(p.TextInput,{key:"mm_tit_eposide",id:"episode",value:a.episode,onChange:this.onChange}),u.a.createElement(p.TextInput,{key:"mm_tit_info",id:"info",value:a.info,onChange:this.onChange}),u.a.createElement(p.CheckboxInput,{key:"mm_tit_thread",id:"thread",label:"Thread",value:this.state.thread,onChange:this.threadChange,title:"Thread or direct execution"})),u.a.createElement(_.StartButton,{key:"mm_tit_btn_proc",onClick:function(){return e.processFile()},title:"Process file"}),u.a.createElement(_.SyncButton,{key:"mm_tit_btn_trans",onClick:function(){return e.transferFile()},title:"Transfer file"}),this.state.wait)}return u.a.createElement(h.Spinner,null)}}]),t}(o.Component),y=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(d.b)("api/multimedia/check_content",{path:this.props.path,file:this.props.file}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){if(this.state.data){var e=this.state.data;return u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,"Lookup"),u.a.createElement(h.InfoColumns,{key:"mm_lu_ic"},u.a.createElement(p.TextLine,{key:"mm_lu_file",id:"file",label:"File",text:this.props.file}),u.a.createElement(p.TextLine,{key:"mm_lu_status",id:"status",label:"Result",text:this.state.status}),u.a.createElement(p.TextLine,{key:"mm_lu_error",id:"error",label:"Error",text:this.state.info}),u.a.createElement(p.TextLine,{key:"mm_lu_v_def",id:"video_default",label:"Video default",text:JSON.stringify(!e.video.set_default),title:"Video stream has default language"}),u.a.createElement(p.TextLine,{key:"mm_lu_v_lang",id:"video_lang",label:"Video language",text:e.video.language,title:"Language set in video stream information"}),u.a.createElement(p.TextLine,{key:"mm_lu_a_add",id:"audio_add",label:"Audio keep",text:e.audio.add.join()}),u.a.createElement(p.TextLine,{key:"mm_lu_a_rem",id:"audio_rem",label:"Audio remove",text:e.audio.remove.join()}),u.a.createElement(p.TextLine,{key:"mm_lu_a_aac",id:"audio_aac",label:"Add AAC",text:JSON.stringify(e.audio.add_aac)}),u.a.createElement(p.TextLine,{key:"mm_lu_s_add",id:"sub_add",label:"Subtitle keep",text:e.subtitle.add.join()}),u.a.createElement(p.TextLine,{key:"mm_lu_s_rem",id:"sub_rem",label:"Subtitle remove",text:e.subtitle.remove.join()}),u.a.createElement(p.TextLine,{key:"mm_lu_a_lang",id:"sub_lang",label:"Subtitle languages",text:e.subtitle.languages.join()})))}return u.a.createElement(h.Spinner,null)}}]),t}(o.Component),E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(d.b)("api/multimedia/check_srt",{path:this.props.path,file:this.props.file}).then((function(t){return e.setState(t)}))}},{key:"render",value:function(){return this.state.data?u.a.createElement("article",{className:"info"},u.a.createElement("h1",null,"Extra subtitles"),u.a.createElement(h.InfoColumns,{key:"mm_sub_ic"},u.a.createElement(p.TextLine,{key:"mm_sub_path",id:"path",text:this.props.path}),u.a.createElement(p.TextLine,{key:"mm_sub_item",id:"item",text:this.props.file}),u.a.createElement(p.TextLine,{key:"mm_sub_name",id:"name",text:this.state.data.name}),u.a.createElement(p.TextLine,{key:"mm_sub_code",id:"code",text:this.state.data.code}),u.a.createElement(p.TextLine,{key:"mm_sub_file",id:"file",text:this.state.data.file}))):u.a.createElement(h.Spinner,null)}}]),t}(o.Component),x=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(d.b)("api/multimedia/cleanup").then((function(t){return e.setState(t)}))}},{key:"render",value:function(){return this.state.data?u.a.createElement(h.ContentReport,{key:"mm_clean_cr",header:"delete",thead:["Type","Path","Item","Status","Info"],trows:this.state.data,listItem:function(e){return[e.type,e.path,e.item,e.status,e.info]}}):u.a.createElement(h.Spinner,null)}}]),t}(o.Component)}}]);
//# sourceMappingURL=13.cc5f7f07.chunk.js.map